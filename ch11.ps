%!PS-Adobe-2.0
%%Version: 0.1
%%DocumentFonts: (atend)
%%Pages: (atend)
%%EndComments
%
% Version 3.3.2 prologue for troff files.
%

/#copies 1 store
/aspectratio 1 def
/formsperpage 1 def
/landscape false def
/linewidth .3 def
/magnification 1 def
/margin 0 def
/orientation 0 def
/resolution 720 def
/rotation 1 def
/xoffset 0 def
/yoffset 0 def

/roundpage true def
/useclippath true def
/pagebbox [0 0 612 792] def

/R  /Times-Roman def
/I  /Times-Italic def
/B  /Times-Bold def
/BI /Times-BoldItalic def
/H  /Helvetica def
/HI /Helvetica-Oblique def
/HB /Helvetica-Bold def
/HX /Helvetica-BoldOblique def
/CW /Courier def
/CO /Courier def
/CI /Courier-Oblique def
/CB /Courier-Bold def
/CX /Courier-BoldOblique def
/PA /Palatino-Roman def
/PI /Palatino-Italic def
/PB /Palatino-Bold def
/PX /Palatino-BoldItalic def
/Hr /Helvetica-Narrow def
/Hi /Helvetica-Narrow-Oblique def
/Hb /Helvetica-Narrow-Bold def
/Hx /Helvetica-Narrow-BoldOblique def
/KR /Bookman-Light def
/KI /Bookman-LightItalic def
/KB /Bookman-Demi def
/KX /Bookman-DemiItalic def
/AR /AvantGarde-Book def
/AI /AvantGarde-BookOblique def
/AB /AvantGarde-Demi def
/AX /AvantGarde-DemiOblique def
/NR /NewCenturySchlbk-Roman def
/NI /NewCenturySchlbk-Italic def
/NB /NewCenturySchlbk-Bold def
/NX /NewCenturySchlbk-BoldItalic def
/ZD /ZapfDingbats def
/ZI /ZapfChancery-MediumItalic def
/S  /S def
/S1 /S1 def
/GR /Symbol def

/inch {72 mul} bind def
/min {2 copy gt {exch} if pop} bind def

/setup {
	counttomark 2 idiv {def} repeat pop

	landscape {/orientation 90 orientation add def} if
	/scaling 72 resolution div def
	linewidth setlinewidth
	1 setlinecap

	pagedimensions
	xcenter ycenter translate
	orientation rotation mul rotate
	width 2 div neg height 2 div translate
	xoffset inch yoffset inch neg translate
	margin 2 div dup neg translate
	magnification dup aspectratio mul scale
	scaling scaling scale

	addmetrics
	0 0 moveto
} def

/pagedimensions {
	useclippath userdict /gotpagebbox known not and {
		/pagebbox [clippath pathbbox newpath] def
		roundpage currentdict /roundpagebbox known and {roundpagebbox} if
	} if
	pagebbox aload pop
	4 -1 roll exch 4 1 roll 4 copy
	landscape {4 2 roll} if
	sub /width exch def
	sub /height exch def
	add 2 div /xcenter exch def
	add 2 div /ycenter exch def
	userdict /gotpagebbox true put
} def

/addmetrics {
	/Symbol /S null Sdefs cf
	/Times-Roman /S1 StandardEncoding dup length array copy S1defs cf
} def

/pagesetup {
	/page exch def
	currentdict /pagedict known currentdict page known and {
		page load pagedict exch get cvx exec
	} if
} def

/decodingdefs [
	{counttomark 2 idiv {y moveto show} repeat}
	{neg /y exch def counttomark 2 idiv {y moveto show} repeat}
	{neg moveto {2 index stringwidth pop sub exch div 0 32 4 -1 roll widthshow} repeat}
	{neg moveto {spacewidth sub 0.0 32 4 -1 roll widthshow} repeat}
	{counttomark 2 idiv {y moveto show} repeat}
	{neg setfunnytext}
] def

/setdecoding {/t decodingdefs 3 -1 roll get bind def} bind def

/w {neg moveto show} bind def
/m {neg dup /y exch def moveto} bind def
/done {/lastpage where {pop lastpage} if} def

/f {
	dup /font exch def findfont exch
	dup /ptsize exch def scaling div dup /size exch def scalefont setfont
	linewidth ptsize mul scaling 10 mul div setlinewidth
	/spacewidth ( ) stringwidth pop def
} bind def

/changefont {
	/fontheight exch def
	/fontslant exch def
	currentfont [
		1 0
		fontheight ptsize div fontslant sin mul fontslant cos div
		fontheight ptsize div
		0 0
	] makefont setfont
} bind def

/sf {f} bind def

/cf {
	dup length 2 idiv
	/entries exch def
	/chtab exch def
	/newencoding exch def
	/newfont exch def

	findfont dup length 1 add dict
	/newdict exch def
	{1 index /FID ne {newdict 3 1 roll put}{pop pop} ifelse} forall

	newencoding type /arraytype eq {newdict /Encoding newencoding put} if

	newdict /Metrics entries dict put
	newdict /Metrics get
	begin
		chtab aload pop
		1 1 entries {pop def} for
		newfont newdict definefont pop
	end
} bind def

%
% A few arrays used to adjust reference points and character widths in some
% of the printer resident fonts. If square roots are too high try changing
% the lines describing /radical and /radicalex to,
%
%	/radical	[0 -75 550 0]
%	/radicalex	[-50 -75 500 0]
%
% Move braceleftbt a bit - default PostScript character is off a bit.
%

/Sdefs [
	/bracketlefttp		[201 500]
	/bracketleftbt		[201 500]
	/bracketrighttp		[-81 380]
	/bracketrightbt		[-83 380]
	/braceleftbt		[203 490]
	/bracketrightex		[220 -125 500 0]
	/radical		[0 0 550 0]
	/radicalex		[-50 0 500 0]
	/parenleftex		[-20 -170 0 0]
	/integral		[100 -50 500 0]
	/infinity		[10 -75 730 0]
] def

/S1defs [
	/underscore		[0 80 500 0]
	/endash			[7 90 650 0]
] def
%
% Version 3.3.2 drawing procedures for dpost. Automatically pulled in when
% needed.
%

/inpath false def
/savematrix matrix def

/Dl {
	inpath
		{neg lineto pop pop}
		{newpath neg moveto neg lineto stroke}
	ifelse
} bind def

/De {
	/y1 exch 2 div def
	/x1 exch 2 div def
	/savematrix savematrix currentmatrix def
	neg exch x1 add exch translate
	x1 y1 scale
	0 0 1 0 360
	inpath
		{1 0 moveto arc savematrix setmatrix}
		{newpath arc savematrix setmatrix stroke}
	ifelse
} bind def

/Da {
	/dy2 exch def
	/dx2 exch def
	/dy1 exch def
	/dx1 exch def
	dy1 add neg exch dx1 add exch
	dx1 dx1 mul dy1 dy1 mul add sqrt
	dy1 dx1 neg atan
	dy2 neg dx2 atan
	inpath
		{arc}
		{newpath arc stroke}
	ifelse
} bind def

/DA {
	/dy2 exch def
	/dx2 exch def
	/dy1 exch def
	/dx1 exch def
	dy1 add neg exch dx1 add exch
	dx1 dx1 mul dy1 dy1 mul add sqrt
	dy1 dx1 neg atan
	dy2 neg dx2 atan
	inpath
		{arcn}
		{newpath arcn stroke}
	ifelse
} bind def

/Ds {
	/y2 exch def
	/x2 exch def
	/y1 exch def
	/x1 exch def
	/y0 exch def
	/x0 exch def
	x0 5 x1 mul add 6 div
	y0 5 y1 mul add -6 div
	x2 5 x1 mul add 6 div
	y2 5 y1 mul add -6 div
	x1 x2 add 2 div
	y1 y2 add -2 div
	inpath
		{curveto}
		{newpath x0 x1 add 2 div y0 y1 add -2 div moveto curveto stroke}
	ifelse
} bind def
%
% Tries to round clipping path dimensions, as stored in array pagebbox, so they
% match one of the known sizes in the papersizes array. Lower left coordinates
% are always set to 0.
%

/roundpagebbox {
    7 dict begin
	/papersizes [8.5 inch 11 inch 14 inch 17 inch] def

	/mappapersize {
		/val exch def
		/slop .5 inch def
		/diff slop def
		/j 0 def
		0 1 papersizes length 1 sub {
			/i exch def
			papersizes i get val sub abs
			dup diff le {/diff exch def /j i def} {pop} ifelse
		} for
		diff slop lt {papersizes j get} {val} ifelse
	} def

	pagebbox 0 0 put
	pagebbox 1 0 put
	pagebbox dup 2 get mappapersize 2 exch put
	pagebbox dup 3 get mappapersize 3 exch put
    end
} bind def

%%EndProlog
%%BeginSetup
mark
%
% Encoding vector and redefinition of findfont for the ISO Latin1 standard.
% The 18 characters missing from ROM based fonts on older printers are noted
% below.
%

/ISOLatin1Encoding [
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/space
	/exclam
	/quotedbl
	/numbersign
	/dollar
	/percent
	/ampersand
	/quoteright
	/parenleft
	/parenright
	/asterisk
	/plus
	/comma
	/minus
	/period
	/slash
	/zero
	/one
	/two
	/three
	/four
	/five
	/six
	/seven
	/eight
	/nine
	/colon
	/semicolon
	/less
	/equal
	/greater
	/question
	/at
	/A
	/B
	/C
	/D
	/E
	/F
	/G
	/H
	/I
	/J
	/K
	/L
	/M
	/N
	/O
	/P
	/Q
	/R
	/S
	/T
	/U
	/V
	/W
	/X
	/Y
	/Z
	/bracketleft
	/backslash
	/bracketright
	/asciicircum
	/underscore
	/quoteleft
	/a
	/b
	/c
	/d
	/e
	/f
	/g
	/h
	/i
	/j
	/k
	/l
	/m
	/n
	/o
	/p
	/q
	/r
	/s
	/t
	/u
	/v
	/w
	/x
	/y
	/z
	/braceleft
	/bar
	/braceright
	/asciitilde
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/.notdef
	/dotlessi
	/grave
	/acute
	/circumflex
	/tilde
	/macron
	/breve
	/dotaccent
	/dieresis
	/.notdef
	/ring
	/cedilla
	/.notdef
	/hungarumlaut
	/ogonek
	/caron
	/space
	/exclamdown
	/cent
	/sterling
	/currency
	/yen
	/brokenbar		% missing
	/section
	/dieresis
	/copyright
	/ordfeminine
	/guillemotleft
	/logicalnot
	/hyphen
	/registered
	/macron
	/degree			% missing
	/plusminus		% missing
	/twosuperior		% missing
	/threesuperior		% missing
	/acute
	/mu			% missing
	/paragraph
	/periodcentered
	/cedilla
	/onesuperior		% missing
	/ordmasculine
	/guillemotright
	/onequarter		% missing
	/onehalf		% missing
	/threequarters		% missing
	/questiondown
	/Agrave
	/Aacute
	/Acircumflex
	/Atilde
	/Adieresis
	/Aring
	/AE
	/Ccedilla
	/Egrave
	/Eacute
	/Ecircumflex
	/Edieresis
	/Igrave
	/Iacute
	/Icircumflex
	/Idieresis
	/Eth			% missing
	/Ntilde
	/Ograve
	/Oacute
	/Ocircumflex
	/Otilde
	/Odieresis
	/multiply		% missing
	/Oslash
	/Ugrave
	/Uacute
	/Ucircumflex
	/Udieresis
	/Yacute			% missing
	/Thorn			% missing
	/germandbls
	/agrave
	/aacute
	/acircumflex
	/atilde
	/adieresis
	/aring
	/ae
	/ccedilla
	/egrave
	/eacute
	/ecircumflex
	/edieresis
	/igrave
	/iacute
	/icircumflex
	/idieresis
	/eth			% missing
	/ntilde
	/ograve
	/oacute
	/ocircumflex
	/otilde
	/odieresis
	/divide			% missing
	/oslash
	/ugrave
	/uacute
	/ucircumflex
	/udieresis
	/yacute			% missing
	/thorn			% missing
	/ydieresis
] def

/NewFontDirectory FontDirectory maxlength dict def

%
% Apparently no guarantee findfont is defined in systemdict so the obvious
%
%	systemdict /findfont get exec
%
% can generate an error. So far the only exception is a VT600 (version 48.0).
%

userdict /@RealFindfont known not {
	userdict begin
		/@RealFindfont systemdict begin /findfont load end def
	end
} if

/findfont {
	dup NewFontDirectory exch known not {
		dup
		%dup systemdict /findfont get exec	% not always in systemdict
		dup userdict /@RealFindfont get exec
		dup /Encoding get StandardEncoding eq {
			dup length dict begin
				{1 index /FID ne {def}{pop pop} ifelse} forall
				/Encoding ISOLatin1Encoding def
				currentdict
			end
			/DummyFontName exch definefont
		} if
		NewFontDirectory 3 1 roll put
	} if
	NewFontDirectory exch get
} bind def

%%Patch from lp
%%EndPatch from lp

setup
%%EndSetup
%%Page: 1 1
/saveobj save def
mark
1 pagesetup
30 /Times-Roman f
(11 ) 566 686 w
30 /LucidaSansUnicode20 f
(\024) 941 686 w
30 /Times-Roman f
(Threads and Channels) 1316 686 w
30 /S1 f
(______) 566 902 w
16 /Times-Bold f
(11.1.) 566 1262 w
(Threads) 966 1262 w
11 /Times-Roman f
(Processes) 816 1418 w
(are) 1277 1418 w
(independent) 1444 1418 w
(flows) 2015 1418 w
(of) 2294 1418 w
(control) 2420 1418 w
(known) 2766 1418 w
(to) 3100 1418 w
(Plan) 3221 1418 w
(9.) 3452 1418 w
(The) 3570 1418 w
(kernel) 3775 1418 w
(cre\255) 4083 1418 w
(ates) 566 1538 w
(them,) 772 1538 w
(it) 1056 1538 w
(terminates) 1154 1538 w
(them,) 1647 1538 w
(and) 1931 1538 w
(it) 2125 1538 w
(decides) 2223 1538 w
(when) 2587 1538 w
(to) 2859 1538 w
(move) 2980 1538 w
(one) 3259 1538 w
(process) 3452 1538 w
(out) 3815 1538 w
(of) 3991 1538 w
(the) 4117 1538 w
(processor) 566 1658 w
(and) 1019 1658 w
(when) 1211 1658 w
(to) 1482 1658 w
(put) 1602 1658 w
(a) 1778 1658 w
(process) 1861 1658 w
(back) 2224 1658 w
(on) 2465 1658 w
(it.) 2610 1658 w
(Because) 2735 1658 w
(of) 3134 1658 w
(the) 3260 1658 w
(unpredictability) 3429 1658 w
(of) 4160 1658 w
(context) 566 1778 w
(switches) 952 1778 w
(between) 1393 1778 w
(processes,) 1820 1778 w
(they) 2330 1778 w
(must) 2582 1778 w
(synchronize) 2860 1778 w
(using) 3452 1778 w
(locks,) 3754 1778 w
(ren\255) 4076 1778 w
(dezvous,) 566 1898 w
(sleep/wakeup,) 989 1898 w
(or) 1649 1898 w
(any) 1776 1898 w
(other) 1970 1898 w
(means) 2231 1898 w
(if) 2547 1898 w
(they) 2650 1898 w
(want) 2875 1898 w
(to) 3124 1898 w
(share) 3246 1898 w
(memory) 3512 1898 w
(without) 3914 1898 w
(race) 566 2018 w
(conditions.) 774 2018 w
(But) 816 2174 w
(there) 1005 2174 w
(is) 1252 2174 w
(an) 1355 2174 w
(alternative.) 1487 2174 w
(The) 2006 2174 w
11 /Times-Italic f
(thread) 2206 2174 w
11 /Times-Roman f
(\(2\)) 2493 2174 w
(library) 2650 2174 w
(provides) 2972 2174 w
(an) 3380 2174 w
(abstraction) 3513 2174 w
(simi\255) 4024 2174 w
(lar) 566 2294 w
(to) 710 2294 w
(a) 825 2294 w
(process,) 902 2294 w
(called) 1287 2294 w
(a) 1577 2294 w
11 /Times-Bold f
(thread) 1653 2294 w
11 /Times-Roman f
(.) 1964 2294 w
(A) 2048 2294 w
(thread) 2155 2294 w
(is) 2456 2294 w
(just) 2558 2294 w
(a) 2746 2294 w
(flow) 2822 2294 w
(of) 3051 2294 w
(control) 3170 2294 w
(within) 3509 2294 w
(a) 3819 2294 w
(process.) 3895 2294 w
(In) 566 2414 w
(the) 694 2414 w
(same) 865 2414 w
(way) 1127 2414 w
(that) 1346 2414 w
(Plan) 1548 2414 w
(9) 1782 2414 w
(multiplexes) 1875 2414 w
(the) 2427 2414 w
(flow) 2599 2414 w
(of) 2838 2414 w
(control) 2967 2414 w
(of) 3316 2414 w
(a) 3445 2414 w
(single) 3531 2414 w
(processor) 3832 2414 w
(among) 566 2534 w
(multiple) 906 2534 w
(processes,) 1315 2534 w
(the) 1802 2534 w
(thread) 1976 2534 w
(library) 2289 2534 w
(multiplexes) 2621 2534 w
(the) 3175 2534 w
(flow) 3349 2534 w
(of) 3590 2534 w
(control) 3721 2534 w
(of) 4072 2534 w
(a) 4203 2534 w
(single) 566 2654 w
(process) 857 2654 w
(among) 1213 2654 w
(multiple) 1540 2654 w
(threads.) 1936 2654 w
(Process) 646 3012 w
(1:) 1009 3012 w
1202 2885 1551 2885 Dl
(Thread) 1180 2847 w
(1) 1517 2847 w
1551 2885 1586 2885 Dl
1630 2885 1665 2885 Dl
1708 2885 1743 2885 Dl
1787 2885 1822 2885 Dl
1866 2885 1901 2885 Dl
1901 2885 2250 2885 Dl
(run) 2003 2847 w
2251 2885 2286 2885 Dl
2308 2885 2343 2885 Dl
2366 2885 2401 2885 Dl
2425 2885 2460 2885 Dl
(rdy.) 2268 2847 w
1202 3095 1237 3095 Dl
1280 3095 1315 3095 Dl
1359 3095 1394 3095 Dl
1438 3095 1473 3095 Dl
1516 3095 1551 3095 Dl
(Thread) 1180 3177 w
(2) 1517 3177 w
1551 3095 1900 3095 Dl
1901 3095 1936 3095 Dl
1979 3095 2014 3095 Dl
2058 3095 2093 3095 Dl
2137 3095 2172 3095 Dl
2215 3095 2250 3095 Dl
(ready) 1955 3177 w
2251 3095 2460 3095 Dl
(run) 2268 3177 w
8 /Times-Roman f
(.) 1540 2888 w
(.) 1540 2924 w
(.) 1540 2958 w
(.) 1540 2993 w
(.) 1540 3028 w
(.) 1540 3063 w
(.) 1540 3098 w
1533 3025 1550 3094 Dl
1569 3025 1552 3094 Dl
(.) 1890 3098 w
(.) 1890 3063 w
(.) 1890 3028 w
(.) 1890 2993 w
(.) 1890 2958 w
(.) 1890 2924 w
(.) 1890 2888 w
1918 2955 1901 2886 Dl
1883 2955 1900 2886 Dl
(.) 2240 2888 w
(.) 2240 2924 w
(.) 2240 2958 w
(.) 2240 2993 w
(.) 2240 3028 w
(.) 2240 3063 w
(.) 2240 3098 w
2233 3025 2250 3094 Dl
2268 3025 2251 3094 Dl
2460 2990 2495 2990 Dl
2531 2990 2566 2990 Dl
2603 2990 2638 2990 Dl
2675 2990 2710 2990 Dl
2747 2990 2782 2990 Dl
2819 2990 2854 2990 Dl
2891 2990 2926 2990 Dl
2962 2990 2997 2990 Dl
3034 2990 3069 2990 Dl
3106 2990 3141 2990 Dl
3177 2990 3212 2990 Dl
3249 2990 3284 2990 Dl
3321 2990 3356 2990 Dl
3392 2990 3427 2990 Dl
3464 2990 3499 2990 Dl
3536 2990 3571 2990 Dl
3608 2990 3643 2990 Dl
3680 2990 3715 2990 Dl
3751 2990 3786 2990 Dl
3823 2990 3858 2990 Dl
11 /Times-Roman f
(ready) 3038 2952 w
3858 2885 3893 2885 Dl
3937 2885 3972 2885 Dl
4015 2885 4050 2885 Dl
4094 2885 4129 2885 Dl
4172 2885 4207 2885 Dl
(ready) 3912 2847 w
(...) 4208 2907 w
3858 3095 4207 3095 Dl
(run) 3960 3177 w
(...) 4208 3117 w
(Process) 646 3712 w
(2:) 1009 3712 w
1202 3690 1237 3690 Dl
1274 3690 1309 3690 Dl
1346 3690 1381 3690 Dl
1417 3690 1452 3690 Dl
1489 3690 1524 3690 Dl
1560 3690 1595 3690 Dl
1632 3690 1667 3690 Dl
1704 3690 1739 3690 Dl
1775 3690 1810 3690 Dl
1847 3690 1882 3690 Dl
1919 3690 1954 3690 Dl
1991 3690 2026 3690 Dl
2063 3690 2098 3690 Dl
2135 3690 2170 3690 Dl
2206 3690 2241 3690 Dl
2278 3690 2313 3690 Dl
2350 3690 2385 3690 Dl
2421 3690 2456 3690 Dl
2493 3690 2528 3690 Dl
2564 3690 2599 3690 Dl
(ready) 1780 3652 w
2600 3690 3788 3690 Dl
(run) 3121 3652 w
3788 3690 3823 3690 Dl
3852 3690 3887 3690 Dl
3916 3690 3951 3690 Dl
3980 3690 4015 3690 Dl
4044 3690 4079 3690 Dl
4108 3690 4143 3690 Dl
4172 3690 4207 3690 Dl
(ready) 3877 3652 w
(...) 4208 3712 w
8 /Times-Roman f
(.) 2449 3098 w
(.) 2457 3133 w
(.) 2466 3168 w
(.) 2474 3203 w
(.) 2482 3238 w
(.) 2490 3273 w
(.) 2498 3308 w
(.) 2507 3343 w
(.) 2515 3378 w
(.) 2523 3413 w
(.) 2531 3448 w
(.) 2539 3482 w
(.) 2548 3518 w
(.) 2556 3552 w
(.) 2564 3587 w
(.) 2572 3623 w
(.) 2581 3657 w
(.) 2589 3693 w
2567 3626 2600 3690 Dl
2600 3618 2600 3690 Dl
11 /Times-Roman f
(context) 2530 3414 w
(switch) 2881 3414 w
8 /Times-Roman f
(.) 3777 3693 w
(.) 3781 3657 w
(.) 3785 3623 w
(.) 3790 3587 w
(.) 3793 3552 w
(.) 3798 3518 w
(.) 3802 3482 w
(.) 3806 3448 w
(.) 3810 3413 w
(.) 3814 3378 w
(.) 3819 3343 w
(.) 3822 3308 w
(.) 3826 3273 w
(.) 3831 3238 w
(.) 3834 3203 w
(.) 3839 3168 w
(.) 3843 3133 w
(.) 3847 3098 w
3867 3167 3858 3096 Dl
3832 3163 3857 3096 Dl
11 /Times-Roman f
(Figure) 816 4098 w
([[!threads) 1136 4098 w
(flows!]]) 1593 4098 w
(shows) 1978 4098 w
(an) 2286 4098 w
(example.) 2422 4098 w
(If) 2854 4098 w
(there) 2959 4098 w
(are) 3210 4098 w
(two) 3375 4098 w
(processes,) 3574 4098 w
(Plan) 4055 4098 w
(9) 566 4218 w
(may) 659 4218 w
(put) 885 4218 w
(process) 1063 4218 w
(1) 1428 4218 w
(to) 1520 4218 w
(run) 1643 4218 w
(at) 1826 4218 w
(the) 1942 4218 w
(processor) 2113 4218 w
(for) 2569 4218 w
(some) 2733 4218 w
(time.) 3002 4218 w
(During) 3263 4218 w
(this) 3611 4218 w
(time,) 3808 4218 w
(pro\255) 4069 4218 w
(cess) 566 4338 w
(2) 785 4338 w
(would) 877 4338 w
(be) 1189 4338 w
(ready) 1329 4338 w
(to) 1608 4338 w
(run.) 1731 4338 w
(After) 1942 4338 w
(the) 2209 4338 w
(time) 2380 4338 w
(passes,) 2613 4338 w
(there) 2958 4338 w
(is) 3213 4338 w
(a) 3324 4338 w
(context) 3409 4338 w
(switch) 3769 4338 w
(and) 4093 4338 w
(Plan) 566 4458 w
(9) 792 4458 w
(puts) 877 4458 w
(process) 1091 4458 w
(2) 1449 4458 w
(to) 1533 4458 w
(run) 1648 4458 w
(and) 1823 4458 w
(leaves) 2010 4458 w
(process) 2312 4458 w
(1) 2669 4458 w
(as) 2753 4458 w
(ready) 2873 4458 w
(to) 3144 4458 w
(run.) 3259 4458 w
(In) 3490 4458 w
(this) 3610 4458 w
(figure,) 3799 4458 w
(the) 4117 4458 w
(process) 566 4578 w
(1) 929 4578 w
(has) 1019 4578 w
(two) 1200 4578 w
(threads) 1400 4578 w
(in) 1751 4578 w
(it.) 1872 4578 w
(Each) 1998 4578 w
(thread) 2252 4578 w
(thinks) 2561 4578 w
(that) 2867 4578 w
(it) 3068 4578 w
(is) 3166 4578 w
(a) 3276 4578 w
(single,) 3360 4578 w
(independent,) 3687 4578 w
(flow) 566 4698 w
(of) 809 4698 w
(control) 942 4698 w
(\(like) 1295 4698 w
(all) 1538 4698 w
(processes) 1690 4698 w
(think\).) 2151 4698 w
(However,) 2512 4698 w
(both) 2982 4698 w
(threads) 3220 4698 w
(are) 3578 4698 w
(sharing) 3752 4698 w
(the) 4117 4698 w
(time) 566 4818 w
(in) 796 4818 w
(the) 916 4818 w
(processor) 1084 4818 w
(that) 1538 4818 w
(was) 1738 4818 w
(given) 1943 4818 w
(to) 2222 4818 w
(process) 2343 4818 w
(1.) 2706 4818 w
(Looking) 2852 4818 w
(at) 3260 4818 w
(the) 3374 4818 w
(process) 3543 4818 w
(1) 3906 4818 w
(in) 3996 4818 w
(the) 4117 4818 w
(figure) 566 4938 w
(shows) 856 4938 w
(that,) 1160 4938 w
(while) 1382 4938 w
(this) 1655 4938 w
(process) 1844 4938 w
(is) 2201 4938 w
(running,) 2304 4938 w
(the) 2703 4938 w
(time) 2866 4938 w
(is) 3091 4938 w
(used) 3194 4938 w
(to) 3424 4938 w
(execute) 3539 4938 w
(two) 3900 4938 w
(dif\255) 4093 4938 w
(ferent) 566 5058 w
(flows) 848 5058 w
(of) 1120 5058 w
(control,) 1239 5058 w
(one) 1606 5058 w
(for) 1792 5058 w
(each) 1947 5058 w
(thread.) 2174 5058 w
(For) 816 5214 w
(Plan) 1008 5214 w
(9,) 1243 5214 w
(there) 1365 5214 w
(are) 1622 5214 w
(no) 1793 5214 w
(threads.) 1942 5214 w
(The) 2325 5214 w
(kernel) 2534 5214 w
(puts) 2846 5214 w
(process) 3069 5214 w
(1) 3436 5214 w
(to) 3530 5214 w
(run) 3655 5214 w
(and) 3840 5214 w
(what) 4038 5214 w
(process) 566 5334 w
(1) 942 5334 w
(does) 1045 5334 w
(with) 1293 5334 w
(the) 1536 5334 w
(processor) 1717 5334 w
(is) 2183 5334 w
(up) 2304 5334 w
(to) 2461 5334 w
(it.) 2594 5334 w
(Therefore,) 2731 5334 w
(when) 3235 5334 w
(the) 3519 5334 w
(process) 3700 5334 w
(1) 4075 5334 w
(is) 4177 5334 w
(moved) 566 5454 w
(out) 906 5454 w
(of) 1088 5454 w
(the) 1220 5454 w
(processor) 1395 5454 w
(in) 1855 5454 w
(the) 1982 5454 w
(context) 2157 5454 w
(switch,) 2521 5454 w
(both) 2877 5454 w
(threads) 3114 5454 w
(cease) 3471 5454 w
(running.) 3748 5454 w
(In) 4160 5454 w
(fact,) 566 5574 w
(it) 785 5574 w
(is) 875 5574 w
(the) 977 5574 w
(single) 1139 5574 w
(flow) 1430 5574 w
(of) 1659 5574 w
(control) 1778 5574 w
(for) 2117 5574 w
(process) 2272 5574 w
(1) 2628 5574 w
(which) 2711 5574 w
(ceased) 3007 5574 w
(running.) 3325 5574 w
(Why) 816 5730 w
(should) 1076 5730 w
(you) 1417 5730 w
(ever) 1629 5730 w
(want) 1863 5730 w
(to) 2123 5730 w
(use) 2256 5730 w
(threads?) 2449 5730 w
(Unlike) 2889 5730 w
(for) 3236 5730 w
(processes,) 3411 5730 w
(that) 3906 5730 w
(are) 4119 5730 w
(moved) 566 5850 w
(out) 903 5850 w
(of) 1082 5850 w
(the) 1211 5850 w
(processor) 1383 5850 w
(when) 1840 5850 w
(the) 2115 5850 w
(system) 2287 5850 w
(pleases,) 2631 5850 w
(a) 3013 5850 w
(thread) 3098 5850 w
(may) 3408 5850 w
11 /Times-Italic f
(not) 3634 5850 w
11 /Times-Roman f
(be) 3812 5850 w
(moved) 3952 5850 w
(out) 566 5970 w
(of) 744 5970 w
(the) 872 5970 w
(processor) 1043 5970 w
(\(preempted\)) 1499 5970 w
(unless) 2070 5970 w
(you) 2382 5970 w
(call) 2584 5970 w
(functions) 2779 5970 w
(of) 3225 5970 w
(the) 3353 5970 w
(thread) 3524 5970 w
(library) 3835 5970 w
(to) 4165 5970 w
(synchronize) 566 6090 w
(with) 1141 6090 w
(other) 1383 6090 w
(threads.) 1654 6090 w
(What) 2044 6090 w
(does) 2327 6090 w
(this) 2574 6090 w
(mean?) 2779 6090 w
(There) 3109 6090 w
(will) 3408 6090 w
(be) 3625 6090 w
(no) 3773 6090 w
(context) 3928 6090 w
(switch) 566 6210 w
(between) 884 6210 w
(threads) 1279 6210 w
(unless) 1626 6210 w
(you) 1932 6210 w
(allow) 2128 6210 w
(it.) 2403 6210 w
(There) 2524 6210 w
(will) 2809 6210 w
(be) 3012 6210 w
(no) 3147 6210 w
(races!) 3289 6210 w
(You) 3580 6210 w
(are) 3801 6210 w
(free) 3965 6210 w
(to) 4165 6210 w
(touch) 566 6330 w
(any) 850 6330 w
(shared) 1048 6330 w
(data) 1373 6330 w
(structure) 1595 6330 w
(as) 2018 6330 w
(you) 2149 6330 w
(please,) 2354 6330 w
(and) 2695 6330 w
(nobody) 2892 6330 w
(would) 3261 6330 w
(interrupt) 3575 6330 w
(in) 3992 6330 w
(the) 4117 6330 w
cleartomark
showpage
saveobj restore
%%EndPage: 1 1
%%Page: 2 2
/saveobj save def
mark
2 pagesetup
11 /Times-Roman f
(\255 2 \255) 2317 413 w
(middle) 566 686 w
(of) 900 686 w
(a) 1019 686 w
(critical) 1095 686 w
(operation,) 1427 686 w
(provoking) 1897 686 w
(a) 2377 686 w
(race.) 2453 686 w
(This) 816 842 w
(is) 1057 842 w
(the) 1176 842 w
(same) 1355 842 w
(program) 1625 842 w
(used) 2041 842 w
(as) 2287 842 w
(an) 2423 842 w
(example) 2571 842 w
(in) 2987 842 w
(the) 3118 842 w
(beginning) 3297 842 w
(of) 3782 842 w
(the) 3918 842 w
(last) 4098 842 w
(chapter.) 566 962 w
(It) 981 962 w
(increments) 1086 962 w
(a) 1605 962 w
(shared) 1691 962 w
(counter) 2014 962 w
(using) 2379 962 w
(two) 2655 962 w
(different) 2857 962 w
(flows) 3270 962 w
(of) 3551 962 w
(control.) 3679 962 w
(This) 4055 962 w
(time,) 566 1082 w
(we) 821 1082 w
(use) 979 1082 w
(two) 1156 1082 w
(threads) 1352 1082 w
(to) 1700 1082 w
(increment) 1818 1082 w
(the) 2288 1082 w
(counter.) 2454 1082 w
(As) 2842 1082 w
(any) 2996 1082 w
(other) 3186 1082 w
(program) 3443 1082 w
(using) 3846 1082 w
(the) 4117 1082 w
(thread) 566 1202 w
(library,) 875 1202 w
(it) 1231 1202 w
(includes) 1329 1202 w
11 /Courier f
(thread.h) 1731 1202 w
11 /Times-Roman f
(,) 2259 1202 w
(that) 2323 1202 w
(contains) 2523 1202 w
(the) 2924 1202 w
(definitions) 3093 1202 w
(for) 3599 1202 w
(thread) 3761 1202 w
(data) 4069 1202 w
(types) 566 1322 w
(and) 837 1322 w
(functions.) 1034 1322 w
(Also,) 1510 1322 w
(note) 1785 1322 w
(that) 2013 1322 w
(the) 2217 1322 w
(program) 2390 1322 w
(does) 2800 1322 w
11 /Times-Italic f
(not) 3040 1322 w
11 /Times-Roman f
(have) 3220 1322 w
(a) 3465 1322 w
11 /Courier f
(main) 3553 1322 w
11 /Times-Roman f
(function.) 3857 1322 w
(That) 566 1442 w
(function) 799 1442 w
(is) 1197 1442 w
(provided) 1303 1442 w
(by) 1725 1442 w
(the) 1867 1442 w
(thread) 2033 1442 w
(library.) 2338 1442 w
(It) 2690 1442 w
(creates) 2789 1442 w
(a) 3123 1442 w
(single) 3203 1442 w
(thread) 3498 1442 w
(within) 3803 1442 w
(the) 4117 1442 w
(process) 566 1562 w
(that) 928 1562 w
(starts) 1127 1562 w
(executing) 1394 1562 w
(the) 1855 1562 w
(function) 2024 1562 w
11 /Courier f
(threadmain) 2425 1562 w
11 /Times-Roman f
(.) 3085 1562 w
(This) 3176 1562 w
(is) 3407 1562 w
(the) 3516 1562 w
(function) 3685 1562 w
(that) 4086 1562 w
(you) 566 1682 w
(are) 759 1682 w
(expected) 919 1682 w
(to) 1335 1682 w
(provide) 1449 1682 w
(as) 1812 1682 w
(your) 1931 1682 w
(entry) 2160 1682 w
(point.) 2413 1682 w
9 /S f
(\347) 566 1852 w
9 /Times-Bold f
(tincr.c) 581 1852 w
9 /S f
(\347) 844 1852 w
(`) 566 1852 w
(``````) 574 1852 w
(_) 566 1852 w
(______) 574 1852 w
8 /Courier f
(#include <u.h>) 786 1960 w
(#include <libc.h>) 786 2068 w
(#include <thread.h>) 786 2176 w
(int) 786 2392 w
(cnt;) 1266 2392 w
(void) 786 2608 w
(incrthread\(void*\)) 786 2716 w
({) 786 2824 w
(int) 1266 2932 w
(i;) 1746 2932 w
(for \(i = 0; i < 2; i++\)) 1266 3148 w
(cnt++;) 1746 3256 w
(print\("cnt is %d\\n", cnt\);) 1266 3364 w
(threadexits\(nil\);) 1266 3472 w
(}) 786 3580 w
(void) 786 3796 w
(threadmain\(int, char*[]\)) 786 3904 w
({) 786 4012 w
(int) 1266 4120 w
(i;) 1746 4120 w
(threadcreate\(incrthread, nil, 8*1024\);) 1266 4336 w
(for \(i = 0; i < 2; i++\)) 1266 4444 w
(cnt++;) 1746 4552 w
(print\("cnt is %d\\n", cnt\);) 1266 4660 w
(threadexits\(nil\);) 1266 4768 w
(}) 786 4876 w
11 /Times-Roman f
(The) 566 5092 w
(program) 766 5092 w
(calls) 1167 5092 w
11 /Courier f
(threadcreate) 1399 5092 w
11 /Times-Roman f
(to) 2222 5092 w
(create) 2339 5092 w
(a) 2629 5092 w
(new) 2708 5092 w
(thread) 2921 5092 w
(\(the) 3225 5092 w
(second) 3426 5092 w
(in) 3761 5092 w
(this) 3878 5092 w
(pro\255) 4069 5092 w
(cess!\)) 566 5212 w
(that) 863 5212 w
(starts) 1071 5212 w
(executing) 1346 5212 w
(the) 1815 5212 w
(function) 1991 5212 w
11 /Courier f
(incrthread) 2399 5212 w
11 /Times-Roman f
(.) 3059 5212 w
(After) 3157 5212 w
(this) 3429 5212 w
(call,) 3631 5212 w
(there) 3859 5212 w
(are) 4119 5212 w
(two) 566 5332 w
(independent) 761 5332 w
(flows) 1327 5332 w
(of) 1601 5332 w
(control.) 1722 5332 w
(One) 2091 5332 w
(is) 2303 5332 w
(executing) 2407 5332 w
11 /Courier f
(threadmain) 2863 5332 w
11 /Times-Roman f
(,) 3523 5332 w
(after) 3581 5332 w
(the) 3811 5332 w
(call) 3976 5332 w
(to) 4165 5332 w
11 /Courier f
(threadcreate) 566 5452 w
11 /Times-Roman f
(.) 1358 5452 w
(The) 1462 5452 w
(other) 1680 5452 w
(is) 1953 5452 w
(starting) 2075 5452 w
(to) 2453 5452 w
(execute) 2587 5452 w
11 /Courier f
(incrthread) 2967 5452 w
11 /Times-Roman f
(.) 3627 5452 w
(The) 3730 5452 w
(second) 3947 5452 w
(parameter) 566 5572 w
(given) 1034 5572 w
(to) 1310 5572 w
11 /Courier f
(threadcreate) 1428 5572 w
11 /Times-Roman f
(is) 2252 5572 w
(passed) 2358 5572 w
(by) 2682 5572 w
(the) 2825 5572 w
(library) 2992 5572 w
(as) 3317 5572 w
(the) 3441 5572 w
(only) 3608 5572 w
(argument) 3837 5572 w
(for) 566 5692 w
(the) 722 5692 w
(main) 885 5692 w
(procedure) 1134 5692 w
(for) 1599 5692 w
(the) 1755 5692 w
(thread.) 1918 5692 w
(Because) 2276 5692 w
11 /Courier f
(incrthread) 2669 5692 w
11 /Times-Roman f
(does) 3358 5692 w
(not) 3587 5692 w
(require) 3756 5692 w
(any) 4093 5692 w
(argument,) 566 5812 w
(we) 1044 5812 w
(pass) 1207 5812 w
(a) 1432 5812 w
11 /Courier f
(nil) 1516 5812 w
11 /Times-Roman f
(pointer.) 1750 5812 w
(The) 2153 5812 w
(third) 2359 5812 w
(argument) 2603 5812 w
(to) 3054 5812 w
11 /Courier f
(threadcreate) 3177 5812 w
11 /Times-Roman f
(is) 4006 5812 w
(the) 4117 5812 w
(thread's) 566 5932 w
(stack) 959 5932 w
(size.) 1225 5932 w
(The) 1464 5932 w
(stack) 1675 5932 w
(for) 1941 5932 w
(a) 2108 5932 w
(thread) 2196 5932 w
(is) 2509 5932 w
(allocated) 2623 5932 w
(as) 3058 5932 w
(a) 3189 5932 w
(byte) 3277 5932 w
(array) 3506 5932 w
(in) 3769 5932 w
(the) 3895 5932 w
(data) 4069 5932 w
(segment,) 566 6052 w
(like) 1005 6052 w
(other) 1215 6052 w
(dynamic) 1485 6052 w
(variables,) 1908 6052 w
(it) 2376 6052 w
(lives) 2483 6052 w
(in) 2736 6052 w
(the) 2867 6052 w
(heap) 3046 6052 w
(\(within) 3297 6052 w
(the) 3661 6052 w
(data) 3841 6052 w
(seg\255) 4069 6052 w
(ment\).) 566 6172 w
(It) 816 6328 w
(is) 919 6328 w
(interesting) 1029 6328 w
(to) 1529 6328 w
(see) 1651 6328 w
(that) 1826 6328 w
(threads) 2027 6328 w
(call) 2380 6328 w
11 /Courier f
(threadexits) 2575 6328 w
11 /Times-Roman f
(to) 3338 6328 w
(terminate,) 3461 6328 w
(instead) 3940 6328 w
cleartomark
showpage
saveobj restore
%%EndPage: 2 2
%%Page: 3 3
/saveobj save def
mark
3 pagesetup
11 /Times-Roman f
(\255 3 \255) 2317 413 w
(of) 566 686 w
(calling) 702 686 w
11 /Courier f
(exits) 1046 686 w
11 /Times-Roman f
(.) 1376 686 w
(Calling) 1477 686 w
11 /Courier f
(exits) 1847 686 w
11 /Times-Roman f
(would) 2221 686 w
(terminate) 2540 686 w
(the) 2998 686 w
(entire) 3176 686 w
(process) 3469 686 w
(\(the) 3841 686 w
(only) 4055 686 w
(flow) 566 806 w
(of) 801 806 w
(control) 926 806 w
(provided) 1271 806 w
(by) 1695 806 w
(Plan) 1839 806 w
(9\).) 2069 806 w
(When) 2250 806 w
(all) 2545 806 w
(the) 2689 806 w
(threads) 2857 806 w
(in) 3207 806 w
(the) 3327 806 w
(process) 3496 806 w
(have) 3859 806 w
(ter\255) 4100 806 w
(minated) 566 926 w
(their) 951 926 w
(main) 1183 926 w
(functions,) 1434 926 w
(or) 1902 926 w
(called) 2024 926 w
11 /Courier f
(threadexits) 2316 926 w
11 /Times-Roman f
(,) 3042 926 w
(the) 3101 926 w
(thread) 3266 926 w
(library) 3569 926 w
(will) 3891 926 w
(call) 4093 926 w
11 /Courier f
(exits) 566 1046 w
11 /Times-Roman f
(to) 927 1046 w
(terminate) 1044 1046 w
(the) 1489 1046 w
(entire) 1654 1046 w
(process.) 1934 1046 w
(The) 2321 1046 w
(exit) 2522 1046 w
(status) 2718 1046 w
(for) 3000 1046 w
(the) 3158 1046 w
(whole) 3323 1046 w
(process) 3622 1046 w
(is) 3981 1046 w
(that) 4086 1046 w
(given) 566 1166 w
(as) 845 1166 w
(a) 971 1166 w
(parameter) 1054 1166 w
(to) 1525 1166 w
(the) 1646 1166 w
(last) 1815 1166 w
(thread) 2002 1166 w
(to) 2309 1166 w
(exit,) 2429 1166 w
(which) 2656 1166 w
(is) 2958 1166 w
(a) 3066 1166 w
(reasonable) 3148 1166 w
(behavior.) 3649 1166 w
(By) 4122 1166 w
(the) 566 1286 w
(way,) 735 1286 w
(there) 980 1286 w
(is) 1233 1286 w
(a) 1342 1286 w
(more) 1425 1286 w
(radical) 1685 1286 w
(function) 2017 1286 w
(for) 2418 1286 w
(exiting) 2580 1286 w
(that) 2921 1286 w
(terminates) 3121 1286 w
11 /Times-Italic f
(all) 3613 1286 w
11 /Times-Roman f
(the) 3765 1286 w
(threads) 3935 1286 w
(in) 566 1406 w
(the) 680 1406 w
(process,) 842 1406 w
(it) 1226 1406 w
(is) 1316 1406 w
(called) 1418 1406 w
11 /Courier f
(threadexitsall) 1707 1406 w
11 /Times-Roman f
(and) 2659 1406 w
(is) 2845 1406 w
(used) 2947 1406 w
(in) 3176 1406 w
(the) 3290 1406 w
(same) 3452 1406 w
(way.) 3705 1406 w
(And) 816 1562 w
(is) 1033 1562 w
(this) 1135 1562 w
(is) 1323 1562 w
(what) 1425 1562 w
(we) 1666 1562 w
(get) 1821 1562 w
(for) 1983 1562 w
(using) 2138 1562 w
(threads) 2405 1562 w
(instead) 2749 1562 w
(of) 3088 1562 w
(processes.) 3207 1562 w
(The) 3682 1562 w
(program) 3880 1562 w
(will) 566 1682 w
(always) 766 1682 w
(produce) 1098 1682 w
(this) 1478 1682 w
(output) 1666 1682 w
(\(although) 1976 1682 w
(the) 2425 1682 w
(order) 2587 1682 w
(of) 2845 1682 w
11 /Courier f
(prints) 2964 1682 w
11 /Times-Roman f
(may) 3388 1682 w
(vary\)) 3605 1682 w
10 /Courier f
(; !!8.tincr) 786 1852 w
(cnt is 2) 786 1962 w
(cnt is 4) 786 2072 w
11 /Times-Roman f
(And) 566 2288 w
(there) 791 2288 w
(are) 1045 2288 w
(no) 1213 2288 w
(races!) 1359 2288 w
(When) 1654 2288 w
(a) 1951 2288 w
(thread) 2035 2288 w
(starts) 2344 2288 w
(executing,) 2612 2288 w
(it) 3102 2288 w
(will) 3201 2288 w
(continue) 3410 2288 w
(executing) 3825 2288 w
(until) 566 2408 w
(it) 808 2408 w
(calls) 909 2408 w
11 /Courier f
(threadexits) 1149 2408 w
11 /Times-Roman f
(.) 1875 2408 w
(We) 1970 2408 w
(did) 2160 2408 w
(not) 2340 2408 w
(call) 2520 2408 w
(any) 2717 2408 w
(function) 2914 2408 w
(of) 3319 2408 w
(the) 3448 2408 w
(thread) 3620 2408 w
(library,) 3931 2408 w
(and) 566 2528 w
(there) 754 2528 w
(is) 1002 2528 w
(no) 1106 2528 w
(magic.) 1246 2528 w
(There) 1572 2528 w
(is) 1856 2528 w
(no) 1960 2528 w
(way) 2100 2528 w
(the) 2312 2528 w
(thread) 2476 2528 w
(could) 2779 2528 w
(suffer) 3053 2528 w
(a) 3337 2528 w
(context) 3415 2528 w
(switch) 3768 2528 w
(in) 4086 2528 w
(a) 4203 2528 w
(bad) 566 2648 w
(moment.) 758 2648 w
(The) 1181 2648 w
(program) 1385 2648 w
(is) 1790 2648 w
(safe,) 1898 2648 w
(although) 2135 2648 w
(it) 2554 2648 w
(does) 2650 2648 w
(not) 2885 2648 w
(use) 3060 2648 w
(even) 3240 2648 w
(a) 3480 2648 w
(single) 3562 2648 w
(lock.) 3858 2648 w
(Of) 4136 2648 w
(course,) 566 2768 w
(if) 911 2768 w
(a) 1010 2768 w
(thread) 1090 2768 w
(loops) 1395 2768 w
(for) 1667 2768 w
(a) 1827 2768 w
(long) 1908 2768 w
(time) 2137 2768 w
(without) 2366 2768 w
(giving) 2736 2768 w
(other) 3051 2768 w
(threads) 3309 2768 w
(the) 3658 2768 w
(chance) 3825 2768 w
(of) 4160 2768 w
(running,) 566 2888 w
(the) 967 2888 w
(poor) 1132 2888 w
(other) 1364 2888 w
(threads) 1620 2888 w
(will) 1966 2888 w
(wait) 2168 2888 w
(a) 2387 2888 w
(very) 2465 2888 w
(long) 2689 2888 w
(time) 2915 2888 w
(until) 3141 2888 w
(they) 3374 2888 w
(run.) 3593 2888 w
(But) 3797 2888 w
(this) 3987 2888 w
(is) 4177 2888 w
(seldom) 566 3008 w
(the) 912 3008 w
(case.) 1074 3008 w
(What) 816 3164 w
(if) 1087 3164 w
(we) 1188 3164 w
(modify) 1349 3164 w
(the) 1701 3164 w
(program) 1869 3164 w
(as) 2274 3164 w
(we) 2399 3164 w
(did) 2560 3164 w
(with) 2736 3164 w
(the) 2967 3164 w
(one) 3136 3164 w
(with) 3329 3164 w
(processes?) 3560 3164 w
(You) 4062 3164 w
(may) 566 3284 w
(think) 787 3284 w
(that) 1046 3284 w
(using) 1243 3284 w
(a) 1514 3284 w
11 /Courier f
(sleep) 1594 3284 w
11 /Times-Roman f
(may) 1956 3284 w
(lead) 2177 3284 w
(to) 2391 3284 w
(a) 2508 3284 w
(context) 2587 3284 w
(switch,) 2941 3284 w
(and) 3287 3284 w
(expose) 3476 3284 w
(a) 3811 3284 w
(possible) 3890 3284 w
(race) 566 3404 w
(condition.) 774 3404 w
(Although) 1246 3404 w
(this) 1690 3404 w
(is) 1878 3404 w
(not) 1980 3404 w
(the) 2149 3404 w
(case,) 2311 3404 w
(let's) 2554 3404 w
(try) 2771 3404 w
(it.) 2921 3404 w
cleartomark
showpage
saveobj restore
%%EndPage: 3 3
%%Page: 4 4
/saveobj save def
mark
4 pagesetup
11 /Times-Roman f
(\255 4 \255) 2317 413 w
9 /S f
(\347) 566 676 w
9 /Times-Bold f
(tincr2.c) 581 676 w
9 /S f
(\347) 889 676 w
(`) 566 676 w
(```````) 574 676 w
(_) 566 676 w
(_______) 574 676 w
8 /Courier f
(#include <u.h>) 786 784 w
(#include <libc.h>) 786 892 w
(#include <thread.h>) 786 1000 w
(int) 786 1216 w
(cnt;) 1266 1216 w
(void) 786 1432 w
(incrthread\(void*\)) 786 1540 w
({) 786 1648 w
(int) 1266 1756 w
(i;) 1746 1756 w
(int) 1266 1864 w
(loc;) 1746 1864 w
(for \(i = 0; i < 2; i++\){) 1266 2080 w
(loc = cnt;) 1746 2188 w
(loc++;) 1746 2296 w
(sleep\(0\);) 1746 2404 w
(cnt = loc;) 1746 2512 w
(}) 1266 2620 w
(print\("cnt is %d\\n", cnt\);) 1266 2728 w
(threadexits\(nil\);) 1266 2836 w
(}) 786 2944 w
(void) 786 3160 w
(threadmain\(int, char*[]\)) 786 3268 w
({) 786 3376 w
(threadcreate\(incrthread, nil, 8*1024\);) 1266 3484 w
(incrthread\(nil\);) 1266 3592 w
(}) 786 3700 w
11 /Times-Roman f
(Executions) 566 3916 w
(for) 1082 3916 w
(this) 1237 3916 w
(program) 1425 3916 w
(yield) 1824 3916 w
(the) 2072 3916 w
(same) 2234 3916 w
(result) 2487 3916 w
(we) 2759 3916 w
(expect.) 2914 3916 w
10 /Courier f
(; 8.tincr2) 786 4086 w
(cnt is 2) 786 4196 w
(cnt is 4) 786 4306 w
11 /Times-Roman f
(No) 566 4522 w
(race) 728 4522 w
(was) 936 4522 w
(exposed.) 1134 4522 w
(Indeed,) 1549 4522 w
(no) 1902 4522 w
(thread) 2040 4522 w
(was) 2341 4522 w
(ever) 2539 4522 w
(moved) 2754 4522 w
(out) 3081 4522 w
(of) 3250 4522 w
(the) 3369 4522 w
(processor) 3531 4522 w
(by) 3978 4522 w
(the) 4117 4522 w
(call) 566 4642 w
(to) 764 4642 w
11 /Courier f
(sleep) 890 4642 w
11 /Times-Roman f
(.) 1220 4642 w
(If) 1316 4642 w
(the) 1428 4642 w
(first) 1602 4642 w
(thread) 1818 4642 w
(was) 2130 4642 w
(executing) 2339 4642 w
11 /Courier f
(incrthread) 2804 4642 w
11 /Times-Roman f
(,) 3464 4642 w
(the) 3531 4642 w
(call) 3704 4642 w
(to) 3901 4642 w
(sleep) 4026 4642 w
(moved) 566 4762 w
(the) 899 4762 w
(whole) 1067 4762 w
(process) 1369 4762 w
(out) 1731 4762 w
(of) 1906 4762 w
(the) 2032 4762 w
(processor,) 2201 4762 w
(as) 2683 4762 w
(shown) 2809 4762 w
(in) 3131 4762 w
(figure) 3252 4762 w
([[!thread) 3548 4762 w
(moves) 3964 4762 w
(out!]].) 566 4882 w
(When) 878 4882 w
(later,) 1174 4882 w
(the) 1431 4882 w
(process) 1600 4882 w
(was) 1963 4882 w
(put) 2168 4882 w
(back) 2344 4882 w
(into) 2585 4882 w
(the) 2792 4882 w
(running) 2960 4882 w
(state,) 3336 4882 w
(the) 3599 4882 w
(first) 3767 4882 w
(thread) 3978 4882 w
(was) 566 5002 w
(still) 768 5002 w
(the) 967 5002 w
(one) 1133 5002 w
(running.) 1323 5002 w
(Remember,) 1753 5002 w
(the) 2295 5002 w
(underlying) 2462 5002 w
(Plan) 2971 5002 w
(9) 3200 5002 w
(kernel) 3288 5002 w
(knows) 3594 5002 w
11 /Times-Italic f
(nothing) 3914 5002 w
11 /Times-Roman f
(about) 566 5122 w
(threads.) 849 5122 w
(The) 1231 5122 w
(call) 1439 5122 w
(to) 1635 5122 w
11 /Courier f
(sleep) 1759 5122 w
11 /Times-Roman f
(puts) 2127 5122 w
(the) 2349 5122 w
(process) 2521 5122 w
(to) 2887 5122 w
(sleep.) 3011 5122 w
(Of) 3302 5122 w
(course,) 3455 5122 w
(the) 3806 5122 w
(thread) 3978 5122 w
(went) 566 5242 w
(to) 812 5242 w
(sleep) 931 5242 w
(as) 1189 5242 w
(a) 1313 5242 w
(result,) 1394 5242 w
(like) 1699 5242 w
11 /Times-Italic f
(all) 1897 5242 w
11 /Times-Roman f
(other) 2047 5242 w
(threads) 2305 5242 w
(in) 2654 5242 w
(the) 2773 5242 w
(process.) 2941 5242 w
(But) 3331 5242 w
(in) 3525 5242 w
(any) 3645 5242 w
(case,) 3837 5242 w
(you) 4086 5242 w
(did) 566 5362 w
(not) 744 5362 w
(call) 922 5362 w
(any) 1117 5362 w
(function) 1312 5362 w
(from) 1715 5362 w
(the) 1965 5362 w
(thread) 2136 5362 w
(library,) 2446 5362 w
(and) 2803 5362 w
(there) 2998 5362 w
(was) 3253 5362 w
11 /Times-Italic f
(no) 3459 5362 w
11 /Times-Roman f
(context) 3605 5362 w
(switch) 3964 5362 w
(between) 566 5482 w
(threads.) 962 5482 w
(For) 1338 5482 w
(the) 1523 5482 w
(thread) 1689 5482 w
(library,) 1994 5482 w
(it) 2346 5482 w
(seems) 2441 5482 w
(that) 2742 5482 w
(the) 2940 5482 w
(first) 3107 5482 w
(thread) 3317 5482 w
(is) 3623 5482 w
(still) 3730 5482 w
(execut\255) 3930 5482 w
(ing) 566 5602 w
(in) 735 5602 w
(very) 849 5602 w
(much) 1071 5602 w
(the) 1343 5602 w
(same) 1505 5602 w
(way) 1758 5602 w
(that) 1968 5602 w
(if) 2161 5602 w
(you) 2256 5602 w
(never) 2449 5602 w
(called) 2719 5602 w
11 /Courier f
(sleep) 3008 5602 w
11 /Times-Roman f
(.) 3338 5602 w
cleartomark
showpage
saveobj restore
%%EndPage: 4 4
%%Page: 5 5
/saveobj save def
mark
5 pagesetup
11 /Times-Roman f
(\255 5 \255) 2317 413 w
10 /Times-Roman f
(Our process:) 741 893 w
1603 760 1976 760 Dl
(1st thread) 1595 720 w
1978 760 2351 760 Dl
1603 985 1640 985 Dl
1688 985 1725 985 Dl
1772 985 1809 985 Dl
1856 985 1893 985 Dl
1940 985 1977 985 Dl
(2nd thread) 1578 945 w
1978 985 2015 985 Dl
2061 985 2098 985 Dl
2145 985 2182 985 Dl
2230 985 2267 985 Dl
2314 985 2351 985 Dl
(ready) 2054 945 w
7 /Times-Roman f
(.) 2341 876 w
(.) 2379 876 w
(.) 2416 876 w
(.) 2454 876 w
(.) 2491 876 w
10 /Times-Roman f
(sleep) 2426 833 w
2501 873 3473 873 Dl
(ready) 2877 833 w
3474 760 3847 760 Dl
(run) 3594 720 w
(...) 3848 780 w
3474 985 3511 985 Dl
3557 985 3594 985 Dl
3642 985 3679 985 Dl
3726 985 3763 985 Dl
3810 985 3847 985 Dl
(ready) 3550 945 w
(...) 3848 1005 w
(Another process:) 569 1641 w
1603 1621 1640 1621 Dl
1675 1621 1712 1621 Dl
1746 1621 1783 1621 Dl
1818 1621 1855 1621 Dl
1889 1621 1926 1621 Dl
1960 1621 1997 1621 Dl
2032 1621 2069 1621 Dl
2103 1621 2140 1621 Dl
2175 1621 2212 1621 Dl
2246 1621 2283 1621 Dl
2318 1621 2355 1621 Dl
2389 1621 2426 1621 Dl
(ready) 1905 1581 w
2426 1621 3398 1621 Dl
(run) 2846 1581 w
3399 1621 3436 1621 Dl
3467 1621 3504 1621 Dl
3536 1621 3573 1621 Dl
3604 1621 3641 1621 Dl
3673 1621 3710 1621 Dl
3742 1621 3779 1621 Dl
3810 1621 3847 1621 Dl
(ready) 3513 1581 w
(...) 3848 1641 w
7 /Times-Roman f
(.) 2341 763 w
(.) 2345 801 w
(.) 2348 838 w
(.) 2351 876 w
(.) 2354 913 w
(.) 2358 951 w
(.) 2361 988 w
(.) 2364 1025 w
(.) 2367 1062 w
(.) 2371 1100 w
(.) 2374 1137 w
(.) 2377 1175 w
(.) 2380 1212 w
(.) 2384 1249 w
(.) 2387 1287 w
(.) 2390 1324 w
(.) 2393 1362 w
(.) 2397 1399 w
(.) 2400 1437 w
(.) 2403 1474 w
(.) 2406 1511 w
(.) 2410 1549 w
(.) 2413 1586 w
(.) 2416 1624 w
2401 1547 2426 1619 Dl
2407 1546 2426 1620 Dl
2413 1544 2425 1620 Dl
2420 1544 2426 1621 Dl
2426 1544 2426 1621 Dl
2432 1544 2427 1621 Dl
2438 1544 2426 1620 Dl
10 /Times-Roman f
(context switch because of) 1713 1210 w
10 /Courier f
(sleep) 2766 1210 w
7 /Times-Roman f
(.) 3389 1624 w
(.) 3392 1586 w
(.) 3395 1549 w
(.) 3398 1511 w
(.) 3402 1474 w
(.) 3405 1437 w
(.) 3408 1399 w
(.) 3411 1362 w
(.) 3415 1324 w
(.) 3418 1287 w
(.) 3421 1249 w
(.) 3424 1212 w
(.) 3428 1175 w
(.) 3431 1137 w
(.) 3434 1100 w
(.) 3437 1062 w
(.) 3441 1025 w
(.) 3444 988 w
(.) 3447 951 w
(.) 3450 913 w
(.) 3454 876 w
(.) 3457 838 w
(.) 3460 801 w
(.) 3464 763 w
3485 837 3473 761 Dl
3480 837 3475 760 Dl
3473 837 3473 760 Dl
3467 837 3473 760 Dl
3461 836 3473 760 Dl
3454 835 3473 761 Dl
3449 833 3474 761 Dl
11 /Times-Roman f
(Only) 816 2041 w
(when) 1081 2041 w
(the) 1363 2041 w
(first) 1542 2041 w
(thread) 1765 2041 w
(calls) 2084 2041 w
11 /Courier f
(threadexits) 2331 2041 w
11 /Times-Roman f
(,) 3057 2041 w
(the) 3131 2041 w
(second) 3311 2041 w
(thread) 3661 2041 w
(gets) 3980 2041 w
(a) 4203 2041 w
(chance) 566 2161 w
(to) 905 2161 w
(run.) 1028 2161 w
(The) 1239 2161 w
(thread) 1445 2161 w
(library) 1754 2161 w
(releases) 2082 2161 w
(the) 2463 2161 w
(resources) 2633 2161 w
(for) 3081 2161 w
(the) 3244 2161 w
(exiting) 3414 2161 w
(thread,) 3756 2161 w
(and) 4093 2161 w
(switches) 566 2281 w
(to) 975 2281 w
(the) 1092 2281 w
(other) 1257 2281 w
(thread) 1513 2281 w
(in) 1817 2281 w
(the) 1934 2281 w
(process) 2100 2281 w
(\(that) 2460 2281 w
(was) 2693 2281 w
(ready) 2895 2281 w
(to) 3169 2281 w
(run\).) 3287 2281 w
(This) 3529 2281 w
(thread) 3757 2281 w
(runs) 4062 2281 w
(to) 566 2401 w
(completion,) 683 2401 w
(like) 1237 2401 w
(its) 1433 2401 w
(sibling,) 1569 2401 w
(and) 1929 2401 w
(after) 2118 2401 w
(calling) 2348 2401 w
11 /Courier f
(threadexits) 2677 2401 w
11 /Times-Roman f
(,) 3403 2401 w
(the) 3461 2401 w
(whole) 3625 2401 w
(process) 3923 2401 w
(is) 566 2521 w
(terminated) 671 2521 w
(by) 1171 2521 w
(the) 1312 2521 w
(thread) 1477 2521 w
(library) 1781 2521 w
(\(by) 2104 2521 w
(a) 2281 2521 w
(call) 2360 2521 w
(to) 2549 2521 w
11 /Courier f
(exits) 2667 2521 w
11 /Times-Roman f
(\),) 2997 2521 w
(because) 3093 2521 w
(there) 3470 2521 w
(are) 3720 2521 w
(no) 3884 2521 w
(more) 4026 2521 w
(threads) 566 2641 w
(in) 910 2641 w
(this) 1024 2641 w
(process.) 1212 2641 w
(How) 816 2797 w
(can) 1078 2797 w
(a) 1278 2797 w
(thread) 1376 2797 w
(abandon) 1699 2797 w
(voluntarily) 2120 2797 w
(the) 2653 2797 w
(processor?) 2837 2797 w
(E.g.,) 3354 2797 w
(to) 3610 2797 w
(favor) 3746 2797 w
(other) 4026 2797 w
(threads.) 566 2917 w
(The) 968 2917 w
(function) 1168 2917 w
11 /Courier f
(yield) 1564 2917 w
11 /Times-Roman f
(in) 1924 2917 w
(the) 2040 2917 w
(thread) 2204 2917 w
(library) 2507 2917 w
(makes) 2829 2917 w
(a) 3139 2917 w
(context) 3217 2917 w
(switch) 3570 2917 w
(between) 3887 2917 w
(threads.) 566 3037 w
(Any) 940 3037 w
(other) 1159 3037 w
(thread) 1414 3037 w
(ready) 1717 3037 w
(to) 1989 3037 w
(run) 2105 3037 w
(will) 2281 3037 w
(be) 2483 3037 w
(put) 2616 3037 w
(to) 2788 3037 w
(execute.) 2905 3037 w
(Of) 3297 3037 w
(course,) 3443 3037 w
(if) 3787 3037 w
(no) 3885 3037 w
(more) 4026 3037 w
(threads) 566 3157 w
(are) 935 3157 w
(ready) 1120 3157 w
(to) 1415 3157 w
(run) 1554 3157 w
11 /Courier f
(yield) 1753 3157 w
11 /Times-Roman f
(will) 2136 3157 w
(return) 2360 3157 w
(immediately) 2673 3157 w
(to) 3275 3157 w
(the) 3413 3157 w
(calling) 3599 3157 w
(thread.) 3950 3157 w
(Therefore,) 566 3277 w
(this) 1051 3277 w
(change) 1239 3277 w
(to) 1576 3277 w
11 /Courier f
(incrthread) 1690 3277 w
11 /Times-Italic f
(creates) 2378 3277 w
11 /Times-Roman f
(a) 2722 3277 w
(bug) 2798 3277 w
(in) 2991 3277 w
(our) 3105 3277 w
(program.) 3279 3277 w
10 /Courier f
(for \(i = 0; i < 2; i++\){) 786 3447 w
(loc = cnt;) 1266 3557 w
(loc++;) 1266 3667 w
(yield\(\);) 1266 3777 w
(cnt = loc;) 1266 3887 w
(}) 786 3997 w
11 /Times-Roman f
(The) 566 4213 w
(call) 780 4213 w
(to) 982 4213 w
11 /Courier f
(yield) 1112 4213 w
11 /Times-Italic f
(forces) 1487 4213 w
11 /Times-Roman f
(a) 1800 4213 w
(context) 1893 4213 w
(switch) 2261 4213 w
(at) 2593 4213 w
(the) 2717 4213 w
(worst) 2896 4213 w
(moment.) 3185 4213 w
(But) 3619 4213 w
(note) 3824 4213 w
(that,) 4058 4213 w
(unlike) 566 4333 w
(when) 869 4333 w
(using) 1134 4333 w
(processes,) 1401 4333 w
(this) 1876 4333 w
(time) 2064 4333 w
(you) 2288 4333 w
11 /Times-Italic f
(had) 2481 4333 w
(to) 2674 4333 w
11 /Times-Roman f
(ask) 2788 4333 w
(for) 2962 4333 w
(the) 3117 4333 w
(context) 3279 4333 w
(switch.) 3630 4333 w
16 /Times-Bold f
(11.2.) 566 4693 w
(Thread) 966 4693 w
(names) 1513 4693 w
11 /Times-Roman f
(Like) 816 4849 w
(processes,) 1056 4849 w
(threads) 1542 4849 w
(have) 1897 4849 w
(identifiers.) 2142 4849 w
(The) 2654 4849 w
(thread) 2863 4849 w
(library) 3175 4849 w
(assigns) 3506 4849 w
(a) 3864 4849 w
(unique) 3952 4849 w
(integer) 566 4969 w
(to) 906 4969 w
(each) 1028 4969 w
(thread,) 1263 4969 w
(known) 1600 4969 w
(as) 1935 4969 w
(its) 2062 4969 w
11 /Times-Bold f
(thread) 2203 4969 w
(id) 2550 4969 w
11 /Times-Roman f
(.) 2643 4969 w
(Do) 2735 4969 w
(not) 2905 4969 w
(confuse) 3082 4969 w
(the) 3457 4969 w
(thread) 3626 4969 w
(id) 3934 4969 w
(with) 4055 4969 w
(the) 566 5089 w
(PID) 737 5089 w
(for) 951 5089 w
(the) 1115 5089 w
(process) 1286 5089 w
(where) 1651 5089 w
(the) 1954 5089 w
(thread) 2125 5089 w
(is) 2435 5089 w
(running.) 2546 5089 w
(The) 2981 5089 w
(former) 3188 5089 w
(is) 3522 5089 w
(known) 3633 5089 w
(by) 3969 5089 w
(the) 4117 5089 w
(thread) 566 5209 w
(library,) 880 5209 w
(and) 1241 5209 w
(unknown) 1440 5209 w
(to) 1890 5209 w
(the) 2017 5209 w
(underlying) 2192 5209 w
(Plan) 2709 5209 w
(9.) 2946 5209 w
(The) 3098 5209 w
(next) 3309 5209 w
(program) 3538 5209 w
(creates) 3949 5209 w
(several) 566 5329 w
(threads,) 909 5329 w
(that) 1287 5329 w
(print) 1486 5329 w
(their) 1728 5329 w
(own) 1963 5329 w
(ids.) 2186 5329 w
(The) 2377 5329 w
(call) 2581 5329 w
(to) 2773 5329 w
11 /Courier f
(threadid) 2893 5329 w
11 /Times-Roman f
(returns) 3456 5329 w
(the) 3795 5329 w
(identi\255) 3964 5329 w
(fier) 566 5449 w
(of) 745 5449 w
(the) 864 5449 w
(thread) 1026 5449 w
(that) 1327 5449 w
(calls) 1520 5449 w
(the) 1749 5449 w
(function.) 1911 5449 w
(The) 816 5605 w
(function) 1018 5605 w
11 /Courier f
(threadcreate) 1417 5605 w
11 /Times-Roman f
(returns) 2242 5605 w
(the) 2579 5605 w
(identifier) 2746 5605 w
(for) 3181 5605 w
(the) 3341 5605 w
(thread) 3508 5605 w
(it) 3814 5605 w
(created,) 3909 5605 w
(and) 566 5725 w
(the) 757 5725 w
(program) 924 5725 w
(prints) 1328 5725 w
(this) 1612 5725 w
(value) 1805 5725 w
(as) 2075 5725 w
(well,) 2199 5725 w
(to) 2449 5725 w
(let) 2568 5725 w
(you) 2711 5725 w
(see) 2909 5725 w
(how) 3081 5725 w
(things) 3303 5725 w
(match.) 3606 5725 w
(In) 3934 5725 w
(gen\255) 4057 5725 w
(eral,) 566 5845 w
11 /Courier f
(threadid) 787 5845 w
11 /Times-Roman f
(is) 1345 5845 w
(used) 1449 5845 w
(when) 1680 5845 w
(a) 1947 5845 w
(thread) 2025 5845 w
(wants) 2328 5845 w
(to) 2614 5845 w
(know) 2731 5845 w
(its) 3006 5845 w
(own) 3142 5845 w
(identifier.) 3362 5845 w
(However,) 3823 5845 w
(to) 566 5965 w
(know) 698 5965 w
(the) 988 5965 w
(ids) 1168 5965 w
(for) 1343 5965 w
(some) 1515 5965 w
(threads) 1792 5965 w
(created,) 2153 5965 w
(it) 2540 5965 w
(suffices) 2647 5965 w
(to) 3032 5965 w
(record) 3163 5965 w
(the) 3486 5965 w
(return) 3665 5965 w
(values) 3971 5965 w
(when) 566 6085 w
11 /Courier f
(threadcreate) 831 6085 w
11 /Times-Roman f
(is) 1651 6085 w
(called.) 1753 6085 w
(The) 2070 6085 w
(program) 2268 6085 w
(prints) 2668 6085 w
(the) 2948 6085 w
(PID) 3111 6085 w
(along) 3317 6085 w
(with) 3590 6085 w
(the) 3815 6085 w
(thread) 3978 6085 w
(ids,) 566 6205 w
(to) 751 6205 w
(let) 865 6205 w
(you) 1003 6205 w
(clearly) 1196 6205 w
(see) 1521 6205 w
(the) 1688 6205 w
(difference.) 1850 6205 w
cleartomark
showpage
saveobj restore
%%EndPage: 5 5
%%Page: 6 6
/saveobj save def
mark
6 pagesetup
11 /Times-Roman f
(\255 6 \255) 2317 413 w
9 /S f
(\347) 566 676 w
9 /Times-Bold f
(tid.c) 581 676 w
9 /S f
(\347) 764 676 w
(`) 566 676 w
(````) 584 676 w
(_) 566 676 w
(____) 584 676 w
8 /Courier f
(#include <u.h>) 786 784 w
(#include <libc.h>) 786 892 w
(#include <thread.h>) 786 1000 w
(void) 786 1108 w
(threadfunc\(void*\)) 786 1216 w
({) 786 1324 w
(print\("thread id= %d\\tpid=%d\\n", threadid\(\), getpid\(\)\);) 1266 1432 w
(threadexits\(nil\);) 1266 1540 w
(}) 786 1648 w
(void) 786 1864 w
(threadmain\(int, char*[]\)) 786 1972 w
({) 786 2080 w
(int) 1266 2188 w
(i, id;) 1746 2188 w
(print\("thread id= %d\\tpid=%d\\n", threadid\(\), getpid\(\)\);) 1266 2404 w
(for \(i = 0; i < 2; i++\){) 1266 2512 w
(id = threadcreate\(threadfunc, nil, 8*1024\);) 1746 2620 w
(print\("\\tcreated thread %d\\n", id\);) 1746 2728 w
(}) 1266 2836 w
(}) 786 3052 w
11 /Times-Roman f
(This) 566 3268 w
(is) 790 3268 w
(the) 892 3268 w
(output) 1054 3268 w
(from) 1364 3268 w
(the) 1605 3268 w
(program.) 1767 3268 w
10 /Courier f
(; 8.tid) 786 3438 w
(thread id= 1) 786 3548 w
(pid=3904) 1746 3548 w
(created thread 2) 1266 3658 w
(created thread 3) 1266 3768 w
(thread id= 2) 786 3878 w
(pid=3904) 1746 3878 w
(thread id= 3) 786 3988 w
(pid=3904) 1746 3988 w
11 /Times-Roman f
(What) 566 4204 w
(would) 833 4204 w
(happen) 1138 4204 w
(if) 1485 4204 w
(we) 1583 4204 w
(implement) 1741 4204 w
11 /Courier f
(cnt) 2243 4204 w
11 /Times-Roman f
(from) 2472 4204 w
(the) 2716 4204 w
(last) 2881 4204 w
(chapter,) 3065 4204 w
(but) 3445 4204 w
(using) 3617 4204 w
(threads?) 3887 4204 w
(This) 566 4324 w
(program) 792 4324 w
(used) 1193 4324 w
(two) 1424 4324 w
(flow) 1619 4324 w
(of) 1850 4324 w
(controls.) 1971 4324 w
(One) 2383 4324 w
(was) 2594 4324 w
(kept) 2793 4324 w
(incrementing) 3011 4324 w
(a) 3619 4324 w
(counter.) 3696 4324 w
(The) 4081 4324 w
(other) 566 4444 w
(one) 821 4444 w
(tried) 1009 4444 w
(always) 1241 4444 w
(to) 1576 4444 w
(decrement) 1693 4444 w
(the) 2179 4444 w
(counter,) 2344 4444 w
(but) 2731 4444 w
(not) 2903 4444 w
(below) 3075 4444 w
(zero.) 3374 4444 w
(The) 3648 4444 w
(next) 3849 4444 w
(pro\255) 4069 4444 w
(gram) 566 4564 w
(creates) 819 4564 w
(two) 1149 4564 w
(threads.) 1342 4564 w
(One) 1714 4564 w
(runs) 1924 4564 w
(this) 2141 4564 w
(function.) 2329 4564 w
10 /Courier f
(void) 786 4734 w
(incr\(void* arg\)) 786 4844 w
({) 786 4954 w
(int*) 1266 5064 w
(cp = arg;) 1746 5064 w
(threadsetname\("incrthread"\);) 1266 5284 w
(for\(;;\){) 1266 5394 w
(*cp = *cp + 1;) 1746 5504 w
(print\("cnt %d\\n", *cp\);) 1746 5614 w
(}) 1266 5724 w
(threadexits\(nil\);) 1266 5834 w
(}) 786 5944 w
11 /Times-Roman f
(The) 566 6160 w
(other) 764 6160 w
(runs) 1017 6160 w
(this) 1234 6160 w
(instead.) 1422 6160 w
cleartomark
showpage
saveobj restore
%%EndPage: 6 6
%%Page: 7 7
/saveobj save def
mark
7 pagesetup
11 /Times-Roman f
(\255 7 \255) 2317 413 w
10 /Courier f
(void) 786 676 w
(decr\(void* arg\)) 786 786 w
({) 786 896 w
(int*) 1266 1006 w
(cp = arg;) 1746 1006 w
(threadsetname\("decrthread"\);) 1266 1226 w
(for\(;;\){) 1266 1336 w
(if \(*cp > 0\)) 1746 1446 w
(*cp = *cp \255 1;) 2226 1556 w
(print\("cnt %d\\n", *cp\);) 1746 1666 w
(}) 1266 1776 w
(threadexits\(nil\);) 1266 1886 w
(}) 786 1996 w
11 /Times-Roman f
(This) 566 2212 w
(time,) 790 2212 w
(we) 1042 2212 w
(pass) 1197 2212 w
(an) 1414 2212 w
(an) 1545 2212 w
(argument) 1676 2212 w
(for) 2118 2212 w
(both) 2273 2212 w
(threads) 2497 2212 w
(a) 2841 2212 w
(pointer) 2917 2212 w
(to) 3256 2212 w
(the) 3370 2212 w
(shared) 3532 2212 w
(counter.) 3845 2212 w
cleartomark
showpage
saveobj restore
%%EndPage: 7 7
%%Page: 8 8
/saveobj save def
mark
8 pagesetup
11 /Times-Roman f
(\255 8 \255) 2317 413 w
9 /S f
(\347) 566 676 w
9 /Times-Bold f
(tcnt.c) 581 676 w
9 /S f
(\347) 809 676 w
(`) 566 676 w
(`````) 584 676 w
(_) 566 676 w
(_____) 584 676 w
8 /Courier f
(#include <u.h>) 786 784 w
(#include <libc.h>) 786 892 w
(#include <thread.h>) 786 1000 w
(int) 786 1108 w
(cnt;) 1266 1108 w
(void) 786 1324 w
(incr\(void* arg\)) 786 1432 w
({) 786 1540 w
(int*) 1266 1648 w
(cp = arg;) 1746 1648 w
(threadsetname\("incrthread"\);) 1266 1864 w
(for\(;;\){) 1266 1972 w
(*cp = *cp + 1;) 1746 2080 w
(print\("cnt %d\\n", *cp\);) 1746 2188 w
(yield\(\);) 1746 2296 w
(}) 1266 2404 w
(threadexits\(nil\);) 1266 2512 w
(}) 786 2620 w
(void) 786 2836 w
(decr\(void* arg\)) 786 2944 w
({) 786 3052 w
(int*) 1266 3160 w
(cp = arg;) 1746 3160 w
(threadsetname\("decrthread"\);) 1266 3376 w
(for\(;;\){) 1266 3484 w
(if \(*cp > 0\)) 1746 3592 w
(*cp = *cp \255 1;) 2226 3700 w
(print\("cnt %d\\n", *cp\);) 1746 3808 w
(yield\(\);) 1746 3916 w
(}) 1266 4024 w
(threadexits\(nil\);) 1266 4132 w
(}) 786 4240 w
(void) 786 4456 w
(threadmain\(int, char*[]\)) 786 4564 w
({) 786 4672 w
(threadsetname\("main"\);) 1266 4888 w
(threadcreate\(incr, &cnt, 8*1024\);) 1266 4996 w
(threadcreate\(decr, &cnt, 8*1024\);) 1266 5104 w
(threadexits\(nil\);) 1266 5212 w
(}) 786 5320 w
11 /Times-Roman f
(One) 566 5536 w
(of) 781 5536 w
(the) 905 5536 w
(threads) 1072 5536 w
(will) 1422 5536 w
(never) 1628 5536 w
(run!.) 1904 5536 w
(It) 2148 5536 w
(will) 2249 5536 w
(starve.) 2455 5536 w
(When) 2806 5536 w
(we) 3101 5536 w
(executed) 3262 5536 w
(the) 3684 5536 w
(program,) 3852 5536 w
(the) 566 5656 w
(thread) 752 5656 w
(incrementing) 1077 5656 w
(the) 1708 5656 w
(counter) 1894 5656 w
(was) 2273 5656 w
(the) 2494 5656 w
(lucky) 2679 5656 w
(one.) 2974 5656 w
(It) 3211 5656 w
(started) 3329 5656 w
(running,) 3672 5656 w
(and) 4093 5656 w
(because) 566 5776 w
(it) 940 5776 w
(does) 1031 5776 w
(not) 1261 5776 w
(call) 1431 5776 w
(any) 1618 5776 w
(synchronization) 1805 5776 w
(function) 2535 5776 w
(from) 2930 5776 w
(the) 3172 5776 w
(thread) 3335 5776 w
(library,) 3637 5776 w
(it) 3987 5776 w
(will) 4079 5776 w
11 /Times-Italic f
(never) 566 5896 w
11 /Times-Roman f
(leave) 836 5896 w
(the) 1094 5896 w
(processor) 1256 5896 w
(in) 1703 5896 w
(favor) 1817 5896 w
(of) 2075 5896 w
(the) 2194 5896 w
(other) 2356 5896 w
(thread.) 2609 5896 w
cleartomark
showpage
saveobj restore
%%EndPage: 8 8
%%Page: 9 9
/saveobj save def
mark
9 pagesetup
11 /Times-Roman f
(\255 9 \255) 2317 413 w
10 /Courier f
(; 8.tcnt) 786 676 w
(cnt 1) 786 786 w
(cnt 2) 786 896 w
(cnt 3) 786 1006 w
(cnt 4) 786 1116 w
(cnt 5) 786 1226 w
(cnt 6) 786 1336 w
10 /Times-Italic f
(...and so on ad nauseum.) 786 1446 w
11 /Times-Roman f
(We) 566 1662 w
(can) 754 1662 w
(double) 942 1662 w
(check) 1279 1662 w
(by) 1571 1662 w
(using) 1719 1662 w
(the) 1996 1662 w
(debugger.) 2168 1662 w
(First,) 2641 1662 w
(let's) 2910 1662 w
(locate) 3137 1662 w
(the) 3436 1662 w
(process) 3608 1662 w
(that) 3974 1662 w
(is) 4177 1662 w
(running) 566 1782 w
(our) 936 1782 w
(program.) 1110 1782 w
10 /Courier f
(; ps) 786 1952 w
(| grep 8.tcnt) 1206 1952 w
(nemo) 786 2062 w
(4546) 1686 2062 w
(0:00) 2166 2062 w
(0:00) 2586 2062 w
(120K Pwrite) 3186 2062 w
(8.tcnt) 4026 2062 w
11 /Times-Roman f
(Now) 566 2278 w
(we) 807 2278 w
(can) 962 2278 w
(run) 1141 2278 w
11 /Courier f
(acid) 1315 2278 w
11 /Times-Roman f
(on) 1607 2278 w
(the) 1745 2278 w
(process) 1907 2278 w
(4546.) 2263 2278 w
10 /Courier f
(; acid \255l thread 4546) 786 2448 w
(/proc/4546/text:386 plan 9 executable) 786 2558 w
(/sys/lib/acid/port) 786 2778 w
(/sys/lib/acid/thread) 786 2888 w
(/sys/lib/acid/386) 786 2998 w
(acid:) 786 3108 w
11 /Times-Roman f
(The) 566 3324 w
(option) 783 3324 w
11 /Courier f
(\255l) 1112 3324 w
(thread) 1329 3324 w
11 /Times-Roman f
(loads) 1772 3324 w
(functions) 2051 3324 w
(into) 2508 3324 w
(acid) 2728 3324 w
(for) 2958 3324 w
(debugging) 3133 3324 w
(threaded) 3645 3324 w
(pro\255) 4069 3324 w
(grams.) 566 3444 w
(For) 890 3444 w
(example,) 1071 3444 w
(the) 1498 3444 w
(function) 1660 3444 w
11 /Courier f
(threads) 2054 3444 w
11 /Times-Roman f
(lists) 2544 3444 w
(the) 2751 3444 w
(threads) 2913 3444 w
(in) 3257 3444 w
(the) 3371 3444 w
(process.) 3533 3444 w
9 /Courier f
(acid: !!threads\(\)) 786 3614 w
(p=\(Proc\)0x169b8) 786 3724 w
(pid 4546) 1812 3724 w
(Running) 2352 3724 w
(t=\(Thread\)0x19a68) 894 3834 w
(Running) 2028 3834 w
(tcnt.c:14 incr [incrthread]) 2622 3834 w
(t=\(Thread\)0x1bb28) 894 3944 w
(Ready) 2028 3944 w
(?file?:0 {}) 2622 3944 w
(acid:) 786 4054 w
11 /Times-Roman f
(There) 566 4270 w
(are) 849 4270 w
(two) 1010 4270 w
(threads.) 1205 4270 w
(Reasonable,) 1579 4270 w
(because) 2142 4270 w
(the) 2517 4270 w
(main) 2681 4270 w
(thread) 2931 4270 w
(called) 3234 4270 w
11 /Courier f
(threadexits) 3525 4270 w
11 /Times-Roman f
(by) 566 4390 w
(this) 710 4390 w
(time.) 904 4390 w
(Both) 1162 4390 w
(threads) 1411 4390 w
(are) 1761 4390 w
(listed) 1927 4390 w
(\(a) 2200 4390 w
(line) 2318 4390 w
(each\)) 2517 4390 w
(after) 2786 4390 w
(one) 3019 4390 w
(line) 3211 4390 w
(describing) 3410 4390 w
(the) 3901 4390 w
(pro\255) 4069 4390 w
(cess) 566 4510 w
(where) 776 4510 w
(the) 1070 4510 w
(threads) 1232 4510 w
(run.) 1576 4510 w
(This) 1778 4510 w
(process) 2002 4510 w
(has) 2358 4510 w
(pid) 2532 4510 w
11 /Courier f
(4546) 2701 4510 w
11 /Times-Roman f
(,) 2965 4510 w
(as) 3021 4510 w
(we) 3141 4510 w
(knew,) 3297 4510 w
(and) 3591 4510 w
(is) 3778 4510 w
(running.) 3881 4510 w
(The) 566 4630 w
(lucky) 766 4630 w
(running) 1040 4630 w
(thread) 1412 4630 w
(is) 1714 4630 w
(executing) 1817 4630 w
(at) 2272 4630 w
(line) 2380 4630 w
(14) 2574 4630 w
(of) 2713 4630 w
11 /Courier f
(tcnt.c) 2833 4630 w
11 /Times-Roman f
(,) 3229 4630 w
(in) 3286 4630 w
(the) 3401 4630 w
(function) 3564 4630 w
(named) 3959 4630 w
11 /Courier f
(incr) 566 4750 w
11 /Times-Roman f
(.) 830 4750 w
(The) 917 4750 w
(debugger) 1118 4750 w
(does) 1557 4750 w
(even) 1790 4750 w
(show) 2028 4750 w
(a) 2292 4750 w
(name) 2372 4750 w
(for) 2641 4750 w
(the) 2800 4750 w
(thread:) 2966 4750 w
11 /Courier f
(incrthread) 3302 4750 w
11 /Times-Roman f
(.) 3962 4750 w
(That) 4050 4750 w
(is) 566 4870 w
(what) 689 4870 w
(the) 951 4870 w
(calls) 1134 4870 w
(to) 1384 4870 w
11 /Courier f
(threadsetname) 1519 4870 w
11 /Times-Roman f
(in) 2426 4870 w
(our) 2561 4870 w
(program) 2756 4870 w
(were) 3176 4870 w
(for.) 3436 4870 w
(This) 3640 4870 w
(function) 3885 4870 w
(assigns) 566 4990 w
(a) 915 4990 w
(\(string\)) 994 4990 w
(name) 1348 4990 w
(to) 1616 4990 w
(the) 1733 4990 w
(calling) 1898 4990 w
(thread,) 2229 4990 w
(for) 2562 4990 w
(debugging.) 2721 4990 w
(This) 3245 4990 w
(string) 3473 4990 w
(can) 3756 4990 w
(be) 3939 4990 w
(also) 4074 4990 w
(obtained) 566 5110 w
(using) 974 5110 w
11 /Courier f
(threadgetname) 1243 5110 w
11 /Times-Roman f
(,) 2101 5110 w
(for) 2159 5110 w
(example,) 2316 5110 w
(to) 2745 5110 w
(print) 2861 5110 w
(diagnostics) 3099 5110 w
(with) 3624 5110 w
(the) 3850 5110 w
(name) 4014 5110 w
(of) 566 5230 w
(the) 685 5230 w
(thread) 847 5230 w
(issuing) 1148 5230 w
(them.) 1489 5230 w
(The) 816 5386 w
(second) 1019 5386 w
(thread) 1356 5386 w
(is) 1662 5386 w
(ready) 1769 5386 w
(to) 2044 5386 w
(run,) 2164 5386 w
(but) 2372 5386 w
(it) 2547 5386 w
(did) 2643 5386 w
(not) 2818 5386 w
(even) 2993 5386 w
(touch) 3233 5386 w
(the) 3511 5386 w
(processor.) 3679 5386 w
(In) 4160 5386 w
(fact,) 566 5506 w
(it) 793 5506 w
(did) 891 5506 w
(not) 1068 5506 w
(have) 1245 5506 w
(time) 1487 5506 w
(to) 1719 5506 w
(initialize) 1841 5506 w
(some) 2262 5506 w
(of) 2530 5506 w
(its) 2656 5506 w
(data,) 2796 5506 w
(and) 3041 5506 w
(the) 3234 5506 w
(debugger) 3403 5506 w
(gets) 3845 5506 w
(con\255) 4057 5506 w
(fused) 566 5626 w
(regarding) 834 5626 w
(which) 1284 5626 w
(file,) 1583 5626 w
(line) 1789 5626 w
(number,) 1986 5626 w
(and) 2381 5626 w
(thread) 2571 5626 w
(name) 2876 5626 w
(correspond) 3145 5626 w
(to) 3663 5626 w
(the) 3781 5626 w
(second) 3947 5626 w
(thread.) 566 5746 w
(We) 816 5902 w
(are) 1006 5902 w
(going) 1177 5902 w
(to) 1467 5902 w
(modify) 1592 5902 w
(the) 1949 5902 w
(program) 2122 5902 w
(a) 2532 5902 w
(little) 2619 5902 w
(bit,) 2861 5902 w
(by) 3045 5902 w
(calling) 3194 5902 w
11 /Courier f
(yield) 3532 5902 w
11 /Times-Roman f
(on) 3902 5902 w
(each) 4052 5902 w
(thread) 566 6022 w
(to) 873 6022 w
(let) 993 6022 w
(the) 1137 6022 w
(other) 1305 6022 w
(run.) 1564 6022 w
(For) 1772 6022 w
(example,) 1959 6022 w
(this) 2392 6022 w
(is) 2585 6022 w
(the) 2692 6022 w
(new) 2859 6022 w
11 /Courier f
(incrthread) 3074 6022 w
11 /Times-Roman f
(.) 3734 6022 w
(The) 3823 6022 w
(other) 4026 6022 w
(one) 566 6142 w
(is) 752 6142 w
(changed) 854 6142 w
(in) 1246 6142 w
(a) 1360 6142 w
(similar) 1436 6142 w
(way.) 1770 6142 w
cleartomark
showpage
saveobj restore
%%EndPage: 9 9
%%Page: 10 10
/saveobj save def
mark
10 pagesetup
11 /Times-Roman f
(\255 10 \255) 2289 413 w
10 /Courier f
(void) 786 676 w
(incr\(void* arg\)) 786 786 w
({) 786 896 w
(int*) 1266 1006 w
(cp = arg;) 1746 1006 w
(threadsetname\("incrthread"\);) 1266 1226 w
(for\(;;\){) 1266 1336 w
(*cp = *cp + 1;) 1746 1446 w
(print\("cnt %d\\n", *cp\);) 1746 1556 w
(yield\(\);) 1746 1666 w
(}) 1266 1776 w
(threadexits\(nil\);) 1266 1886 w
(}) 786 1996 w
11 /Times-Roman f
(This) 566 2212 w
(is) 794 2212 w
(what) 900 2212 w
(results) 1145 2212 w
(from) 1465 2212 w
(the) 1711 2212 w
(change.) 1878 2212 w
(Each) 2248 2212 w
(thread) 2499 2212 w
(yields) 2805 2212 w
(to) 3101 2212 w
(the) 3220 2212 w
(other) 3387 2212 w
(one,) 3645 2212 w
(and) 3864 2212 w
(both) 4055 2212 w
(onces) 566 2332 w
(execute) 851 2332 w
(making) 1220 2332 w
(turns.) 1586 2332 w
(There) 1870 2332 w
(will) 2160 2332 w
(always) 2368 2332 w
(be) 2708 2332 w
(one) 2846 2332 w
(pass) 3039 2332 w
(in) 3263 2332 w
(the) 3384 2332 w
11 /Courier f
(for) 3553 2332 w
11 /Times-Roman f
(and) 3786 2332 w
(then) 3979 2332 w
(a) 4203 2332 w
(context) 566 2452 w
(switch,) 917 2452 w
(forced) 1260 2452 w
(by) 1566 2452 w
11 /Courier f
(yield) 1704 2452 w
11 /Times-Roman f
(.) 2034 2452 w
10 /Courier f
(; 8.tcnt) 786 2622 w
(cnt 1) 786 2732 w
(cnt 0) 786 2842 w
(cnt 1) 786 2952 w
10 /Times-Italic f
(...) 786 3062 w
11 /Times-Roman f
(Another) 566 3278 w
(debugger) 961 3278 w
(function) 1404 3278 w
(defined) 1806 3278 w
(when) 2170 3278 w
(called) 2444 3278 w
(with) 2742 3278 w
11 /Courier f
(\255l) 2975 3278 w
(thread) 3182 3278 w
11 /Times-Roman f
(knows) 3615 3278 w
(how) 3939 3278 w
(to) 4165 3278 w
(print) 566 3398 w
(the) 803 3398 w
(stacks) 966 3398 w
(for) 1263 3398 w
(all) 1419 3398 w
(threads) 1558 3398 w
(in) 1903 3398 w
(the) 2018 3398 w
(process.) 2181 3398 w
(Now) 2566 3398 w
(that) 2808 3398 w
(both) 3002 3398 w
(threads) 3227 3398 w
(had) 3572 3398 w
(a) 3759 3398 w
(chance) 3835 3398 w
(to) 4165 3398 w
(run,) 566 3518 w
(you) 774 3518 w
(can) 973 3518 w
(see) 1158 3518 w
(how) 1331 3518 w
(the) 1554 3518 w
(debugger) 1722 3518 w
(clearly) 2163 3518 w
(identifies) 2494 3518 w
(one) 2937 3518 w
(thread) 3129 3518 w
(as) 3437 3518 w
11 /Courier f
(incrthread) 3563 3518 w
11 /Times-Roman f
(,) 4223 3518 w
(and) 566 3638 w
(the) 752 3638 w
(other) 914 3638 w
(one) 1167 3638 w
(as) 1353 3638 w
11 /Courier f
(decrthread) 1472 3638 w
11 /Times-Roman f
(.) 2132 3638 w
8 /Courier f
(; ps | grep 8.tcnt) 786 3808 w
(nemo) 786 3918 w
(4571) 1506 3918 w
(0:00) 1890 3918 w
(0:00) 2226 3918 w
(120K Pwrite) 2706 3918 w
(8.tcnt) 3378 3918 w
(; acid \255l thread 4571) 786 4028 w
(/proc/4571/text:386 plan 9 executable) 786 4138 w
(/sys/lib/acid/port) 786 4358 w
(/sys/lib/acid/thread) 786 4468 w
(/sys/lib/acid/386) 786 4578 w
(acid: !!stacks\(\)) 786 4688 w
(p=\(Proc\)0x169b8) 786 4798 w
(pid 4571) 1698 4798 w
(Running) 2178 4798 w
(t=\(Thread\)0x19a68) 834 4908 w
(Ready) 1842 4908 w
(/usr/nemo/tcnt.c:15 incr [incrthread]) 2370 4908 w
(yield\(\)+0x5 /sys/src/libthread/sched.c:186) 978 5018 w
(incr\(arg=0xd010\)+0x39 /usr/nemo/tcnt.c:15) 978 5128 w
(launcher386\(arg=0xd010,f=0x1020\)+0x10 /sys/src/libthread/386.c:10) 978 5238 w
(0xfefefefe ?file?:0) 978 5348 w
(t=\(Thread\)0x1bb28) 834 5568 w
(Running) 1842 5568 w
(/usr/nemo/tcnt.c:30 decr [decrthread]) 2370 5568 w
(pwrite\(\)+0x7 /sys/src/libc/9syscall/pwrite.s:5) 978 5678 w
8 /Times-Italic f
(...) 978 5788 w
8 /Courier f
(print\(fmt=0x1136a\)+0x24 /sys/src/libc/fmt/print.c:13) 978 5898 w
(decr\(arg=0xd010\)+0x3b /usr/nemo/tcnt.c:30) 978 6008 w
(launcher386\(arg=0xd010,f=0x105f\)+0x10 /sys/src/libthread/386.c:10) 978 6118 w
(0xfefefefe ?file?:0) 978 6228 w
cleartomark
showpage
saveobj restore
%%EndPage: 10 10
%%Page: 11 11
/saveobj save def
mark
11 pagesetup
11 /Times-Roman f
(\255 11 \255) 2289 413 w
(This) 566 686 w
(is) 808 686 w
(a) 928 686 w
(very) 1022 686 w
(useful) 1262 686 w
(tool) 1576 686 w
(to) 1794 686 w
(debug) 1927 686 w
(programs) 2242 686 w
(using) 2703 686 w
(the) 2989 686 w
(thread) 3170 686 w
(library.) 3490 686 w
(It) 3857 686 w
(makes) 3971 686 w
(debugging) 566 806 w
(as) 1118 806 w
(easy) 1297 806 w
(as) 1579 806 w
(when) 1758 806 w
(using) 2083 806 w
(processes.) 2410 806 w
(The) 2944 806 w
(debugger) 3201 806 w
(reports) 3695 806 w
(that) 4086 806 w
11 /Courier f
(incrthread) 566 926 w
11 /Times-Roman f
(was) 1256 926 w
(executing) 1456 926 w
11 /Courier f
(yield) 1913 926 w
11 /Times-Roman f
(,) 2243 926 w
(and) 2302 926 w
11 /Courier f
(decrthread) 2491 926 w
11 /Times-Roman f
(was) 3182 926 w
(executing) 3383 926 w
(its) 3840 926 w
(call) 3976 926 w
(to) 4165 926 w
11 /Courier f
(print) 566 1046 w
11 /Times-Roman f
(,) 896 1046 w
(by) 956 1046 w
(the) 1098 1046 w
(time) 1264 1046 w
(the) 1492 1046 w
(stack) 1657 1046 w
(dump) 1913 1046 w
(was) 2195 1046 w
(made.) 2396 1046 w
(Note) 2692 1046 w
(how) 2936 1046 w
(the) 3156 1046 w
(process) 3321 1046 w
(was) 3680 1046 w
(running,) 3881 1046 w
(but) 566 1166 w
(only) 738 1166 w
(one) 965 1166 w
(of) 1154 1166 w
(the) 1276 1166 w
(threads) 1441 1166 w
(is) 1788 1166 w
(running.) 1893 1166 w
(The) 2294 1166 w
(other) 2495 1166 w
(one) 2751 1166 w
(is) 2940 1166 w
(ready) 3045 1166 w
(to) 3318 1166 w
(run,) 3435 1166 w
(because) 3640 1166 w
(it) 4016 1166 w
(did) 4110 1166 w
(yield.) 566 1286 w
16 /Times-Bold f
(11.3.) 566 1646 w
(Channels) 966 1646 w
11 /Times-Roman f
(Synchronizing) 566 1802 w
(several) 1250 1802 w
(processes) 1603 1802 w
(was) 2066 1802 w
(very) 2280 1802 w
(easy) 2518 1802 w
(when) 2756 1802 w
(we) 3037 1802 w
(used) 3208 1802 w
(pipes.) 3453 1802 w
(While) 3757 1802 w
(pro\255) 4069 1802 w
(gramming,) 566 1922 w
(we) 1080 1922 w
(could) 1241 1922 w
(forget) 1519 1922 w
(all) 1814 1922 w
(about) 1958 1922 w
(race) 2235 1922 w
(conditions.) 2448 1922 w
(Each) 2968 1922 w
(process) 3219 1922 w
(was) 3580 1922 w
(making) 3783 1922 w
(its) 4146 1922 w
(job,) 566 2042 w
(using) 773 2042 w
(its) 1050 2042 w
(own) 1193 2042 w
(data,) 1420 2042 w
(and) 1668 2042 w
(both) 1865 2042 w
(processes) 2100 2042 w
(could) 2558 2042 w
(still) 2841 2042 w
(work) 3047 2042 w
(together) 3311 2042 w
(to) 3709 2042 w
(do) 3834 2042 w
(some\255) 3983 2042 w
(thing) 566 2162 w
(useful.) 821 2162 w
(Fortunately,) 816 2318 w
(there) 1383 2318 w
(is) 1633 2318 w
(an) 1739 2318 w
(abstraction) 1874 2318 w
(provided) 2388 2318 w
(by) 2811 2318 w
(the) 2954 2318 w
(thread) 3121 2318 w
(library) 3427 2318 w
(that) 3752 2318 w
(is) 3950 2318 w
(very) 4057 2318 w
(similar.) 566 2438 w
(It) 934 2438 w
(is) 1035 2438 w
(called) 1143 2438 w
(a) 1438 2438 w
11 /Times-Bold f
(channel) 1520 2438 w
11 /Times-Roman f
(.) 1888 2438 w
(A) 1978 2438 w
(channel) 2091 2438 w
(is) 2465 2438 w
(an) 2573 2438 w
(unidirectional) 2709 2438 w
(communication) 3352 2438 w
(arti\255) 4069 2438 w
(fact.) 566 2558 w
(One) 792 2558 w
(thread) 1009 2558 w
(can) 1317 2558 w
(send) 1503 2558 w
(data) 1739 2558 w
(through) 1956 2558 w
(one) 2333 2558 w
(end) 2526 2558 w
(of) 2719 2558 w
(the) 2846 2558 w
(channel,) 3016 2558 w
(and) 3420 2558 w
(another) 3614 2558 w
(thread) 3978 2558 w
(may) 566 2678 w
(receive) 797 2678 w
(data) 1153 2678 w
(at) 1377 2678 w
(the) 1498 2678 w
(other) 1674 2678 w
(end.) 1941 2678 w
(Because) 2168 2678 w
(channels) 2573 2678 w
(are) 2997 2678 w
(meant) 3170 2678 w
(to) 3479 2678 w
(send) 3606 2678 w
(data) 3848 2678 w
(of) 4071 2678 w
(a) 4203 2678 w
(particular) 566 2798 w
(type,) 1013 2798 w
(a) 1258 2798 w
(channel) 1334 2798 w
(delivers) 1702 2798 w
(messages) 2077 2798 w
(of) 2519 2798 w
(a) 2638 2798 w
(given) 2714 2798 w
(size,) 2986 2798 w
(decided) 3212 2798 w
(when) 3580 2798 w
(the) 3846 2798 w
(chan\255) 4009 2798 w
(nel) 566 2918 w
(is) 750 2918 w
(created.) 874 2918 w
(This) 1294 2918 w
(is) 1540 2918 w
(not) 1664 2918 w
(a) 1855 2918 w
(restriction.) 1953 2918 w
(If) 2476 2918 w
(data) 2598 2918 w
(of) 2830 2918 w
(different) 2971 2918 w
(sizes) 3396 2918 w
(must) 3658 2918 w
(be) 3922 2918 w
(sent) 4074 2918 w
(through) 566 3038 w
(a) 936 3038 w
(channel,) 1012 3038 w
(you) 1408 3038 w
(can) 1601 3038 w
(always) 1780 3038 w
(send) 2112 3038 w
(a) 2341 3038 w
(pointer) 2417 3038 w
(to) 2756 3038 w
(it.) 2870 3038 w
(To) 816 3194 w
(create) 966 3194 w
(a) 1253 3194 w
(channel,) 1329 3194 w
(call) 1725 3194 w
11 /Courier f
(chancreate) 1911 3194 w
10 /Courier f
(; sig chancreate) 786 3364 w
(Channel* chancreate\(int elsize, int nel\)) 1266 3474 w
11 /Times-Roman f
(and) 566 3690 w
(specify) 757 3690 w
(with) 1106 3690 w
(the) 1335 3690 w
(first) 1502 3690 w
(argument) 1712 3690 w
(the) 2159 3690 w
(size) 2326 3690 w
(for) 2529 3690 w
(the) 2689 3690 w
(data) 2857 3690 w
(type) 3073 3690 w
(being) 3296 3690 w
(sent) 3574 3690 w
(through) 3785 3690 w
(it.) 4161 3690 w
(The) 566 3810 w
(second) 781 3810 w
(parameter) 1130 3810 w
(specifies) 1611 3810 w
(how) 2038 3810 w
(many) 2271 3810 w
(messages) 2559 3810 w
(may) 3017 3810 w
(be) 3250 3810 w
(buffered) 3397 3810 w
(inside) 3810 3810 w
(the) 4117 3810 w
(channel) 566 3930 w
(\(i.e.,) 947 3930 w
(the) 1187 3930 w
(buffer) 1362 3930 w
(size) 1669 3930 w
(for) 1880 3930 w
(the) 2048 3930 w
(channel\).) 2224 3930 w
(To) 2670 3930 w
(send) 2834 3930 w
(and) 3077 3930 w
(receive) 3277 3930 w
(messages,) 3633 3930 w
(the) 4117 3930 w
(functions) 566 4050 w
11 /Courier f
(send) 1003 4050 w
11 /Times-Roman f
(and) 1295 4050 w
11 /Courier f
(recv) 1481 4050 w
11 /Times-Roman f
(provide) 1773 4050 w
(the) 2136 4050 w
(primary) 2298 4050 w
(interface.) 2673 4050 w
10 /Courier f
(; sig send recv) 786 4220 w
(int send\(Channel *c, void *v\)) 1266 4330 w
(int recv\(Channel *c, void *v\)) 1266 4440 w
11 /Times-Roman f
(Before) 566 4656 w
(any) 910 4656 w
(further) 1115 4656 w
(discussion,) 1459 4656 w
(let's) 1993 4656 w
(see) 2229 4656 w
(an) 2415 4656 w
(example.) 2565 4656 w
(In) 3011 4656 w
(the) 3149 4656 w
(previous) 3330 4656 w
(chapter) 3755 4656 w
(we) 4124 4656 w
(implemented) 566 4776 w
(a) 1169 4776 w
(program) 1246 4776 w
(for) 1646 4776 w
(the) 1802 4776 w
(bounded\255buffer) 1965 4776 w
(problem.) 2674 4776 w
(This) 3097 4776 w
(is) 3322 4776 w
(another) 3425 4776 w
(solution) 3781 4776 w
(to) 4165 4776 w
(the) 566 4896 w
(same) 728 4896 w
(problem,) 981 4896 w
(using) 1403 4896 w
(threads) 1670 4896 w
(and) 2014 4896 w
(channels.) 2200 4896 w
cleartomark
showpage
saveobj restore
%%EndPage: 11 11
%%Page: 12 12
/saveobj save def
mark
12 pagesetup
11 /Times-Roman f
(\255 12 \255) 2289 413 w
9 /S f
(\347) 566 676 w
9 /Times-Bold f
(tpc.c) 581 676 w
9 /S f
(\347) 779 676 w
(`) 566 676 w
(````) 599 676 w
(_) 566 676 w
(____) 599 676 w
8 /Courier f
(#include <u.h>) 786 784 w
(#include <libc.h>) 786 892 w
(#include <thread.h>) 786 1000 w
(enum {Nmsgs = 4 };) 786 1108 w
(Channel* bufc;) 786 1216 w
(void) 786 1432 w
(producer\(void *arg\)) 786 1540 w
({) 786 1648 w
(char*) 1266 1756 w
(id = arg;) 1746 1756 w
(char*) 1266 1864 w
(msg;) 1746 1864 w
(int) 1266 1972 w
(i;) 1746 1972 w
(for \(i = 0; i < 5 ; i++\){) 1266 2188 w
(msg = smprint\("%s%d", id, i\);) 1746 2296 w
(send\(bufc, &msg\);) 1746 2404 w
(}) 1266 2512 w
(send\(bufc, nil\);) 1266 2620 w
(threadexits\(nil\);) 1266 2728 w
(}) 786 2836 w
(void) 786 3052 w
(consumer\(void*\)) 786 3160 w
({) 786 3268 w
(char*) 1266 3376 w
(msg;) 1746 3376 w
(do {) 1266 3484 w
(recv\(bufc, &msg\);) 1746 3592 w
(if \(msg != nil\){) 1746 3700 w
(// consume it) 2706 3700 w
(print\("%s ", msg\);) 2226 3808 w
(free\(msg\);) 2226 3916 w
(}) 1746 4024 w
(} while\(msg != nil\);) 1266 4132 w
(threadexits\(nil\);) 1266 4240 w
(}) 786 4348 w
(void) 786 4564 w
(threadmain\(int, char*[]\)) 786 4672 w
({) 786 4780 w
(bufc = chancreate\(sizeof\(char*\), Nmsgs\);) 1266 4888 w
(threadcreate\(producer, "a", 8*1024\);) 1266 4996 w
(threadcreate\(producer, "b", 8*1024\);) 1266 5104 w
(threadcreate\(consumer, nil, 8*1024\);) 1266 5212 w
(consumer\(nil\);) 1266 5320 w
(}) 786 5428 w
11 /Times-Roman f
(The) 566 5644 w
(channel) 788 5644 w
(is) 1180 5644 w
(created) 1306 5644 w
(to) 1672 5644 w
(send) 1810 5644 w
(messages) 2063 5644 w
(with) 2529 5644 w
(the) 2778 5644 w
(size) 2965 5644 w
(of) 3188 5644 w
(a) 3332 5644 w
11 /Courier f
(char*) 3433 5644 w
11 /Times-Roman f
(,) 3763 5644 w
(and) 3844 5644 w
(with) 4055 5644 w
(enough) 566 5764 w
(buffering) 917 5764 w
(for) 1352 5764 w
11 /Courier f
(Nmsgs) 1507 5764 w
11 /Times-Roman f
(messages.) 1865 5764 w
(Thus,) 2335 5764 w
(the) 2611 5764 w
(channel) 2773 5764 w
(is) 3141 5764 w
(our) 3243 5764 w
(bounded) 3417 5764 w
(buffer.) 3823 5764 w
10 /Courier f
(bufc = chancreate\(sizeof\(char*\), Nmsgs\);) 786 5934 w
11 /Times-Roman f
(The) 566 6150 w
(program) 775 6150 w
(will) 1185 6150 w
(never) 1396 6150 w
(destroy) 1677 6150 w
(the) 2039 6150 w
(channel,) 2212 6150 w
(ever.) 2619 6150 w
(Should) 2901 6150 w
(we) 3253 6150 w
(want) 3419 6150 w
(to) 3672 6150 w
(destroy) 3798 6150 w
(it,) 4161 6150 w
(we) 566 6270 w
(might) 721 6270 w
(call) 1007 6270 w
cleartomark
showpage
saveobj restore
%%EndPage: 12 12
%%Page: 13 13
/saveobj save def
mark
13 pagesetup
11 /Times-Roman f
(\255 13 \255) 2289 413 w
10 /Courier f
(chanfree\(bufc\);) 786 676 w
11 /Times-Roman f
(But) 566 892 w
(that) 757 892 w
(can) 953 892 w
(only) 1135 892 w
(be) 1362 892 w
(done) 1496 892 w
(when) 1740 892 w
(the) 2008 892 w
(channel) 2174 892 w
(is) 2546 892 w
(no) 2652 892 w
(longer) 2794 892 w
(needed,) 3106 892 w
(after) 3475 892 w
(the) 3706 892 w
(last) 3872 892 w
(con\255) 4057 892 w
(sumer) 566 1012 w
(completes) 862 1012 w
(its) 1335 1012 w
(job.) 1468 1012 w
(The) 1693 1012 w
(consumer) 1891 1012 w
(calls) 2345 1012 w
10 /Courier f
(recv\(bufc, &msg\);) 786 1182 w
11 /Times-Roman f
(to) 566 1362 w
(receive) 684 1362 w
(a) 1030 1362 w
(message) 1110 1362 w
(from) 1513 1362 w
(the) 1758 1362 w
(channel.) 1924 1362 w
(Once) 2324 1362 w
(a) 2586 1362 w
(message) 2666 1362 w
(is) 3069 1362 w
(received,) 3176 1362 w
(the) 3606 1362 w
(message) 3773 1362 w
(is) 4177 1362 w
(stored) 566 1482 w
(by) 890 1482 w
11 /Courier f
(recv) 1056 1482 w
11 /Times-Roman f
(at) 1376 1482 w
(the) 1511 1482 w
(address) 1701 1482 w
(given) 2084 1482 w
(as) 2383 1482 w
(the) 2529 1482 w
(second) 2718 1482 w
(argument.) 3077 1482 w
(That) 3574 1482 w
(is,) 3830 1482 w
11 /Courier f
(recv) 3987 1482 w
11 /Times-Roman f
(receives) 566 1602 w
(a) 962 1602 w
11 /Courier f
(char*) 1049 1602 w
11 /Times-Roman f
(and) 1418 1602 w
(stores) 1615 1602 w
(it) 1910 1602 w
(at) 2011 1602 w
11 /Courier f
(&msg) 2129 1602 w
11 /Times-Roman f
(.) 2393 1602 w
(After) 2488 1602 w
(having) 2757 1602 w
(received) 3095 1602 w
(the) 3504 1602 w
(message,) 3678 1602 w
(the) 4117 1602 w
(consumer) 566 1722 w
(prints) 1020 1722 w
(it) 1299 1722 w
(and) 1389 1722 w
(tries) 1575 1722 w
(to) 1792 1722 w
(receive) 1906 1722 w
(another) 2248 1722 w
(one.) 2604 1722 w
(The) 816 1878 w
(producer,) 1014 1878 w
(on) 1458 1878 w
(the) 1596 1878 w
(other) 1758 1878 w
(hand,) 2011 1878 w
(concocts) 2280 1878 w
(a) 2691 1878 w
(message) 2767 1878 w
(and) 3166 1878 w
(calls) 3352 1878 w
10 /Courier f
(send\(bufc, &msg\);) 786 2048 w
11 /Times-Roman f
(This) 566 2264 w
(call) 794 2264 w
(sends) 984 2264 w
(through) 1260 2264 w
(the) 1634 2264 w
(channel) 1800 2264 w
(the) 2172 2264 w
(message) 2338 2264 w
(pointed) 2741 2264 w
(to) 3103 2264 w
(by) 3221 2264 w
11 /Courier f
(&msg) 3363 2264 w
11 /Times-Roman f
(,) 3627 2264 w
(with) 3687 2264 w
(the) 3915 2264 w
(size) 4081 2264 w
(of) 566 2384 w
(a) 685 2384 w
11 /Courier f
(char*) 761 2384 w
11 /Times-Roman f
(.) 1091 2384 w
(That) 1175 2384 w
(is,) 1404 2384 w
11 /Courier f
(send) 1534 2384 w
11 /Times-Roman f
(sends) 1826 2384 w
(the) 2098 2384 w
(\(pointer\)) 2260 2384 w
(value) 2671 2384 w
(in) 2936 2384 w
11 /Courier f
(msg) 3050 2384 w
11 /Times-Roman f
(through) 3276 2384 w
(the) 3646 2384 w
(channel.) 3808 2384 w
(If) 816 2540 w
(producers) 931 2540 w
(start) 1405 2540 w
(first) 1637 2540 w
(and) 1858 2540 w
(put) 2060 2540 w
(messages) 2245 2540 w
(in) 2703 2540 w
(the) 2833 2540 w
(channel,) 3011 2540 w
(they) 3423 2540 w
(will) 3656 2540 w
(block) 3872 2540 w
(as) 4160 2540 w
(soon) 566 2660 w
(as) 817 2660 w
(the) 951 2660 w
(buffering) 1128 2660 w
(in) 1578 2660 w
(the) 1707 2660 w
(channel) 1884 2660 w
(fills) 2267 2660 w
(up) 2481 2660 w
(\(similar) 2633 2660 w
(to) 3017 2660 w
(what) 3145 2660 w
(would) 3400 2660 w
(happen) 3717 2660 w
(in) 4075 2660 w
(a) 4203 2660 w
(pipe\).) 566 2780 w
(If) 885 2780 w
(the) 996 2780 w
(consumers) 1169 2780 w
(start) 1677 2780 w
(first) 1905 2780 w
(and) 2121 2780 w
(try) 2318 2780 w
(to) 2479 2780 w
(get) 2604 2780 w
(messages) 2777 2780 w
(from) 3230 2780 w
(the) 3482 2780 w
(channel,) 3655 2780 w
(they) 4062 2780 w
(will) 566 2900 w
(block) 783 2900 w
(if) 1072 2900 w
(the) 1184 2900 w
(buffer) 1363 2900 w
(in) 1674 2900 w
(the) 1805 2900 w
(channel) 1983 2900 w
(has) 2367 2900 w
(no) 2557 2900 w
(messages.) 2711 2900 w
(This) 3197 2900 w
(is) 3437 2900 w
(the) 3555 2900 w
(behavior) 3733 2900 w
(of) 4160 2900 w
11 /Courier f
(send) 566 3020 w
11 /Times-Roman f
(and) 858 3020 w
11 /Courier f
(recv) 1044 3020 w
11 /Times-Roman f
(when) 1336 3020 w
(the) 1601 3020 w
(channel) 1763 3020 w
(has) 2131 3020 w
(some) 2305 3020 w
(buffering.) 2565 3020 w
(It) 816 3176 w
(may) 911 3176 w
(be) 1128 3176 w
(illustrative) 1260 3176 w
(for) 1760 3176 w
(you) 1916 3176 w
(to) 2110 3176 w
(compare) 2225 3176 w
(this) 2630 3176 w
(program) 2819 3176 w
(with) 3219 3176 w
11 /Courier f
(pc.c) 3444 3176 w
11 /Times-Roman f
(,) 3708 3176 w
(the) 3765 3176 w
(version) 3928 3176 w
(without) 566 3296 w
(using) 933 3296 w
(channels) 1202 3296 w
(that) 1614 3296 w
(we) 1808 3296 w
(made) 1964 3296 w
(in) 2230 3296 w
(the) 2345 3296 w
(last) 2508 3296 w
(chapter.) 2690 3296 w
(Both) 3068 3296 w
(programs) 3312 3296 w
(achieve) 3755 3296 w
(the) 4117 3296 w
(same) 566 3416 w
(effect.) 819 3416 w
(This) 1122 3416 w
(one) 1346 3416 w
(does) 1532 3416 w
11 /Times-Italic f
(not) 1761 3416 w
11 /Times-Roman f
(use) 1931 3416 w
(even) 2106 3416 w
(a) 2341 3416 w
(single) 2418 3416 w
(lock,) 2710 3416 w
(nor) 2956 3416 w
(sleep/wakeup.) 3131 3416 w
(It) 3784 3416 w
(does) 3880 3416 w
(not) 4110 3416 w
(have) 566 3536 w
(any) 801 3536 w
(race) 988 3536 w
(either.) 1197 3536 w
(Each) 1503 3536 w
(thread) 1750 3536 w
(uses) 2052 3536 w
(its) 2270 3536 w
(own) 2404 3536 w
(data,) 2622 3536 w
(like) 2861 3536 w
(when) 3055 3536 w
(you) 3321 3536 w
(connect) 3515 3536 w
(multiple) 3883 3536 w
(processes) 566 3656 w
(using) 1013 3656 w
(pipes.) 1280 3656 w
(Race) 1596 3656 w
(conditions) 1842 3656 w
(are) 2329 3656 w
(dealt) 2489 3656 w
(with) 2730 3656 w
(by) 2954 3656 w
(avoiding) 3092 3656 w
(them) 3506 3656 w
(in) 3755 3656 w
(a) 3870 3656 w
(natural) 3947 3656 w
(way.) 566 3776 w
(The) 816 3932 w
(next) 1020 3932 w
(program) 1243 3932 w
(does) 1648 3932 w
(a) 1883 3932 w
(ping\255pong) 1965 3932 w
(between) 2451 3932 w
(two) 2849 3932 w
(threads.) 3048 3932 w
(Each) 3426 3932 w
(one) 3678 3932 w
(sends) 3870 3932 w
(an) 4148 3932 w
(integer) 566 4052 w
(value) 907 4052 w
(to) 1181 4052 w
(the) 1304 4052 w
(other,) 1475 4052 w
(which) 1765 4052 w
(increments) 2070 4052 w
(the) 2588 4052 w
(number) 2759 4052 w
(before) 3131 4052 w
(sending) 3446 4052 w
(it) 3825 4052 w
(back) 3923 4052 w
(to) 4165 4052 w
(the) 566 4172 w
(former) 729 4172 w
(\(see) 1056 4172 w
(figure) 1261 4172 w
([[!ping) 1552 4172 w
(pong) 1886 4172 w
(threads!]]\).) 2136 4172 w
(The) 2682 4172 w
(program) 2882 4172 w
(uses) 3283 4172 w
(channels) 3502 4172 w
(with) 3915 4172 w
(no) 4141 4172 w
(buffering.) 566 4292 w
cleartomark
showpage
saveobj restore
%%EndPage: 13 13
%%Page: 14 14
/saveobj save def
mark
14 pagesetup
11 /Times-Roman f
(\255 14 \255) 2289 413 w
9 /S f
(\347) 566 676 w
9 /Times-Bold f
(pong.c) 581 676 w
9 /S f
(\347) 849 676 w
(`) 566 676 w
(``````) 579 676 w
(_) 566 676 w
(______) 579 676 w
8 /Courier f
(#include <u.h>) 786 784 w
(#include <libc.h>) 786 892 w
(#include <thread.h>) 786 1000 w
(Channel* pingc;) 786 1216 w
(Channel* pongc;) 786 1324 w
(void) 786 1540 w
(pingthread\(void*\)) 786 1648 w
({) 786 1756 w
(int) 1266 1864 w
(msg;) 1746 1864 w
(for\(;;\){) 1266 2080 w
(recv\(pingc, &msg\);) 1746 2188 w
(msg++;) 1746 2296 w
(print\("%d\\n", msg\);) 1746 2404 w
(send\(pongc, &msg\);) 1746 2512 w
(}) 1266 2620 w
(}) 786 2728 w
(void) 786 2944 w
(pongthread\(void*\)) 786 3052 w
({) 786 3160 w
(int) 1266 3268 w
(msg;) 1746 3268 w
(for\(;;\){) 1266 3484 w
(recv\(pongc, &msg\);) 1746 3592 w
(msg++;) 1746 3700 w
(print\("\\t%d\\n", msg\);) 1746 3808 w
(send\(pingc, &msg\);) 1746 3916 w
(}) 1266 4024 w
(}) 786 4132 w
(void) 786 4348 w
(threadmain\(int, char*[]\)) 786 4456 w
({) 786 4564 w
(int) 1266 4672 w
(kickoff;) 1746 4672 w
(pingc = chancreate\(sizeof\(int\), 0\);) 1266 4888 w
(pongc = chancreate\(sizeof\(int\), 0\);) 1266 4996 w
(threadcreate\(pingthread, nil, 8*1024\);) 1266 5104 w
(threadcreate\(pongthread, nil, 8*1024\);) 1266 5212 w
(kickoff = 0;) 1266 5320 w
(send\(pingc, &kickoff\);) 1266 5428 w
(threadexits\(nil\);) 1266 5536 w
(}) 786 5644 w
11 /Times-Roman f
(Each) 566 5860 w
(channel) 827 5860 w
(is) 1210 5860 w
(created) 1327 5860 w
(to) 1684 5860 w
(send) 1813 5860 w
(messages) 2057 5860 w
(with) 2515 5860 w
(the) 2755 5860 w
(size) 2933 5860 w
(of) 3147 5860 w
(an) 3282 5860 w
11 /Courier f
(int) 3429 5860 w
11 /Times-Roman f
(,) 3627 5860 w
(and) 3699 5860 w
(with) 3901 5860 w
(no) 4141 5860 w
(buffering.) 566 5980 w
cleartomark
showpage
saveobj restore
%%EndPage: 14 14
%%Page: 15 15
/saveobj save def
mark
15 pagesetup
11 /Times-Roman f
(\255 15 \255) 2289 413 w
10 /Courier f
(pingc = chancreate\(sizeof\(int\), 0\);) 786 676 w
(pongc = chancreate\(sizeof\(int\), 0\);) 786 786 w
11 /Times-Roman f
(The) 566 1002 w
11 /Courier f
(ping) 764 1002 w
11 /Times-Roman f
(thread) 1056 1002 w
(calls) 1357 1002 w
10 /Courier f
(recv\(pingc, &msg\);) 786 1172 w
11 /Times-Roman f
(to) 566 1352 w
(receive) 684 1352 w
(a) 1030 1352 w
(message) 1110 1352 w
(from) 1513 1352 w
(the) 1758 1352 w
(channel) 1925 1352 w
11 /Courier f
(pingc) 2298 1352 w
11 /Times-Roman f
(.) 2628 1352 w
(The) 2717 1352 w
(message) 2920 1352 w
(is) 3324 1352 w
(stored) 3431 1352 w
(by) 3732 1352 w
11 /Courier f
(recv) 3875 1352 w
11 /Times-Roman f
(at) 4172 1352 w
(the) 566 1472 w
(address) 740 1472 w
(given) 1108 1472 w
(as) 1392 1472 w
(the) 1523 1472 w
(second) 1697 1472 w
(argument.) 2041 1472 w
(That) 2523 1472 w
(is,) 2764 1472 w
11 /Courier f
(recv) 2906 1472 w
11 /Times-Roman f
(receives) 3210 1472 w
(an) 3607 1472 w
(integer) 3750 1472 w
(and) 4093 1472 w
(stores) 566 1592 w
(it) 850 1592 w
(at) 940 1592 w
11 /Courier f
(&msg) 1047 1592 w
11 /Times-Roman f
(.) 1311 1592 w
(Once) 1395 1592 w
(the) 1653 1592 w
(integer) 1815 1592 w
(has) 2147 1592 w
(arrived,) 2321 1592 w
11 /Courier f
(ping) 2686 1592 w
11 /Times-Roman f
(increments) 2978 1592 w
(it) 3487 1592 w
(and) 3577 1592 w
(calls) 3763 1592 w
10 /Courier f
(send\(pongc, &msg\);) 786 1762 w
11 /Times-Roman f
(to) 566 1978 w
(send) 682 1978 w
(through) 913 1978 w
11 /Courier f
(pongc) 1285 1978 w
11 /Times-Roman f
(the) 1645 1978 w
(message) 1809 1978 w
(pointed) 2210 1978 w
(to) 2570 1978 w
(by) 2686 1978 w
11 /Courier f
(&msg) 2826 1978 w
11 /Times-Roman f
(.) 3090 1978 w
(That) 3176 1978 w
(is,) 3407 1978 w
(to) 3539 1978 w
(send) 3655 1978 w
(the) 3886 1978 w
(inte\255) 4050 1978 w
(ger) 566 2098 w
11 /Courier f
(msg) 737 2098 w
11 /Times-Roman f
(\(because) 967 2098 w
(the) 1380 2098 w
(channel) 1545 2098 w
(was) 1916 2098 w
(created) 2117 2098 w
(to) 2462 2098 w
(send) 2579 2098 w
(messages) 2811 2098 w
(with) 3256 2098 w
(the) 3483 2098 w
(size) 3648 2098 w
(of) 3849 2098 w
(a) 3971 2098 w
(inte\255) 4050 2098 w
(ger\).) 566 2218 w
(Initially,) 816 2374 w
(both) 1226 2374 w
(threads) 1455 2374 w
(would) 1804 2374 w
(block) 2113 2374 w
(at) 2391 2374 w
11 /Courier f
(recv) 2504 2374 w
11 /Times-Roman f
(,) 2768 2374 w
(because) 2830 2374 w
(nobody) 3209 2374 w
(is) 3573 2374 w
(sending) 3681 2374 w
(any\255) 4057 2374 w
(thing) 566 2494 w
(yet.) 834 2494 w
(To) 1037 2494 w
(kick) 1200 2494 w
(off) 1430 2494 w
(the) 1598 2494 w
(ping\255pong,) 1772 2494 w
(the) 2292 2494 w
(main) 2466 2494 w
(thread) 2726 2494 w
(sends) 3039 2494 w
(an) 3323 2494 w
(initial) 3466 2494 w
(zero) 3764 2494 w
(to) 3991 2494 w
(the) 4117 2494 w
11 /Courier f
(pingc) 566 2614 w
11 /Times-Roman f
(channel.) 924 2614 w
(See) 1320 2614 w
(figure) 1506 2614 w
([[!ping) 1795 2614 w
(pong!]].) 2127 2614 w
752 3064 576 576 De
(ping) 942 3086 w
1328 2956 1688 2956 Dl
1616 2974 1688 2956 Dl
1614 2968 1687 2956 Dl
1613 2961 1687 2956 Dl
1613 2956 1687 2956 Dl
1613 2950 1687 2955 Dl
1614 2943 1687 2955 Dl
1616 2938 1688 2956 Dl
1688 3028 1688 2884 Dl
1688 2884 2408 2884 Dl
2408 2884 2408 3028 Dl
2408 3028 1688 3028 Dl
(pongc) 1914 2978 w
2408 2956 2768 2956 Dl
2696 2974 2768 2956 Dl
2694 2968 2767 2956 Dl
2693 2961 2767 2956 Dl
2693 2956 2767 2956 Dl
2693 2950 2767 2955 Dl
2694 2943 2767 2955 Dl
2696 2938 2768 2956 Dl
1400 3154 1328 3172 Dl
1401 3159 1328 3171 Dl
1402 3166 1328 3171 Dl
1402 3172 1328 3172 Dl
1402 3177 1328 3172 Dl
1401 3184 1328 3172 Dl
1400 3190 1328 3172 Dl
1328 3172 1688 3172 Dl
1688 3244 1688 3100 Dl
1688 3100 2408 3100 Dl
2408 3100 2408 3244 Dl
2408 3244 1688 3244 Dl
(pingc) 1926 3194 w
2480 3154 2408 3172 Dl
2481 3159 2408 3171 Dl
2482 3166 2408 3171 Dl
2482 3172 2408 3172 Dl
2482 3177 2408 3172 Dl
2481 3184 2408 3172 Dl
2480 3190 2408 3172 Dl
2408 3172 2768 3172 Dl
2768 3064 576 576 De
(pong) 2946 3086 w
2480 3190 2408 3208 Dl
2481 3195 2408 3207 Dl
2482 3202 2408 3207 Dl
2482 3208 2408 3208 Dl
2482 3213 2408 3208 Dl
2481 3220 2408 3208 Dl
2480 3226 2408 3208 Dl
2408 3208 2408 3208 2768 3208 Ds
2408 3208 2768 3208 2768 3568 Ds
2768 3208 2768 3568 3128 3568 Ds
2768 3568 3128 3568 3128 3568 Ds
3128 3568 3488 3568 Dl
11 /Courier f
(0) 3275 3650 w
3488 3568 576 576 De
11 /Times-Roman f
(main) 3666 3590 w
(The) 816 4090 w
(output) 1019 4090 w
(from) 1334 4090 w
(the) 1580 4090 w
(program) 1747 4090 w
(is) 2152 4090 w
(a) 2260 4090 w
(nice) 2342 4090 w
(ping) 2558 4090 w
(pong.) 2788 4090 w
(Note) 3070 4090 w
(that) 3317 4090 w
(context) 3516 4090 w
(switches) 3873 4090 w
(between) 566 4210 w
(threads) 984 4210 w
(happen) 1354 4210 w
(when) 1724 4210 w
(we) 2015 4210 w
(call) 2196 4210 w
11 /Courier f
(send) 2407 4210 w
11 /Times-Roman f
(and) 2724 4210 w
11 /Courier f
(recv) 2935 4210 w
11 /Times-Roman f
(.) 3199 4210 w
(Any) 3308 4210 w
(synchronization) 3550 4210 w
(function) 566 4330 w
(from) 960 4330 w
(the) 1201 4330 w
(thread) 1363 4330 w
(library) 1664 4330 w
(is) 1984 4330 w
(likely) 2086 4330 w
(to) 2365 4330 w
(produce) 2479 4330 w
(a) 2859 4330 w
(context) 2935 4330 w
(switch.) 3286 4330 w
10 /Courier f
(; 8.out) 786 4500 w
(1) 786 4610 w
(2) 1266 4720 w
(3) 786 4830 w
(4) 1266 4940 w
10 /Times-Italic f
(...) 786 5050 w
11 /Times-Roman f
(A) 566 5266 w
(channel) 676 5266 w
(with) 1047 5266 w
(no) 1274 5266 w
(buffering) 1415 5266 w
(is) 1853 5266 w
(producing) 1958 5266 w
(a) 2434 5266 w
(rendezvous) 2513 5266 w
(between) 3042 5266 w
(the) 3438 5266 w
(thread) 3604 5266 w
(sending) 3909 5266 w
(and) 566 5386 w
(the) 754 5386 w
(one) 918 5386 w
(receiving.) 1106 5386 w
(A) 1571 5386 w
11 /Courier f
(recv) 1680 5386 w
11 /Times-Roman f
(from) 1974 5386 w
(such) 2217 5386 w
(a) 2448 5386 w
(channel) 2526 5386 w
(will) 2896 5386 w
(block,) 3098 5386 w
(until) 3400 5386 w
(there) 3633 5386 w
(is) 3880 5386 w
(some\255) 3983 5386 w
(thing) 566 5506 w
(to) 839 5506 w
(receive.) 971 5506 w
(Because) 1359 5506 w
(the) 1769 5506 w
(channel) 1949 5506 w
(has) 2336 5506 w
(no) 2529 5506 w
(buffering,) 2686 5506 w
(there) 3168 5506 w
(can) 3433 5506 w
(be) 3631 5506 w
11 /Times-Italic f
(nothing) 3781 5506 w
11 /Times-Roman f
(to) 4165 5506 w
(receive) 566 5626 w
(until) 919 5626 w
(another) 1161 5626 w
(thread) 1528 5626 w
(calls) 1840 5626 w
11 /Courier f
(send) 2080 5626 w
11 /Times-Roman f
(for) 2383 5626 w
(the) 2549 5626 w
(same) 2722 5626 w
(channel.) 2985 5626 w
(In) 3391 5626 w
(the) 3520 5626 w
(same) 3692 5626 w
(way,) 3955 5626 w
(a) 4203 5626 w
11 /Courier f
(send) 566 5746 w
11 /Times-Roman f
(to) 861 5746 w
(a) 978 5746 w
(channel) 1057 5746 w
(with) 1428 5746 w
(no) 1655 5746 w
(buffering) 1796 5746 w
(is) 2234 5746 w
(going) 2339 5746 w
(to) 2621 5746 w
(block) 2738 5746 w
(if) 3013 5746 w
(nobody) 3112 5746 w
(is) 3474 5746 w
(receiving) 3580 5746 w
(on) 4019 5746 w
(it.) 4161 5746 w
(It) 566 5866 w
(will) 661 5866 w
(block) 861 5866 w
(until) 1133 5866 w
(another) 1364 5866 w
(thread) 1720 5866 w
(calls) 2021 5866 w
11 /Courier f
(recv) 2250 5866 w
11 /Times-Roman f
(and) 2542 5866 w
(the) 2728 5866 w
(message) 2890 5866 w
(can) 3289 5866 w
(be) 3468 5866 w
(sent.) 3599 5866 w
(We) 816 6022 w
(could) 1025 6022 w
(exploit) 1327 6022 w
(this) 1691 6022 w
(in) 1910 6022 w
(our) 2055 6022 w
(program) 2260 6022 w
(to) 2690 6022 w
(synchronize) 2835 6022 w
(more) 3423 6022 w
(tightly) 3707 6022 w
(both) 4055 6022 w
(threads) 566 6142 w
(and) 917 6142 w
(use) 1110 6142 w
(just) 1291 6142 w
(one) 1486 6142 w
(channel.) 1679 6142 w
(This) 2082 6142 w
(is) 2313 6142 w
(useful) 2422 6142 w
(to) 2725 6142 w
(better) 2846 6142 w
(understand) 3130 6142 w
(how) 3645 6142 w
(channels) 3868 6142 w
(can) 566 6262 w
(be) 772 6262 w
(used,) 930 6262 w
(but) 1214 6262 w
(\(perhaps) 1410 6262 w
(arguably\)) 1841 6262 w
(it) 2315 6262 w
(leads) 2432 6262 w
(to) 2712 6262 w
(a) 2853 6262 w
(more) 2957 6262 w
(obscure,) 3238 6262 w
(yet) 3662 6262 w
(compact,) 3852 6262 w
cleartomark
showpage
saveobj restore
%%EndPage: 15 15
%%Page: 16 16
/saveobj save def
mark
16 pagesetup
11 /Times-Roman f
(\255 16 \255) 2289 413 w
(program.) 566 686 w
(Suppose) 816 842 w
(that) 1222 842 w
(initially) 1421 842 w
11 /Courier f
(ping) 1799 842 w
11 /Times-Roman f
(sends) 2097 842 w
(a) 2375 842 w
(message) 2457 842 w
(to) 2862 842 w
11 /Courier f
(pong) 2982 842 w
11 /Times-Roman f
(and) 3280 842 w
11 /Courier f
(pong) 3472 842 w
11 /Times-Roman f
(receives) 3770 842 w
(it.) 4161 842 w
(The) 566 962 w
(former) 776 962 w
(calls) 1113 962 w
11 /Courier f
(send) 1354 962 w
11 /Times-Roman f
(and) 1658 962 w
(the) 1856 962 w
(later) 2030 962 w
(calls) 2264 962 w
11 /Courier f
(recv.) 2505 962 w
11 /Times-Roman f
(If) 2875 962 w
11 /Courier f
(ping) 2986 962 w
11 /Times-Roman f
(calls) 3289 962 w
11 /Courier f
(send) 3529 962 w
11 /Times-Roman f
(first,) 3832 962 w
(it) 4076 962 w
(is) 4177 962 w
(going) 566 1082 w
(to) 858 1082 w
(block) 986 1082 w
(until) 1272 1082 w
11 /Courier f
(pong) 1517 1082 w
11 /Times-Roman f
(calls) 1823 1082 w
11 /Courier f
(recv) 2066 1082 w
11 /Times-Roman f
(on) 2372 1082 w
(the) 2524 1082 w
(channel) 2700 1082 w
(\(which) 3082 1082 w
(had) 3428 1082 w
(no) 3628 1082 w
(buffering\).) 3780 1082 w
(And) 566 1202 w
(vice\255versa.) 783 1202 w
(Now) 816 1358 w
(comes) 1073 1358 w
(the) 1397 1358 w
(point.) 1575 1358 w
(When) 1902 1358 w
11 /Courier f
(ping) 2207 1358 w
11 /Times-Roman f
(completes) 2515 1358 w
(its) 3004 1358 w
11 /Courier f
(send) 3153 1358 w
11 /Times-Roman f
(it) 3461 1358 w
(is) 3568 1358 w
(for) 3687 1358 w
(sure) 3859 1358 w
(that) 4086 1358 w
11 /Courier f
(pong) 566 1478 w
11 /Times-Roman f
(has) 872 1478 w
(completed) 1060 1478 w
(its) 1559 1478 w
11 /Courier f
(recv) 1706 1478 w
11 /Times-Roman f
(.) 1970 1478 w
(Or) 2068 1478 w
(we) 2225 1478 w
(could) 2394 1478 w
(say) 2680 1478 w
(that) 2868 1478 w
(when) 3075 1478 w
11 /Courier f
(pong) 3354 1478 w
11 /Times-Roman f
(completes) 3660 1478 w
(its) 4146 1478 w
11 /Courier f
(recv) 566 1598 w
11 /Times-Roman f
(it) 872 1598 w
(is) 976 1598 w
(certain) 1092 1598 w
(that) 1431 1598 w
11 /Courier f
(ping) 1638 1598 w
11 /Times-Roman f
(completed) 1945 1598 w
(its) 2445 1598 w
11 /Courier f
(send.) 2593 1598 w
11 /Times-Roman f
(Therefore,) 2966 1598 w
(the) 3466 1598 w
(same) 3643 1598 w
(channel) 3911 1598 w
(can) 566 1718 w
(be) 752 1718 w
(used) 890 1718 w
(again) 1126 1718 w
(to) 1398 1718 w
(send) 1519 1718 w
(a) 1755 1718 w
(number) 1838 1718 w
(back.) 2208 1718 w
(This) 2476 1718 w
(time,) 2706 1718 w
11 /Courier f
(pong) 2964 1718 w
11 /Times-Roman f
(calls) 3262 1718 w
11 /Courier f
(send) 3497 1718 w
11 /Times-Roman f
(and) 3795 1718 w
11 /Courier f
(ping) 3987 1718 w
11 /Times-Roman f
(calls) 566 1838 w
11 /Courier f
(recv) 804 1838 w
11 /Times-Roman f
(.) 1068 1838 w
(Again,) 1162 1838 w
(both) 1496 1838 w
(calls) 1730 1838 w
(will) 1969 1838 w
(rendezvous,) 2179 1838 w
(the) 2743 1838 w
(first) 2915 1838 w
(call) 3130 1838 w
(made) 3326 1838 w
(will) 3601 1838 w
(block) 3811 1838 w
(and) 4093 1838 w
(wait) 566 1958 w
(for) 786 1958 w
(the) 944 1958 w
(other.) 1109 1958 w
(There) 1421 1958 w
(is) 1706 1958 w
(no) 1811 1958 w
(doubt) 1952 1958 w
(regarding) 2234 1958 w
(which) 2684 1958 w
11 /Courier f
(recv) 2983 1958 w
11 /Times-Roman f
(is) 3278 1958 w
(going) 3383 1958 w
(to) 3664 1958 w
(receive) 3780 1958 w
(for) 4124 1958 w
(which) 566 2078 w
11 /Courier f
(send.) 862 2078 w
11 /Times-Roman f
(So,) 1220 2078 w
(the) 1393 2078 w
(code) 1555 2078 w
(would) 1789 2078 w
(work) 2092 2078 w
(along) 2345 2078 w
(these) 2617 2078 w
(lines.) 2870 2078 w
10 /Courier f
(ping\(\) {) 786 2248 w
10 /Times-Roman f
(\(1\)) 786 2358 w
10 /Courier f
(send\(c, &msg\);) 1266 2358 w
(//) 2226 2358 w
10 /Times-Italic f
(sends to) 2406 2358 w
10 /Times-Roman f
(\(3\)) 2756 2358 w
(\(2\)) 786 2468 w
10 /Courier f
(recv\(c, &msg\);) 1266 2468 w
(//) 2226 2468 w
10 /Times-Italic f
(receives from) 2406 2468 w
10 /Times-Roman f
(\(4\)) 2971 2468 w
10 /Courier f
(}) 786 2578 w
(pong\(\) {) 786 2688 w
10 /Times-Roman f
(\(3\)) 786 2798 w
10 /Courier f
(recv\(c, &msg\);) 1266 2798 w
(//) 2226 2798 w
10 /Times-Italic f
(receives from) 2406 2798 w
10 /Times-Roman f
(\(1\)) 2971 2798 w
(\(4\)) 786 2908 w
10 /Courier f
(send\(c, &msg\);) 1266 2908 w
(//) 2226 2908 w
10 /Times-Italic f
(sends to) 2406 2908 w
10 /Times-Roman f
(\(2\)) 2756 2908 w
10 /Courier f
(}) 786 3018 w
11 /Times-Roman f
(But) 566 3234 w
(both) 761 3234 w
(threads) 992 3234 w
(look) 1343 3234 w
(fairly) 1575 3234 w
(similar.) 1848 3234 w
(In) 2218 3234 w
(fact,) 2345 3234 w
(considering) 2572 3234 w
(their) 3120 3234 w
(loops,) 3357 3234 w
(they) 3660 3234 w
(look) 3885 3234 w
(the) 4117 3234 w
(same.) 566 3354 w
(Receive) 851 3354 w
(something,) 1235 3354 w
(increment) 1753 3354 w
(it,) 2222 3354 w
(send) 2343 3354 w
(it) 2575 3354 w
(back.) 2668 3354 w
(Only) 2933 3354 w
(that) 3184 3354 w
(while) 3380 3354 w
(one) 3655 3354 w
(is) 3844 3354 w
(receiv\255) 3949 3354 w
(ing) 566 3474 w
(the) 758 3474 w
(other) 943 3474 w
(one) 1219 3474 w
(is) 1428 3474 w
(sending.) 1553 3474 w
(Therefore,) 1974 3474 w
(we) 2482 3474 w
(could) 2661 3474 w
(use) 2957 3474 w
(the) 3155 3474 w
(same) 3341 3474 w
(code) 3618 3474 w
(for) 3876 3474 w
(both) 4055 3474 w
(threads,) 566 3594 w
(like) 938 3594 w
(the) 1131 3594 w
(next) 1293 3594 w
(program) 1510 3594 w
(does.) 1909 3594 w
cleartomark
showpage
saveobj restore
%%EndPage: 16 16
%%Page: 17 17
/saveobj save def
mark
17 pagesetup
11 /Times-Roman f
(\255 17 \255) 2289 413 w
9 /S f
(\347) 566 676 w
9 /Times-Bold f
(pong2.c) 581 676 w
9 /S f
(\347) 894 676 w
(`) 566 676 w
(```````) 579 676 w
(_) 566 676 w
(_______) 579 676 w
8 /Courier f
(#include <u.h>) 786 784 w
(#include <libc.h>) 786 892 w
(#include <thread.h>) 786 1000 w
(void) 786 1216 w
(pingpongthread\(void*a\)) 786 1324 w
({) 786 1432 w
(ulong) 1266 1540 w
(msg;) 1746 1540 w
(Channel*c = a;) 1266 1648 w
(for\(;;\){) 1266 1864 w
(msg = recvul\(c\);) 1746 1972 w
(// i.e., recv\(c, &msg\);) 2706 1972 w
(msg++;) 1746 2080 w
(print\("%d\\n", msg\);) 1746 2188 w
(sendul\(c, msg\);) 1746 2296 w
(// i.e., send\(c, &msg\);) 3186 2296 w
(}) 1266 2404 w
(}) 786 2512 w
(void) 786 2728 w
(threadmain\(int, char*[]\)) 786 2836 w
({) 786 2944 w
(Channel* c;) 1266 3052 w
(int) 1266 3160 w
(kickoff;) 1746 3160 w
(c = chancreate\(sizeof\(int\), 0\);) 1266 3376 w
(threadcreate\(pingpongthread, c, 8*1024\);) 1266 3484 w
(threadcreate\(pingpongthread, c, 8*1024\);) 1266 3592 w
(kickoff = 0;) 1266 3700 w
(sendul\(c, kickoff\);) 1266 3808 w
(threadexits\(nil\);) 1266 3916 w
(}) 786 4024 w
11 /Times-Roman f
(Initially,) 566 4240 w
(both) 996 4240 w
(threads) 1245 4240 w
(\(now) 1614 4240 w
(running) 1892 4240 w
11 /Courier f
(pingpongthread) 2288 4240 w
11 /Times-Roman f
(\)) 3212 4240 w
(will) 3302 4240 w
(block) 3528 4240 w
(at) 3826 4240 w
11 /Courier f
(recv) 3959 4240 w
11 /Times-Roman f
(.) 4223 4240 w
(They) 566 4360 w
(are) 823 4360 w
(ready) 987 4360 w
(for) 1261 4360 w
(their) 1420 4360 w
(match.) 1653 4360 w
(When) 1981 4360 w
(the) 2273 4360 w
(main) 2438 4360 w
(thread) 2689 4360 w
(sends) 2993 4360 w
(an) 3268 4360 w
(initial) 3402 4360 w
(zero) 3691 4360 w
(through) 3909 4360 w
(the) 566 4480 w
(only) 743 4480 w
(channel,) 982 4480 w
(the) 1393 4480 w
(thread) 1570 4480 w
(that) 1886 4480 w
(called) 2094 4480 w
11 /Courier f
(recv) 2398 4480 w
11 /Times-Roman f
(first) 2705 4480 w
(will) 2925 4480 w
(be) 3140 4480 w
(the) 3286 4480 w
(one) 3464 4480 w
(receiving) 3666 4480 w
(the) 4117 4480 w
(message.) 566 4600 w
(Which) 1000 4600 w
(one) 1327 4600 w
(does) 1519 4600 w
(receive) 1754 4600 w
(it?) 2102 4600 w
(We) 2246 4600 w
(do) 2431 4600 w
(not) 2575 4600 w
(care.) 2750 4600 w
(If) 2992 4600 w
(both) 3098 4600 w
(players) 3328 4600 w
(run) 3678 4600 w
(the) 3858 4600 w
(same) 4026 4600 w
(code,) 566 4720 w
(why) 828 4720 w
(should) 1045 4720 w
(we) 1367 4720 w
(care?) 1522 4720 w
(At) 816 4876 w
(this) 955 4876 w
(point) 1144 4876 w
(things) 1400 4876 w
(work) 1699 4876 w
(as) 1953 4876 w
(discussed) 2073 4876 w
(above.) 2523 4876 w
(The) 2841 4876 w
(thread) 3040 4876 w
(that) 3342 4876 w
(received) 3536 4876 w
(the) 3934 4876 w
(ini\255) 4098 4876 w
(tial) 566 4996 w
(zero) 738 4996 w
(is) 955 4996 w
(now) 1059 4996 w
(after) 1278 4996 w
(its) 1507 4996 w
11 /Courier f
(recv) 1642 4996 w
11 /Times-Roman f
(,) 1906 4996 w
(preparing) 1964 4996 w
(to) 2413 4996 w
(send) 2529 4996 w
11 /Courier f
(1) 2760 4996 w
11 /Times-Roman f
(to) 2856 4996 w
(the) 2972 4996 w
(other.) 3136 4996 w
(The) 3419 4996 w
(other) 3619 4996 w
(thread) 3874 4996 w
(is) 4177 4996 w
(still) 566 5116 w
(waiting) 771 5116 w
(inside) 1139 5116 w
11 /Courier f
(recv) 1440 5116 w
11 /Times-Roman f
(.) 1704 5116 w
(The) 1798 5116 w
11 /Courier f
(send) 2006 5116 w
11 /Times-Roman f
(from) 2308 5116 w
(the) 2559 5116 w
(former) 2731 5116 w
(will) 3066 5116 w
(deliver) 3276 5116 w
(the) 3618 5116 w
(number) 3791 5116 w
(to) 4165 5116 w
(the) 566 5236 w
(later.) 738 5236 w
(And) 998 5236 w
(both) 1225 5236 w
(calls) 1459 5236 w
(will) 1698 5236 w
(meet) 1908 5236 w
(in) 2159 5236 w
(time) 2283 5236 w
(because) 2517 5236 w
(of) 2900 5236 w
(the) 3029 5236 w
(lack) 3201 5236 w
(of) 3421 5236 w
(buffering) 3550 5236 w
(in) 3994 5236 w
(the) 4117 5236 w
(channel.) 566 5356 w
(Later,) 962 5356 w
(the) 1248 5356 w
(very) 1410 5356 w
(same) 1632 5356 w
(channel) 1885 5356 w
(will) 2253 5356 w
(be) 2453 5356 w
(free) 2584 5356 w
(to) 2780 5356 w
(send) 2894 5356 w
(another) 3123 5356 w
(number) 3479 5356 w
(back.) 3842 5356 w
(The) 816 5512 w
(program) 1015 5512 w
(uses) 1415 5512 w
11 /Courier f
(sendul) 1633 5512 w
11 /Times-Roman f
(and) 2058 5512 w
11 /Courier f
(recvul) 2245 5512 w
11 /Times-Roman f
(,) 2641 5512 w
(instead) 2698 5512 w
(of) 3038 5512 w
11 /Courier f
(send) 3158 5512 w
11 /Times-Roman f
(and) 3452 5512 w
11 /Courier f
(recv) 3640 5512 w
11 /Times-Roman f
(.) 3904 5512 w
(These) 3990 5512 w
(functions) 566 5632 w
(are) 1006 5632 w
(convenience) 1169 5632 w
(routines) 1746 5632 w
(that) 2131 5632 w
(send) 2327 5632 w
(and) 2559 5632 w
(receive) 2748 5632 w
(an) 3092 5632 w
(unsigned) 3225 5632 w
(integer) 3652 5632 w
(value.) 3986 5632 w
(They) 566 5752 w
(are) 836 5752 w
(very) 1013 5752 w
(convenient) 1252 5752 w
(when) 1778 5752 w
(the) 2060 5752 w
(channel) 2239 5752 w
(is) 2624 5752 w
(used) 2744 5752 w
(to) 2991 5752 w
(send) 3123 5752 w
(integers.) 3370 5752 w
(There) 3819 5752 w
(are) 4119 5752 w
(other) 566 5872 w
(similar) 832 5872 w
(functions,) 1179 5872 w
(called) 1657 5872 w
11 /Courier f
(sendp) 1959 5872 w
11 /Times-Roman f
(and) 2330 5872 w
11 /Courier f
(recvp) 2529 5872 w
11 /Times-Roman f
(that) 2899 5872 w
(send) 3104 5872 w
(and) 3345 5872 w
(receive) 3543 5872 w
(pointers) 3897 5872 w
(instead.) 566 5992 w
cleartomark
showpage
saveobj restore
%%EndPage: 17 17
%%Page: 18 18
/saveobj save def
mark
18 pagesetup
11 /Times-Roman f
(\255 18 \255) 2289 413 w
10 /Courier f
(; sig sendul recvul sendp recvp) 786 676 w
(int sendul\(Channel *c, ulong v\)) 1266 786 w
(ulong recvul\(Channel *c\)) 1266 896 w
(int sendp\(Channel *c, void *v\)) 1266 1006 w
(void* recvp\(Channel *c\)) 1266 1116 w
11 /Times-Roman f
(They) 566 1332 w
(are) 835 1332 w
(exactly) 1012 1332 w
(like) 1373 1332 w
11 /Courier f
(send) 1583 1332 w
11 /Times-Roman f
(and) 1892 1332 w
11 /Courier f
(recv) 2095 1332 w
11 /Times-Roman f
(for) 2404 1332 w
(messages) 2576 1332 w
(of) 3035 1332 w
(the) 3171 1332 w
(size) 3350 1332 w
(of) 3565 1332 w
(integers) 3701 1332 w
(and) 4093 1332 w
(messages) 566 1452 w
(of) 1008 1452 w
(the) 1127 1452 w
(size) 1289 1452 w
(of) 1487 1452 w
(pointers,) 1606 1452 w
(respectively.) 2016 1452 w
16 /Times-Bold f
(11.4.) 566 1812 w
(I/O) 966 1812 w
(in) 1238 1812 w
(threaded) 1413 1812 w
(programs) 2066 1812 w
11 /Times-Roman f
(Performing) 566 1968 w
(I/O) 1096 1968 w
(from) 1272 1968 w
(a) 1515 1968 w
(thread) 1593 1968 w
(that) 1896 1968 w
(shares) 2091 1968 w
(the) 2395 1968 w
(process) 2560 1968 w
(with) 2919 1968 w
(other) 3146 1968 w
(threads) 3402 1968 w
(is) 3749 1968 w
(usually) 3854 1968 w
(a) 4203 1968 w
(bad) 566 2088 w
(idea.) 753 2088 w
(It) 992 2088 w
(is) 1088 2088 w
(not) 1191 2088 w
(harmful) 1361 2088 w
(to) 1737 2088 w
(call) 1852 2088 w
11 /Courier f
(print) 2038 2088 w
11 /Times-Roman f
(and) 2396 2088 w
(other) 2582 2088 w
(I/O) 2835 2088 w
(functions) 3009 2088 w
(for) 3446 2088 w
(debugging) 3601 2088 w
(and) 4093 2088 w
(similar) 566 2208 w
(purposes.) 902 2208 w
(But) 1350 2208 w
(it) 1541 2208 w
(may) 1634 2208 w
(be) 1854 2208 w
(harmful) 1988 2208 w
(to) 2366 2208 w
(the) 2483 2208 w
(program) 2648 2208 w
(to) 3050 2208 w
(read) 3167 2208 w
(from) 3385 2208 w
(the) 3629 2208 w
(console) 3794 2208 w
(or) 4160 2208 w
(to) 566 2328 w
(read) 680 2328 w
(from) 895 2328 w
(or) 1136 2328 w
(write) 1255 2328 w
(to) 1508 2328 w
(a) 1622 2328 w
(network) 1698 2328 w
(connection.) 2085 2328 w
(Consider) 816 2484 w
(the) 1241 2484 w
(airport) 1404 2484 w
(panels) 1725 2484 w
(application) 2034 2484 w
(from) 2551 2484 w
(the) 2793 2484 w
(last) 2956 2484 w
(chapter.) 3138 2484 w
(We) 3544 2484 w
(are) 3724 2484 w
(going) 3885 2484 w
(to) 4165 2484 w
(make) 566 2604 w
(an) 847 2604 w
(implementation) 994 2604 w
(using) 1729 2604 w
(threads.) 2012 2604 w
(The) 2428 2604 w
(application) 2641 2604 w
(must) 3172 2604 w
(convey) 3430 2604 w
(a) 3789 2604 w
(message) 3880 2604 w
(typed) 566 2724 w
(at) 843 2724 w
(a) 955 2724 w
(console) 1036 2724 w
(to) 1404 2724 w
(the) 1523 2724 w
(multiple) 1690 2724 w
(panels) 2091 2724 w
(in) 2404 2724 w
(the) 2523 2724 w
(airport.) 2690 2724 w
(This) 3043 2724 w
(implies) 3272 2724 w
(several) 3630 2724 w
(differ\255) 3973 2724 w
(ent) 566 2844 w
(activities:) 728 2844 w
(1) 566 3000 w
(Reading) 816 3000 w
(messages) 1210 3000 w
(from) 1652 3000 w
(the) 1893 3000 w
(console.) 2055 3000 w
(2) 566 3156 w
(Broadcasting) 816 3156 w
(each) 1423 3156 w
(new) 1650 3156 w
(message) 1860 3156 w
(to) 2259 3156 w
(all) 2373 3156 w
(the) 2511 3156 w
(panels.) 2673 3156 w
(3) 566 3312 w
(Updating) 816 3312 w
(each) 1253 3312 w
(panel) 1480 3312 w
(Using) 566 3468 w
(the) 869 3468 w
(thread) 1043 3468 w
(library,) 1356 3468 w
(we) 1716 3468 w
(can) 1883 3468 w
(program) 2074 3468 w
(the) 2485 3468 w
(application) 2659 3468 w
(in) 3187 3468 w
(a) 3313 3468 w
(very) 3401 3468 w
(modular) 3635 3468 w
(way.) 4041 3468 w
(Each) 566 3588 w
(activity) 829 3588 w
(may) 1204 3588 w
(be) 1438 3588 w
(performed) 1586 3588 w
(by) 2086 3588 w
(a) 2241 3588 w
(different) 2333 3588 w
(thread,) 2753 3588 w
(without) 3098 3588 w
(even) 3479 3588 w
(thinking) 3729 3588 w
(on) 4141 3588 w
(what) 566 3708 w
(the) 807 3708 w
(other) 969 3708 w
(threads) 1222 3708 w
(would) 1566 3708 w
(do.) 1869 3708 w
(To) 2035 3708 w
(make) 2186 3708 w
(all) 2452 3708 w
(the) 2591 3708 w
(threads) 2754 3708 w
(work) 3099 3708 w
(together,) 3353 3708 w
(we) 3769 3708 w
(can) 3925 3708 w
(use) 4105 3708 w
(channels.) 566 3828 w
(For) 816 3984 w
(example,) 1004 3984 w
(a) 1438 3984 w
11 /Courier f
(consread) 1521 3984 w
11 /Times-Roman f
(thread) 2084 3984 w
(may) 2392 3984 w
(be) 2616 3984 w
(in) 2754 3984 w
(charge) 2876 3984 w
(of) 3202 3984 w
(reading) 3329 3984 w
(one) 3693 3984 w
(line) 3887 3984 w
(at) 4088 3984 w
(a) 4203 3984 w
(time) 566 4104 w
(from) 807 4104 w
(the) 1064 4104 w
(console,) 1242 4104 w
(and) 1649 4104 w
(send) 1851 4104 w
(each) 2096 4104 w
(new) 2339 4104 w
(message) 2565 4104 w
(read) 2980 4104 w
(through) 3211 4104 w
(a) 3597 4104 w
(channel) 3689 4104 w
(to) 4073 4104 w
(a) 4203 4104 w
11 /Courier f
(bcast) 566 4224 w
11 /Times-Roman f
(thread.) 924 4224 w
10 /Courier f
(void) 786 4394 w
(consreadthread\(void*\)) 786 4504 w
({) 786 4614 w
(Biobuf) 1266 4724 w
(bin;) 1746 4724 w
(char*) 1266 4834 w
(ln;) 1746 4834 w
(threadsetname\("consread"\);) 1266 5054 w
(Binit\(&bin, 0, OREAD\);) 1266 5164 w
(while \(ln = Brdstr\(&bin, '\\n', 0\)\)) 1266 5274 w
(sendp\(bcastc, ln\);) 1746 5384 w
(sendp\(bcastc, nil\);) 1266 5494 w
(Bterm\(&bin\);) 1266 5604 w
(threadexits\(nil\);) 1266 5714 w
(}) 786 5824 w
11 /Times-Roman f
(The) 566 6040 w
(code) 771 6040 w
(can) 1012 6040 w
(now) 1198 6040 w
(be) 1423 6040 w
(almost) 1562 6040 w
(as) 1892 6040 w
(simple) 2019 6040 w
(as) 2349 6040 w
(the) 2476 6040 w
(definition) 2646 6040 w
(for) 3110 6040 w
(the) 3273 6040 w
(thread's) 3443 6040 w
(task.) 3831 6040 w
(We) 4100 6040 w
(have) 566 6160 w
(used) 803 6160 w
11 /Courier f
(Brdstr) 1035 6160 w
11 /Times-Roman f
(from) 1462 6160 w
11 /Times-Italic f
(bio) 1706 6160 w
11 /Times-Roman f
(\(2\)) 1847 6160 w
(to) 2004 6160 w
(read) 2120 6160 w
(a) 2337 6160 w
(line) 2415 6160 w
(at) 2610 6160 w
(a) 2719 6160 w
(time) 2797 6160 w
(from) 3023 6160 w
(standard) 3266 6160 w
(input.) 3667 6160 w
(Unline) 3952 6160 w
11 /Courier f
(Brdline) 566 6280 w
11 /Times-Roman f
(,) 1028 6280 w
(this) 1084 6280 w
(function) 1272 6280 w
(returns) 1666 6280 w
(a) 1998 6280 w
(C) 2074 6280 w
(string) 2176 6280 w
(allocated) 2455 6280 w
(with) 2878 6280 w
11 /Courier f
(malloc) 3103 6280 w
11 /Times-Roman f
(that) 3528 6280 w
(contains) 3722 6280 w
(the) 4117 6280 w
cleartomark
showpage
saveobj restore
%%EndPage: 18 18
%%Page: 19 19
/saveobj save def
mark
19 pagesetup
11 /Times-Roman f
(\255 19 \255) 2289 413 w
(line) 566 686 w
(read.) 765 686 w
(The) 1014 686 w
(final) 1218 686 w
(argument) 1453 686 w
11 /Courier f
(0) 1901 686 w
11 /Times-Roman f
(asks) 2001 686 w
11 /Courier f
(Brdstr) 2224 686 w
11 /Times-Roman f
(not) 2654 686 w
(to) 2829 686 w
(remove) 2949 686 w
(the) 3311 686 w
(trailing) 3479 686 w
11 /Courier f
(\\n) 3831 686 w
11 /Times-Roman f
(in) 3997 686 w
(the) 4117 686 w
(string,) 566 806 w
(which) 884 806 w
(is) 1191 806 w
(just) 1304 806 w
(what) 1503 806 w
(we) 1755 806 w
(need.) 1922 806 w
(To) 2196 806 w
(make) 2358 806 w
(things) 2635 806 w
(terminate) 2945 806 w
(cleanly,) 3399 806 w
(upon) 3783 806 w
(EOF) 4043 806 w
(from) 566 926 w
(standard) 807 926 w
(input,) 1206 926 w
(we) 1489 926 w
(send) 1644 926 w
(a) 1873 926 w
(nil) 1949 926 w
(message) 2094 926 w
(as) 2493 926 w
(an) 2612 926 w
(indication) 2743 926 w
(to) 3211 926 w
(exit.) 3325 926 w
(Another) 816 1082 w
(thread,) 1206 1082 w
11 /Courier f
(bcast) 1538 1082 w
11 /Times-Roman f
(,) 1868 1082 w
(will) 1927 1082 w
(be) 2130 1082 w
(only) 2264 1082 w
(concerned) 2491 1082 w
(about) 2970 1082 w
(broadcasting) 3245 1082 w
(messages) 3837 1082 w
(to) 566 1202 w
(panels.) 694 1202 w
(When) 1044 1202 w
(it) 1347 1202 w
(receives) 1451 1202 w
(a) 1850 1202 w
(new) 1940 1202 w
(message,) 2164 1202 w
(it) 2605 1202 w
(sends) 2708 1202 w
(one) 2993 1202 w
(copy) 3192 1202 w
(of) 3446 1202 w
(the) 3578 1202 w
(message) 3753 1202 w
(to) 4165 1202 w
(each) 566 1322 w
(panel.) 801 1322 w
(To) 1102 1322 w
(do) 1260 1322 w
(this,) 1406 1322 w
(the) 1630 1322 w
(program) 1801 1322 w
(may) 2209 1322 w
(use) 2435 1322 w
(an) 2618 1322 w
(array) 2758 1322 w
(of) 3018 1322 w
(channels,) 3146 1322 w
11 /Courier f
(panelc) 3594 1322 w
11 /Times-Roman f
(,) 3990 1322 w
(with) 4055 1322 w
(one) 566 1442 w
(channel) 752 1442 w
(per) 1120 1442 w
(panel.) 1287 1442 w
9 /Courier f
(void) 786 1612 w
(bcastthread\(void*\)) 786 1722 w
({) 786 1832 w
(char*) 1266 1942 w
(msg;) 1746 1942 w
(int) 1266 2052 w
(i;) 1746 2052 w
(threadsetname\("bcast"\);) 1266 2272 w
(do {) 1266 2382 w
(msg = recvp\(bcastc\);) 1746 2492 w
(for \(i = 0; i < Npanels; i++\)) 1746 2602 w
(if \(msg != nil\)) 2226 2712 w
(sendp\(panelc[i], strdup\(msg\)\);) 2706 2822 w
(else) 2226 2932 w
(sendp\(panelc[i], nil\);) 2706 3042 w
(free\(msg\);) 1746 3152 w
(} while\(msg != nil\);) 1266 3262 w
(threadexits\(nil\);) 1266 3372 w
(}) 786 3482 w
11 /Times-Roman f
(The) 566 3698 w
(nil) 772 3698 w
(message) 925 3698 w
(meaning) 1332 3698 w
(exiting) 1746 3698 w
(is) 2088 3698 w
(also) 2198 3698 w
(broadcasted,) 2411 3698 w
(to) 2997 3698 w
(indicate) 3119 3698 w
(to) 3502 3698 w
(all) 3624 3698 w
(panels) 3770 3698 w
(that) 4086 3698 w
(the) 566 3818 w
(program) 728 3818 w
(is) 1127 3818 w
(terminating.) 1229 3818 w
(A) 816 3974 w
11 /Courier f
(panel) 924 3974 w
11 /Times-Roman f
(thread) 1283 3974 w
(\(one) 1585 3974 w
(for) 1808 3974 w
(each) 1964 3974 w
(panel\)) 2192 3974 w
(can) 2494 3974 w
(simply) 2674 3974 w
(read) 3004 3974 w
(new) 3220 3974 w
(messages) 3431 3974 w
(from) 3874 3974 w
(the) 4117 3974 w
(panel's) 566 4094 w
(channel) 920 4094 w
(and) 1298 4094 w
(update) 1494 4094 w
(a) 1824 4094 w
(panel.) 1910 4094 w
(It) 2213 4094 w
(needs) 2318 4094 w
(to) 2605 4094 w
(know) 2728 4094 w
(which) 3009 4094 w
(channel) 3314 4094 w
(to) 3691 4094 w
(read) 3814 4094 w
(mes\255) 4038 4094 w
(sages) 566 4214 w
(from,) 835 4214 w
(and) 1108 4214 w
(which) 1298 4214 w
(panel) 1598 4214 w
(to) 1867 4214 w
(write) 1985 4214 w
(to.) 2243 4214 w
(A) 2390 4214 w
(structure) 2502 4214 w
(is) 2918 4214 w
(declared) 3025 4214 w
(to) 3427 4214 w
(pass) 3546 4214 w
(such) 3768 4214 w
(infor\255) 4002 4214 w
(mation) 566 4334 w
(as) 900 4334 w
(an) 1019 4334 w
(argument.) 1150 4334 w
10 /Courier f
(typedef struct PArg PArg;) 786 4504 w
(struct PArg {) 786 4614 w
(Channel* c;) 1266 4724 w
(// to get new messages from) 2226 4724 w
(int) 1266 4834 w
(fd;) 1746 4834 w
(// to the panel's file.) 2226 4834 w
(};) 786 4944 w
11 /Times-Roman f
(Using) 566 5160 w
(it,) 860 5160 w
(this) 981 5160 w
(can) 1172 5160 w
(be) 1354 5160 w
(its) 1488 5160 w
(implementation.) 1624 5160 w
(Like) 2374 5160 w
(before,) 2606 5160 w
(a) 2943 5160 w
(nil) 3022 5160 w
(message) 3170 5160 w
(is) 3572 5160 w
(an) 3677 5160 w
(indication) 3811 5160 w
(to) 566 5280 w
(exit.) 680 5280 w
cleartomark
showpage
saveobj restore
%%EndPage: 19 19
%%Page: 20 20
/saveobj save def
mark
20 pagesetup
11 /Times-Roman f
(\255 20 \255) 2289 413 w
10 /Courier f
(void) 786 676 w
(panelthread\(void* a\)) 786 786 w
({) 786 896 w
(PArg*) 1266 1006 w
(arg = a;) 1746 1006 w
(char*) 1266 1116 w
(msg;) 1746 1116 w
(threadsetname\("panel"\);) 1266 1336 w
(while\(msg = recvp\(arg\255>c\)\){) 1266 1446 w
(write\(arg\255>fd, msg, strlen\(msg\)\);) 1746 1556 w
(free\(msg\);) 1746 1666 w
(}) 1266 1776 w
(threadexits\(nil\);) 1266 1886 w
(}) 786 1996 w
11 /Times-Roman f
(All) 566 2212 w
(threads) 748 2212 w
(were) 1105 2212 w
(simple) 1357 2212 w
(to) 1693 2212 w
(implement,) 1821 2212 w
(and) 2362 2212 w
(the) 2562 2212 w
(structure) 2738 2212 w
(for) 3163 2212 w
(the) 3332 2212 w
(program) 3508 2212 w
(follows) 3921 2212 w
(easily) 566 2332 w
(from) 857 2332 w
(the) 1105 2332 w
(problem) 1274 2332 w
(being) 1674 2332 w
(solved.) 1952 2332 w
(We) 2301 2332 w
(did) 2486 2332 w
(not) 2661 2332 w
(have) 2836 2332 w
(to) 3076 2332 w
(worry) 3196 2332 w
(about) 3491 2332 w
(races) 3769 2332 w
(since) 4026 2332 w
(each) 566 2452 w
(thread) 793 2452 w
(is) 1094 2452 w
(only) 1196 2452 w
(using) 1420 2452 w
(its) 1687 2452 w
(own) 1820 2452 w
(data.) 2037 2452 w
(There) 816 2608 w
(is) 1114 2608 w
(one) 1232 2608 w
(problem,) 1435 2608 w
(though.) 1874 2608 w
(If) 2253 2608 w
(a) 2370 2608 w
(thread) 2463 2608 w
(calls) 2781 2608 w
11 /Courier f
(Brdstr) 3027 2608 w
11 /Times-Roman f
(,) 3423 2608 w
(to) 3496 2608 w
(read) 3627 2608 w
(from) 3859 2608 w
(the) 4117 2608 w
(console,) 566 2728 w
(it) 965 2728 w
(is) 1063 2728 w
(going) 1173 2728 w
(to) 1460 2728 w
(block) 1581 2728 w
(all) 1860 2728 w
(the) 2005 2728 w
(threads.) 2174 2728 w
(It) 2553 2728 w
(blocks) 2655 2728 w
(the) 2977 2728 w
(entire) 3146 2728 w
(process.) 3430 2728 w
(The) 3821 2728 w
(same) 4026 2728 w
(happens) 566 2848 w
(while) 955 2848 w
(updating) 1229 2848 w
(the) 1644 2848 w
(slow) 1808 2848 w
(panels) 2046 2848 w
(using) 2356 2848 w
(a) 2625 2848 w
11 /Courier f
(write) 2703 2848 w
11 /Times-Roman f
(to) 3063 2848 w
(their) 3179 2848 w
(files.) 3410 2848 w
(This) 3658 2848 w
(problem) 3885 2848 w
(is) 566 2968 w
(easy) 678 2968 w
(to) 910 2968 w
(solve.) 1034 2968 w
(Instead) 1332 2968 w
(of) 1686 2968 w
(creating) 1815 2968 w
(a) 2205 2968 w
(thread) 2291 2968 w
(to) 2602 2968 w
(run) 2726 2968 w
11 /Courier f
(consreadthread) 2909 2968 w
11 /Times-Roman f
(,) 3833 2968 w
(and) 3898 2968 w
(one) 4093 2968 w
(more) 566 3088 w
(thread) 834 3088 w
(to) 1150 3088 w
(run) 1280 3088 w
(each) 1470 3088 w
11 /Courier f
(panelthread) 1713 3088 w
11 /Times-Roman f
(function,) 2483 3088 w
(we) 2921 3088 w
(can) 3092 3088 w
(create) 3287 3088 w
(processes.) 3590 3088 w
(The) 4081 3088 w
(function) 566 3208 w
11 /Courier f
(proccreate) 967 3208 w
11 /Times-Roman f
(creates) 1662 3208 w
(a) 1999 3208 w
(new) 2082 3208 w
(process) 2298 3208 w
(\(using) 2660 3208 w
11 /Courier f
(rfork) 2969 3208 w
11 /Times-Roman f
(\)) 3299 3208 w
(with) 3369 3208 w
(a) 3599 3208 w
(single) 3681 3208 w
(thread) 3978 3208 w
(in) 566 3328 w
(it.) 680 3328 w
(Otherwise,) 798 3328 w
(it) 1304 3328 w
(works) 1394 3328 w
(like) 1690 3328 w
11 /Courier f
(threadcreate) 1883 3328 w
11 /Times-Roman f
(.) 2675 3328 w
9 /Courier f
(; sig proccreate) 786 3498 w
(int proccreate\(void \(*fn\)\(void*\), void *arg, uint stack\)) 894 3608 w
11 /Times-Roman f
(The) 566 3824 w
(processes) 786 3824 w
(created) 1255 3824 w
(using) 1619 3824 w
(this) 1909 3824 w
(function) 2120 3824 w
(share) 2537 3824 w
(the) 2818 3824 w
(data) 3003 3824 w
(segment) 3236 3824 w
(among) 3653 3824 w
(them.) 4003 3824 w
(Internally,) 566 3944 w
11 /Courier f
(proccreate) 1058 3944 w
11 /Times-Roman f
(calls) 1755 3944 w
11 /Courier f
(rfork\(RFPROC|RFMEM|RFNOWAIT\)) 1993 3944 w
11 /Times-Roman f
(,) 3841 3944 w
(because) 3906 3944 w
(the) 566 4064 w
(thread) 749 4064 w
(library) 1071 4064 w
(keeps) 1412 4064 w
(its) 1710 4064 w
(data) 1864 4064 w
(structures) 2095 4064 w
(in) 2570 4064 w
(the) 2705 4064 w
(data) 2889 4064 w
(segment,) 3121 4064 w
(which) 3565 4064 w
(must) 3883 4064 w
(be) 4148 4064 w
(shared.) 566 4184 w
(In) 913 4184 w
(a) 1038 4184 w
(few) 1120 4184 w
(cases,) 1317 4184 w
(you) 1609 4184 w
(may) 1808 4184 w
(want) 2031 4184 w
(to) 2278 4184 w
(supply) 2398 4184 w
(a) 2726 4184 w
(few) 2808 4184 w
(extra) 3005 4184 w
(flags) 3257 4184 w
(to) 3504 4184 w
11 /Courier f
(rfork) 3623 4184 w
11 /Times-Roman f
(,) 3953 4184 w
(when) 4014 4184 w
(creating) 566 4304 w
(a) 948 4304 w
(process.) 1026 4304 w
(The) 1412 4304 w
(call) 1613 4304 w
11 /Courier f
(procrfork) 1802 4304 w
11 /Times-Roman f
(is) 2427 4304 w
(like) 2532 4304 w
11 /Courier f
(proccreate) 2728 4304 w
11 /Times-Roman f
(,) 3388 4304 w
(but) 3447 4304 w
(accepts) 3619 4304 w
(a) 3971 4304 w
(final) 4050 4304 w
11 /Courier f
(flags) 566 4424 w
11 /Times-Roman f
(argument) 924 4424 w
(that) 1366 4424 w
(is) 1559 4424 w
(or\255ed) 1661 4424 w
(to) 1919 4424 w
(the) 2033 4424 w
(ones) 2195 4424 w
(shown) 2424 4424 w
(above.) 2739 4424 w
9 /Courier f
(; sig procrfork) 786 4594 w
(int procrfork\(void \(*fn\)\(void*\), void *arg, uint stack, int rforkflag\)) 894 4704 w
11 /Times-Roman f
(But) 566 4920 w
(beware,) 763 4920 w
(the) 1142 4920 w
(thread) 1313 4920 w
(library) 1623 4920 w
(uses) 1953 4920 w
11 /Courier f
(rendezvous) 2180 4920 w
11 /Times-Roman f
(in) 2878 4920 w
(its) 3002 4920 w
(implementation.) 3145 4920 w
(Supply\255) 3902 4920 w
(ing) 566 5040 w
(a) 737 5040 w
11 /Courier f
(RFREND) 815 5040 w
11 /Times-Roman f
(flag) 1241 5040 w
(to) 1441 5040 w
11 /Courier f
(procrfork) 1557 5040 w
11 /Times-Roman f
(will) 2180 5040 w
(break) 2381 5040 w
(the) 2652 5040 w
(program.) 2815 5040 w
(Using) 3271 5040 w
11 /Courier f
(proccreate) 3563 5040 w
11 /Times-Roman f
(,) 4223 5040 w
(we) 566 5160 w
(can) 721 5160 w
(make) 900 5160 w
(our) 1165 5160 w
(program) 1339 5160 w
(without) 1738 5160 w
(blocking) 2103 5160 w
(all) 2516 5160 w
(the) 2654 5160 w
(threads) 2816 5160 w
(while) 3160 5160 w
(doing) 3432 5160 w
(I/O.) 3711 5160 w
cleartomark
showpage
saveobj restore
%%EndPage: 20 20
%%Page: 21 21
/saveobj save def
mark
21 pagesetup
11 /Times-Roman f
(\255 21 \255) 2289 413 w
9 /S f
(\347) 566 676 w
9 /Times-Bold f
(tticker.c) 581 676 w
9 /S f
(\347) 914 676 w
(`) 566 676 w
(```````) 599 676 w
(_) 566 676 w
(_______) 599 676 w
8 /Courier f
(#include <u.h>) 786 784 w
(#include <libc.h>) 786 892 w
(#include <bio.h>) 786 1000 w
(#include <thread.h>) 786 1108 w
(enum { Npanels = 2 };) 786 1324 w
(Channel*bcastc;) 786 1432 w
(// of char*) 2226 1432 w
(Channel*panelc[Npanels];) 786 1540 w
(// of char*) 2226 1540 w
(typedef struct PArg PArg;) 786 1864 w
(struct PArg {) 786 1972 w
(Channel* c;) 1266 2080 w
(// to get new messages from) 2226 2080 w
(int) 1266 2188 w
(fd;) 1746 2188 w
(// to the panel's file.) 2226 2188 w
(};) 786 2296 w
(void) 786 2512 w
(consreadthread\(void*\)) 786 2620 w
({) 786 2728 w
(Biobuf) 1266 2836 w
(bin;) 1746 2836 w
(char*) 1266 2944 w
(ln;) 1746 2944 w
(threadsetname\("consread"\);) 1266 3160 w
(Binit\(&bin, 0, OREAD\);) 1266 3268 w
(while \(ln = Brdstr\(&bin, '\\n', 0\)\)) 1266 3376 w
(sendp\(bcastc, ln\);) 1746 3484 w
(sendp\(bcastc, nil\);) 1266 3592 w
(Bterm\(&bin\);) 1266 3700 w
(threadexits\(nil\);) 1266 3808 w
(}) 786 3916 w
(void) 786 4132 w
(bcastthread\(void*\)) 786 4240 w
({) 786 4348 w
(char*) 1266 4456 w
(msg;) 1746 4456 w
(int) 1266 4564 w
(i;) 1746 4564 w
(threadsetname\("bcast"\);) 1266 4780 w
(do {) 1266 4888 w
(msg = recvp\(bcastc\);) 1746 4996 w
(for \(i = 0; i < Npanels; i++\)) 1746 5104 w
(if \(msg != nil\)) 2226 5212 w
(sendp\(panelc[i], strdup\(msg\)\);) 2706 5320 w
(else) 2226 5428 w
(sendp\(panelc[i], nil\);) 2706 5536 w
(free\(msg\);) 1746 5644 w
(} while\(msg != nil\);) 1266 5752 w
(threadexits\(nil\);) 1266 5860 w
(}) 786 5968 w
(void) 786 6184 w
(panelthread\(void* a\)) 786 6292 w
cleartomark
showpage
saveobj restore
%%EndPage: 21 21
%%Page: 22 22
/saveobj save def
mark
22 pagesetup
11 /Times-Roman f
(\255 22 \255) 2289 413 w
8 /Courier f
({) 786 674 w
(PArg*) 1266 782 w
(arg = a;) 1746 782 w
(char*) 1266 890 w
(msg;) 1746 890 w
(threadsetname\("panel"\);) 1266 1106 w
(while\(msg = recvp\(arg\255>c\)\){) 1266 1214 w
(write\(arg\255>fd, msg, strlen\(msg\)\);) 1746 1322 w
(free\(msg\);) 1746 1430 w
(}) 1266 1538 w
(threadexits\(nil\);) 1266 1646 w
(}) 786 1754 w
(void) 786 1970 w
(threadmain\(int, char*[]\)) 786 2078 w
({) 786 2186 w
(int) 1266 2294 w
(i;) 1746 2294 w
(PArg*) 1266 2402 w
(arg;) 1746 2402 w
(bcastc = chancreate\(sizeof\(char*\), 0\);) 1266 2618 w
(proccreate\(consreadthread, nil, 16*1024\);) 1266 2726 w
(for \(i = 0; i < Npanels; i++\){) 1266 2834 w
(panelc[i] = chancreate\(sizeof\(char*\), 0\);) 1746 2942 w
(arg = malloc\(sizeof\(*arg\)\);) 1746 3050 w
(arg\255>c = panelc[i];) 1746 3158 w
(arg\255>fd = 1;) 1746 3266 w
(// to test the program.) 3186 3266 w
(proccreate\(panelthread, arg, 8*1024\);) 1746 3374 w
(}) 1266 3482 w
(// The current thread used for bcast.) 1266 3590 w
(bcastthread\(nil\);) 1266 3698 w
(}) 786 3806 w
11 /Times-Roman f
(The) 566 4022 w
(process) 789 4022 w
(structure) 1170 4022 w
(is) 1606 4022 w
(shown) 1733 4022 w
(in) 2073 4022 w
(figure) 2212 4022 w
([[!process) 2526 4022 w
(structure) 3016 4022 w
(threads) 3453 4022 w
(airport!]],) 3823 4022 w
(which) 566 4142 w
(represents) 873 4142 w
(each) 1355 4142 w
(separate) 1593 4142 w
(process) 1989 4142 w
(with) 2356 4142 w
(a) 2591 4142 w
(dashed) 2678 4142 w
(box) 3021 4142 w
(and) 3225 4142 w
(each) 3421 4142 w
(thread) 3658 4142 w
(with) 3969 4142 w
(a) 4203 4142 w
(circle.) 566 4262 w
(This) 893 4262 w
(time,) 1118 4262 w
(we) 1371 4262 w
(ended) 1527 4262 w
(with) 1817 4262 w
(a) 2042 4262 w
(single) 2119 4262 w
(thread) 2411 4262 w
(within) 2713 4262 w
(each) 3024 4262 w
(process.) 3252 4262 w
(But) 3637 4262 w
(usually,) 3827 4262 w
(a) 4203 4262 w
(central) 566 4382 w
(process) 894 4382 w
(has) 1252 4382 w
(multiple) 1428 4382 w
(threads) 1826 4382 w
(to) 2172 4382 w
(do) 2288 4382 w
(the) 2428 4382 w
(actual) 2592 4382 w
(work,) 2883 4382 w
(and) 3166 4382 w
(there) 3354 4382 w
(are) 3602 4382 w
(some) 3764 4382 w
(other) 4026 4382 w
(processes) 566 4502 w
(created) 1013 4502 w
(just) 1355 4502 w
(for) 1543 4502 w
(doing) 1698 4502 w
(I/O) 1977 4502 w
(without) 2151 4502 w
(blocking) 2516 4502 w
(all) 2929 4502 w
(the) 3067 4502 w
(threads.) 3229 4502 w
cleartomark
showpage
saveobj restore
%%EndPage: 22 22
%%Page: 23 23
/saveobj save def
mark
23 pagesetup
11 /Times-Roman f
(\255 23 \255) 2289 413 w
664 1629 400 400 De
9 /Courier f
(consread) 649 1647 w
1065 1629 1350 1629 Dl
1293 1642 1349 1628 Dl
1292 1638 1350 1629 Dl
1292 1633 1351 1628 Dl
1292 1629 1351 1629 Dl
1292 1624 1351 1629 Dl
1292 1619 1350 1628 Dl
1293 1614 1349 1628 Dl
1351 1686 1351 1572 Dl
1351 1571 1922 1571 Dl
1922 1571 1922 1685 Dl
1922 1686 1351 1686 Dl
(bcastc) 1474 1647 w
1922 1629 2207 1629 Dl
2150 1642 2206 1628 Dl
2150 1638 2208 1629 Dl
2149 1633 2208 1628 Dl
2148 1629 2207 1629 Dl
2149 1624 2208 1629 Dl
2150 1619 2208 1628 Dl
2150 1614 2206 1628 Dl
2207 1629 400 400 De
(bcast) 2273 1647 w
2608 1629 2893 1629 Dl
2836 1642 2892 1628 Dl
2835 1638 2893 1629 Dl
2834 1633 2893 1628 Dl
2834 1629 2893 1629 Dl
2834 1624 2893 1629 Dl
2835 1619 2893 1628 Dl
2836 1614 2892 1628 Dl
2894 1000 2894 886 Dl
2894 886 3465 886 Dl
3464 886 3464 1000 Dl
3464 1000 2893 1000 Dl
(panelc[0]) 2936 961 w
3464 943 3749 943 Dl
3693 957 3749 943 Dl
3692 952 3750 943 Dl
3692 948 3751 943 Dl
3691 943 3750 943 Dl
3692 938 3751 943 Dl
3692 933 3750 942 Dl
3693 928 3749 942 Dl
3750 943 400 400 De
(panel) 3815 961 w
(...) 3441 1303 w
2894 1686 2894 1572 Dl
2894 1571 3465 1571 Dl
3464 1571 3464 1685 Dl
3464 1686 2893 1686 Dl
(panelc[i]) 2936 1647 w
3464 1629 3749 1629 Dl
3693 1642 3749 1628 Dl
3692 1638 3750 1629 Dl
3692 1633 3751 1628 Dl
3691 1629 3750 1629 Dl
3692 1624 3751 1629 Dl
3692 1619 3750 1628 Dl
3693 1614 3749 1628 Dl
3750 1629 400 400 De
(panel) 3815 1647 w
(...) 3441 1989 w
2894 2371 2894 2257 Dl
2894 2257 3465 2257 Dl
3464 2257 3464 2371 Dl
3464 2371 2893 2371 Dl
(panelc[n]) 2936 2332 w
3464 2314 3749 2314 Dl
3693 2329 3749 2315 Dl
3692 2324 3750 2315 Dl
3692 2319 3751 2314 Dl
3691 2314 3750 2314 Dl
3692 2309 3751 2314 Dl
3692 2305 3750 2314 Dl
3693 2300 3749 2314 Dl
3750 2314 400 400 De
(panel) 3815 2332 w
2549 1487 2893 943 Dl
2875 999 2893 943 Dl
2870 997 2893 943 Dl
2866 995 2893 944 Dl
2862 992 2893 943 Dl
2858 989 2893 943 Dl
2854 986 2892 943 Dl
2850 984 2892 944 Dl
2549 1770 2893 2314 Dl
2850 2273 2892 2313 Dl
2854 2270 2892 2313 Dl
2858 2267 2893 2313 Dl
2862 2264 2893 2313 Dl
2866 2262 2893 2313 Dl
2870 2260 2893 2314 Dl
2875 2258 2893 2314 Dl
608 1886 636 1886 Dl
668 1886 696 1886 Dl
729 1886 757 1886 Dl
790 1886 818 1886 Dl
850 1886 878 1886 Dl
911 1886 939 1886 Dl
972 1886 1000 1886 Dl
1032 1886 1060 1886 Dl
1094 1886 1122 1886 Dl
1122 1886 1122 1858 Dl
1122 1825 1122 1797 Dl
1122 1764 1122 1736 Dl
1122 1704 1122 1676 Dl
1122 1642 1122 1614 Dl
1122 1582 1122 1554 Dl
1122 1521 1122 1493 Dl
1122 1460 1122 1432 Dl
1122 1400 1122 1372 Dl
1122 1371 1094 1371 Dl
1061 1371 1033 1371 Dl
1001 1371 973 1371 Dl
939 1371 911 1371 Dl
879 1371 851 1371 Dl
818 1371 790 1371 Dl
757 1371 729 1371 Dl
697 1371 669 1371 Dl
636 1371 608 1371 Dl
608 1371 608 1399 Dl
608 1432 608 1460 Dl
608 1493 608 1521 Dl
608 1553 608 1581 Dl
608 1614 608 1642 Dl
608 1675 608 1703 Dl
608 1735 608 1763 Dl
608 1796 608 1824 Dl
608 1857 608 1885 Dl
2150 1886 2178 1886 Dl
2211 1886 2239 1886 Dl
2272 1886 2300 1886 Dl
2333 1886 2361 1886 Dl
2393 1886 2421 1886 Dl
2454 1886 2482 1886 Dl
2515 1886 2543 1886 Dl
2575 1886 2603 1886 Dl
2636 1886 2664 1886 Dl
2665 1886 2665 1858 Dl
2665 1825 2665 1797 Dl
2665 1764 2665 1736 Dl
2665 1704 2665 1676 Dl
2665 1642 2665 1614 Dl
2665 1582 2665 1554 Dl
2665 1521 2665 1493 Dl
2665 1460 2665 1432 Dl
2665 1400 2665 1372 Dl
2665 1371 2637 1371 Dl
2604 1371 2576 1371 Dl
2543 1371 2515 1371 Dl
2482 1371 2454 1371 Dl
2422 1371 2394 1371 Dl
2361 1371 2333 1371 Dl
2300 1371 2272 1371 Dl
2240 1371 2212 1371 Dl
2179 1371 2151 1371 Dl
2150 1371 2150 1399 Dl
2150 1432 2150 1460 Dl
2150 1493 2150 1521 Dl
2150 1553 2150 1581 Dl
2150 1614 2150 1642 Dl
2150 1675 2150 1703 Dl
2150 1735 2150 1763 Dl
2150 1796 2150 1824 Dl
2150 1857 2150 1885 Dl
3693 1200 3721 1200 Dl
3754 1200 3782 1200 Dl
3814 1200 3842 1200 Dl
3876 1200 3904 1200 Dl
3936 1200 3964 1200 Dl
3997 1200 4025 1200 Dl
4058 1200 4086 1200 Dl
4118 1200 4146 1200 Dl
4179 1200 4207 1200 Dl
4208 1200 4208 1172 Dl
4208 1139 4208 1111 Dl
4208 1079 4208 1051 Dl
4208 1017 4208 989 Dl
4208 957 4208 929 Dl
4208 896 4208 868 Dl
4208 835 4208 807 Dl
4208 775 4208 747 Dl
4208 714 4208 686 Dl
4208 686 4180 686 Dl
4147 686 4119 686 Dl
4086 686 4058 686 Dl
4025 686 3997 686 Dl
3965 686 3937 686 Dl
3904 686 3876 686 Dl
3843 686 3815 686 Dl
3783 686 3755 686 Dl
3722 686 3694 686 Dl
3693 686 3693 714 Dl
3693 746 3693 774 Dl
3693 807 3693 835 Dl
3693 868 3693 896 Dl
3693 928 3693 956 Dl
3693 989 3693 1017 Dl
3693 1050 3693 1078 Dl
3693 1110 3693 1138 Dl
3693 1172 3693 1200 Dl
3693 1886 3721 1886 Dl
3754 1886 3782 1886 Dl
3814 1886 3842 1886 Dl
3876 1886 3904 1886 Dl
3936 1886 3964 1886 Dl
3997 1886 4025 1886 Dl
4058 1886 4086 1886 Dl
4118 1886 4146 1886 Dl
4179 1886 4207 1886 Dl
4208 1886 4208 1858 Dl
4208 1825 4208 1797 Dl
4208 1764 4208 1736 Dl
4208 1704 4208 1676 Dl
4208 1642 4208 1614 Dl
4208 1582 4208 1554 Dl
4208 1521 4208 1493 Dl
4208 1460 4208 1432 Dl
4208 1400 4208 1372 Dl
4208 1371 4180 1371 Dl
4147 1371 4119 1371 Dl
4086 1371 4058 1371 Dl
4025 1371 3997 1371 Dl
3965 1371 3937 1371 Dl
3904 1371 3876 1371 Dl
3843 1371 3815 1371 Dl
3783 1371 3755 1371 Dl
3722 1371 3694 1371 Dl
3693 1371 3693 1399 Dl
3693 1432 3693 1460 Dl
3693 1493 3693 1521 Dl
3693 1553 3693 1581 Dl
3693 1614 3693 1642 Dl
3693 1675 3693 1703 Dl
3693 1735 3693 1763 Dl
3693 1796 3693 1824 Dl
3693 1857 3693 1885 Dl
3693 2571 3721 2571 Dl
3754 2571 3782 2571 Dl
3814 2571 3842 2571 Dl
3876 2571 3904 2571 Dl
3936 2571 3964 2571 Dl
3997 2571 4025 2571 Dl
4058 2571 4086 2571 Dl
4118 2571 4146 2571 Dl
4179 2571 4207 2571 Dl
4208 2571 4208 2543 Dl
4208 2511 4208 2483 Dl
4208 2450 4208 2422 Dl
4208 2389 4208 2361 Dl
4208 2329 4208 2301 Dl
4208 2267 4208 2239 Dl
4208 2207 4208 2179 Dl
4208 2146 4208 2118 Dl
4208 2085 4208 2057 Dl
4208 2057 4180 2057 Dl
4147 2057 4119 2057 Dl
4086 2057 4058 2057 Dl
4025 2057 3997 2057 Dl
3965 2057 3937 2057 Dl
3904 2057 3876 2057 Dl
3843 2057 3815 2057 Dl
3783 2057 3755 2057 Dl
3722 2057 3694 2057 Dl
3693 2057 3693 2085 Dl
3693 2118 3693 2146 Dl
3693 2178 3693 2206 Dl
3693 2239 3693 2267 Dl
3693 2300 3693 2328 Dl
3693 2360 3693 2388 Dl
3693 2421 3693 2449 Dl
3693 2482 3693 2510 Dl
3693 2542 3693 2570 Dl
11 /Times-Roman f
(There) 816 2805 w
(is) 1123 2805 w
(another) 1250 2805 w
(benefit) 1631 2805 w
(that) 1989 2805 w
(arises) 2208 2805 w
(from) 2511 2805 w
(using) 2778 2805 w
(threads) 3071 2805 w
(that) 3441 2805 w
(communicate) 3660 2805 w
(through) 566 2925 w
(channels.) 945 2925 w
(This) 1392 2925 w
(time,) 1624 2925 w
(we) 1884 2925 w
(do) 2047 2925 w
(not) 2193 2925 w
(need) 2370 2925 w
(to) 2612 2925 w
(optimize) 2734 2925 w
(our) 3155 2925 w
(program) 3337 2925 w
(to) 3744 2925 w
(maintain) 3866 2925 w
(the) 566 3045 w
11 /Courier f
(write) 730 3045 w
11 /Times-Roman f
(for) 1090 3045 w
(updating) 1247 3045 w
(the) 1662 3045 w
(panel) 1826 3045 w
(outside) 2093 3045 w
(of) 2441 3045 w
(the) 2562 3045 w
(critical) 2726 3045 w
(region,) 3060 3045 w
(to) 3398 3045 w
(permit) 3514 3045 w
(all) 3831 3045 w
(panels) 3971 3045 w
(to) 566 3165 w
(be) 693 3165 w
(updated) 837 3165 w
(simultaneously.) 1225 3165 w
(All) 1961 3165 w
(panels) 2143 3165 w
(are) 2464 3165 w
(updated) 2637 3165 w
(simultaneously) 3025 3165 w
(in) 3733 3165 w
(a) 3859 3165 w
(natural) 3947 3165 w
(way,) 566 3285 w
(because) 822 3285 w
(each) 1213 3285 w
(one) 1458 3285 w
(uses) 1662 3285 w
(its) 1897 3285 w
(own) 2048 3285 w
(process) 2283 3285 w
(and) 2657 3285 w
(does) 2861 3285 w
(not) 3108 3285 w
(lock) 3296 3285 w
(any) 3532 3285 w
(shared) 3737 3285 w
(data) 4069 3285 w
(structure.) 566 3405 w
(There) 1028 3405 w
(are) 1333 3405 w
(locks) 1516 3405 w
(in) 1799 3405 w
(this) 1936 3405 w
(program,) 2147 3405 w
(but) 2597 3405 w
(they) 2789 3405 w
(are) 3029 3405 w
(hidden) 3212 3405 w
(deep) 3562 3405 w
(under) 3818 3405 w
(the) 4117 3405 w
(implementation) 566 3525 w
(of) 1285 3525 w
11 /Courier f
(send) 1404 3525 w
11 /Times-Roman f
(and) 1696 3525 w
11 /Courier f
(recv) 1882 3525 w
11 /Times-Roman f
(.) 2146 3525 w
16 /Times-Bold f
(11.5.) 566 3885 w
(Many to one communication) 966 3885 w
11 /Times-Roman f
(The) 816 4041 w
(program) 1015 4041 w
(that) 1416 4041 w
(we) 1611 4041 w
(built) 1768 4041 w
(is) 2001 4041 w
(nice.) 2105 4041 w
(But) 2345 4041 w
(it) 2535 4041 w
(would) 2627 4041 w
(be) 2932 4041 w
(nicer) 3065 4041 w
(to) 3313 4041 w
(display) 3429 4041 w
(in) 3777 4041 w
(the) 3893 4041 w
(pan\255) 4057 4041 w
(els,) 566 4161 w
(along) 755 4161 w
(with) 1038 4161 w
(each) 1273 4161 w
(message,) 1511 4161 w
(the) 1949 4161 w
(current) 2122 4161 w
(time) 2470 4161 w
(and) 2704 4161 w
(the) 2900 4161 w
(temperature) 3072 4161 w
(outside) 3632 4161 w
(of) 3988 4161 w
(the) 4117 4161 w
(airport) 566 4281 w
(building.) 886 4281 w
(For) 1310 4281 w
(example,) 1491 4281 w
(if) 1918 4281 w
(the) 2013 4281 w
(operator) 2175 4281 w
(types) 2567 4281 w
(the) 2827 4281 w
(message) 2989 4281 w
10 /Courier f
(AA flight 847 delayed) 786 4451 w
11 /Times-Roman f
(we) 566 4667 w
(would) 721 4667 w
(like) 1024 4667 w
(panels) 1217 4667 w
(to) 1525 4667 w
(show) 1639 4667 w
(the) 1899 4667 w
(message) 2061 4667 w
10 /Courier f
(AA flight 847 delayed \(17:45 32\272C\)) 786 4837 w
11 /Times-Roman f
(We) 566 5053 w
(could) 749 5053 w
(modify) 1025 5053 w
(the) 1375 5053 w
(code) 1541 5053 w
(for) 1779 5053 w
(the) 1938 5053 w
11 /Courier f
(panel) 2104 5053 w
11 /Times-Roman f
(thread) 2466 5053 w
(to) 2771 5053 w
(do) 2889 5053 w
(it.) 3031 5053 w
(But) 3153 5053 w
(it) 3345 5053 w
(would) 3439 5053 w
(not) 3747 5053 w
(be) 3921 5053 w
(very) 4057 5053 w
(appropriate.) 566 5173 w
(A) 1129 5173 w
(panel) 1245 5173 w
(thread) 1519 5173 w
(is) 1829 5173 w
(expected) 1940 5173 w
(to) 2365 5173 w
(write) 2488 5173 w
(messages) 2750 5173 w
(to) 3201 5173 w
(a) 3324 5173 w
(panel,) 3409 5173 w
(and) 3710 5173 w
(to) 3904 5173 w
(write) 4026 5173 w
(them) 566 5293 w
(verbatim.) 817 5293 w
(The) 1266 5293 w
(same) 1467 5293 w
(happens) 1723 5293 w
(to) 2114 5293 w
(other) 2232 5293 w
(threads) 2489 5293 w
(in) 2837 5293 w
(this) 2955 5293 w
(program.) 3147 5293 w
(They) 3578 5293 w
(do) 3835 5293 w
(a) 3977 5293 w
(very) 4057 5293 w
(precise) 566 5413 w
(job) 921 5413 w
(and) 1108 5413 w
(are) 1312 5413 w
(modular) 1490 5413 w
(building) 1902 5413 w
(blocks) 2316 5413 w
(for) 2649 5413 w
(building) 2822 5413 w
(a) 3235 5413 w
(program.) 3328 5413 w
(Instead,) 3800 5413 w
(it) 4189 5413 w
(seems) 566 5533 w
(better) 877 5533 w
(to) 1169 5533 w
(put) 1298 5533 w
(another) 1482 5533 w
(thread) 1853 5533 w
(between) 2169 5533 w
11 /Courier f
(consread) 2576 5533 w
11 /Times-Roman f
(and) 3148 5533 w
11 /Courier f
(bcast) 3350 5533 w
11 /Times-Roman f
(,) 3680 5533 w
(to) 3752 5533 w
(decorate) 3882 5533 w
(messages) 566 5653 w
(with) 1008 5653 w
(the) 1232 5653 w
(time) 1394 5653 w
(and) 1618 5653 w
(the) 1804 5653 w
(temperature.) 1966 5653 w
(We) 2544 5653 w
(call) 2723 5653 w
(this) 2909 5653 w
(new) 3097 5653 w
(thread) 3307 5653 w
11 /Courier f
(decorator) 3608 5653 w
11 /Times-Roman f
(.) 4202 5653 w
(There) 816 5809 w
(is) 1099 5809 w
(still) 1202 5809 w
(the) 1398 5809 w
(problem) 1561 5809 w
(of) 1956 5809 w
(updating) 2076 5809 w
(the) 2490 5809 w
(panels) 2653 5809 w
(when) 2963 5809 w
(either) 3230 5809 w
(the) 3509 5809 w
(time) 3673 5809 w
(changes) 3899 5809 w
(\(the) 566 5929 w
(minute,) 769 5929 w
(indeed\)) 1136 5929 w
(or) 1497 5929 w
(the) 1621 5929 w
(temperature) 1788 5929 w
(changes.) 2343 5929 w
(It) 2755 5929 w
(would) 2854 5929 w
(not) 3161 5929 w
(be) 3334 5929 w
(reasonable) 3469 5929 w
(to) 3968 5929 w
(dis\255) 4086 5929 w
(play) 566 6049 w
(just) 800 6049 w
(the) 1005 6049 w
(time) 1184 6049 w
(and) 1425 6049 w
(temperature) 1628 6049 w
(for) 2195 6049 w
(the) 2367 6049 w
(moment) 2547 6049 w
(when) 2954 6049 w
(the) 3237 6049 w
(operator) 3417 6049 w
(typed) 3827 6049 w
(the) 4117 6049 w
(message) 566 6169 w
(shown.) 965 6169 w
(As) 816 6325 w
(a) 973 6325 w
(result,) 1056 6325 w
(the) 1364 6325 w
(new) 1534 6325 w
11 /Courier f
(decorator) 1752 6325 w
11 /Times-Roman f
(thread) 2382 6325 w
(must) 2691 6325 w
(have) 2942 6325 w
(three) 3184 6325 w
(different) 3438 6325 w
(inputs.) 3850 6325 w
(It) 4184 6325 w
cleartomark
showpage
saveobj restore
%%EndPage: 23 23
%%Page: 24 24
/saveobj save def
mark
24 pagesetup
11 /Times-Roman f
(\255 24 \255) 2289 413 w
(receives) 566 686 w
(messages,) 972 686 w
(but) 1463 686 w
(it) 1653 686 w
(must) 1764 686 w
(also) 2028 686 w
(receive) 2254 686 w
(time) 2617 686 w
(and) 2862 686 w
(temperature) 3069 686 w
(updates.) 3639 686 w
(That) 4050 686 w
(leaves) 566 806 w
(us) 867 806 w
(with) 993 806 w
(the) 1217 806 w
(problem) 1380 806 w
(of) 1775 806 w
(how) 1895 806 w
(do) 2113 806 w
(we) 2252 806 w
(generate) 2408 806 w
(the) 2806 806 w
(two) 2969 806 w
(additional) 3163 806 w
(input) 3632 806 w
(streams.) 3888 806 w
(To) 566 926 w
(follow) 736 926 w
(our) 1071 926 w
(modular) 1265 926 w
(design,) 1679 926 w
(two) 2042 926 w
(new) 2254 926 w
(threads) 2483 926 w
(will) 2846 926 w
(be) 3065 926 w
(in) 3215 926 w
(charge) 3348 926 w
(of) 3685 926 w
(providing) 3823 926 w
(them.) 566 1046 w
(The) 866 1046 w
(resulting) 1089 1046 w
(process) 1527 1046 w
(design) 1908 1046 w
(is) 2248 1046 w
(that) 2375 1046 w
(shown) 2593 1046 w
(in) 2933 1046 w
(figure) 3072 1046 w
([[!enhanced) 3386 1046 w
(airport) 3959 1046 w
(application!]].) 566 1166 w
(And) 1246 1166 w
(the) 1463 1166 w
(code) 1625 1166 w
(of) 1859 1166 w
(the) 1978 1166 w
(whole) 2140 1166 w
(program) 2436 1166 w
(may) 2835 1166 w
(look) 3052 1166 w
(like) 3276 1166 w
(this.) 3469 1166 w
658 1655 352 352 De
7 /Courier f
(timer) 729 1669 w
1010 1655 1161 1655 Dl
1111 1667 1161 1655 Dl
1110 1663 1161 1655 Dl
1109 1659 1160 1655 Dl
1109 1655 1160 1655 Dl
1109 1651 1160 1655 Dl
1110 1646 1161 1654 Dl
1111 1642 1161 1654 Dl
1161 1705 1161 1605 Dl
1161 1605 1413 1605 Dl
1413 1605 1413 1705 Dl
1413 1705 1161 1705 Dl
(timerc) 1161 1669 w
658 2158 352 352 De
(consread) 666 2172 w
1010 2158 1161 2158 Dl
1111 2171 1161 2159 Dl
1110 2167 1161 2159 Dl
1109 2163 1160 2159 Dl
1109 2158 1160 2158 Dl
1109 2154 1160 2158 Dl
1110 2150 1161 2158 Dl
1111 2145 1161 2157 Dl
1161 2209 1161 2109 Dl
1161 2108 1413 2108 Dl
1413 2108 1413 2208 Dl
1413 2209 1161 2209 Dl
(consc) 1182 2172 w
658 2662 352 352 De
(temp) 750 2676 w
1010 2662 1161 2662 Dl
1111 2675 1161 2663 Dl
1110 2670 1161 2662 Dl
1109 2666 1160 2662 Dl
1109 2662 1160 2662 Dl
1109 2657 1160 2661 Dl
1110 2653 1161 2661 Dl
1111 2649 1161 2661 Dl
1161 2712 1161 2612 Dl
1161 2611 1413 2611 Dl
1413 2611 1413 2711 Dl
1413 2712 1161 2712 Dl
(tempc) 1182 2676 w
608 1881 633 1881 Dl
661 1881 686 1881 Dl
715 1881 740 1881 Dl
768 1881 793 1881 Dl
821 1881 846 1881 Dl
875 1881 900 1881 Dl
929 1881 954 1881 Dl
982 1881 1007 1881 Dl
1035 1881 1060 1881 Dl
1060 1881 1060 1856 Dl
1060 1828 1060 1803 Dl
1060 1775 1060 1750 Dl
1060 1721 1060 1696 Dl
1060 1667 1060 1642 Dl
1060 1614 1060 1589 Dl
1060 1560 1060 1535 Dl
1060 1507 1060 1482 Dl
1060 1454 1060 1429 Dl
1060 1428 1035 1428 Dl
1007 1428 982 1428 Dl
954 1428 929 1428 Dl
900 1428 875 1428 Dl
847 1428 822 1428 Dl
793 1428 768 1428 Dl
740 1428 715 1428 Dl
686 1428 661 1428 Dl
633 1428 608 1428 Dl
608 1428 608 1453 Dl
608 1482 608 1507 Dl
608 1535 608 1560 Dl
608 1589 608 1614 Dl
608 1642 608 1667 Dl
608 1695 608 1720 Dl
608 1749 608 1774 Dl
608 1803 608 1828 Dl
608 1856 608 1881 Dl
608 2385 633 2385 Dl
661 2385 686 2385 Dl
715 2385 740 2385 Dl
768 2385 793 2385 Dl
821 2385 846 2385 Dl
875 2385 900 2385 Dl
929 2385 954 2385 Dl
982 2385 1007 2385 Dl
1035 2385 1060 2385 Dl
1060 2385 1060 2360 Dl
1060 2331 1060 2306 Dl
1060 2278 1060 2253 Dl
1060 2225 1060 2200 Dl
1060 2171 1060 2146 Dl
1060 2117 1060 2092 Dl
1060 2064 1060 2039 Dl
1060 2010 1060 1985 Dl
1060 1957 1060 1932 Dl
1060 1932 1035 1932 Dl
1007 1932 982 1932 Dl
954 1932 929 1932 Dl
900 1932 875 1932 Dl
847 1932 822 1932 Dl
793 1932 768 1932 Dl
740 1932 715 1932 Dl
686 1932 661 1932 Dl
633 1932 608 1932 Dl
608 1932 608 1957 Dl
608 1985 608 2010 Dl
608 2039 608 2064 Dl
608 2092 608 2117 Dl
608 2145 608 2170 Dl
608 2199 608 2224 Dl
608 2253 608 2278 Dl
608 2306 608 2331 Dl
608 2360 608 2385 Dl
608 2888 633 2888 Dl
661 2888 686 2888 Dl
715 2888 740 2888 Dl
768 2888 793 2888 Dl
821 2888 846 2888 Dl
875 2888 900 2888 Dl
929 2888 954 2888 Dl
982 2888 1007 2888 Dl
1035 2888 1060 2888 Dl
1060 2888 1060 2863 Dl
1060 2835 1060 2810 Dl
1060 2781 1060 2756 Dl
1060 2728 1060 2703 Dl
1060 2675 1060 2650 Dl
1060 2621 1060 2596 Dl
1060 2567 1060 2542 Dl
1060 2514 1060 2489 Dl
1060 2460 1060 2435 Dl
1060 2435 1035 2435 Dl
1007 2435 982 2435 Dl
954 2435 929 2435 Dl
900 2435 875 2435 Dl
847 2435 822 2435 Dl
793 2435 768 2435 Dl
740 2435 715 2435 Dl
686 2435 661 2435 Dl
633 2435 608 2435 Dl
608 2435 608 2460 Dl
608 2489 608 2514 Dl
608 2542 608 2567 Dl
608 2595 608 2620 Dl
608 2649 608 2674 Dl
608 2703 608 2728 Dl
608 2756 608 2781 Dl
608 2810 608 2835 Dl
608 2863 608 2888 Dl
1413 2158 1665 2158 Dl
1615 2171 1665 2159 Dl
1613 2167 1664 2159 Dl
1613 2163 1664 2159 Dl
1613 2158 1664 2158 Dl
1613 2154 1664 2158 Dl
1613 2150 1664 2158 Dl
1615 2145 1665 2157 Dl
1665 2158 352 352 De
(decorator) 1652 2172 w
2017 2158 2168 2158 Dl
2118 2171 2168 2159 Dl
2117 2167 2168 2159 Dl
2117 2163 2168 2159 Dl
2117 2158 2168 2158 Dl
2117 2154 2168 2158 Dl
2117 2150 2168 2158 Dl
2118 2145 2168 2157 Dl
2168 2209 2168 2109 Dl
2168 2108 2520 2108 Dl
2521 2108 2521 2208 Dl
2521 2209 2169 2209 Dl
(bcastc) 2219 2172 w
2521 2158 2672 2158 Dl
2621 2171 2671 2159 Dl
2621 2167 2672 2159 Dl
2620 2163 2671 2159 Dl
2620 2158 2671 2158 Dl
2620 2154 2671 2158 Dl
2621 2150 2672 2158 Dl
2621 2145 2671 2157 Dl
2672 2158 352 352 De
(bcast) 2743 2172 w
3025 2158 3277 2158 Dl
3225 2171 3275 2159 Dl
3225 2167 3276 2159 Dl
3224 2163 3275 2159 Dl
3224 2158 3275 2158 Dl
3224 2154 3275 2158 Dl
3225 2150 3276 2158 Dl
3225 2145 3275 2157 Dl
3276 1605 3276 1505 Dl
3276 1504 3653 1504 Dl
3654 1504 3654 1604 Dl
3654 1605 3277 1605 Dl
(panelc[0]) 3276 1568 w
3654 1554 3805 1554 Dl
3755 1567 3805 1555 Dl
3753 1562 3804 1554 Dl
3753 1559 3804 1555 Dl
3752 1554 3803 1554 Dl
3753 1550 3804 1554 Dl
3753 1546 3804 1554 Dl
3755 1541 3805 1553 Dl
3805 1554 352 352 De
(panel) 3876 1568 w
(...) 3653 1870 w
3276 2209 3276 2109 Dl
3276 2108 3653 2108 Dl
3654 2108 3654 2208 Dl
3654 2209 3277 2209 Dl
(panelc[i]) 3276 2172 w
3654 2158 3805 2158 Dl
3755 2171 3805 2159 Dl
3753 2167 3804 2159 Dl
3753 2163 3804 2159 Dl
3752 2158 3803 2158 Dl
3753 2154 3804 2158 Dl
3753 2150 3804 2158 Dl
3755 2145 3805 2157 Dl
3805 2158 352 352 De
(panel) 3876 2172 w
(...) 3653 2474 w
3276 2813 3276 2713 Dl
3276 2712 3653 2712 Dl
3654 2712 3654 2812 Dl
3654 2813 3277 2813 Dl
(panelc[n]) 3276 2776 w
3654 2762 3805 2762 Dl
3755 2775 3805 2763 Dl
3753 2771 3804 2763 Dl
3753 2767 3804 2763 Dl
3752 2762 3803 2762 Dl
3753 2758 3804 2762 Dl
3753 2754 3804 2762 Dl
3755 2750 3805 2762 Dl
3805 2762 352 352 De
(panel) 3876 2776 w
1413 1655 1716 2033 Dl
1675 2002 1716 2033 Dl
1678 1999 1716 2033 Dl
1681 1996 1716 2033 Dl
1684 1994 1716 2034 Dl
1688 1991 1716 2034 Dl
1691 1988 1716 2033 Dl
1695 1986 1716 2033 Dl
1413 2662 1716 2284 Dl
1695 2330 1716 2283 Dl
1691 2328 1716 2283 Dl
1688 2326 1716 2283 Dl
1684 2323 1716 2283 Dl
1681 2320 1716 2283 Dl
1678 2318 1716 2284 Dl
1675 2315 1716 2284 Dl
2973 2034 3276 1555 Dl
3260 1603 3276 1555 Dl
3256 1602 3276 1555 Dl
3252 1600 3275 1554 Dl
3248 1598 3276 1555 Dl
3245 1595 3275 1554 Dl
3241 1593 3275 1555 Dl
3238 1590 3275 1554 Dl
2973 2283 3276 2762 Dl
3238 2726 3275 2762 Dl
3241 2724 3275 2762 Dl
3245 2721 3275 2762 Dl
3248 2719 3276 2762 Dl
3252 2716 3275 2762 Dl
3256 2715 3276 2762 Dl
3260 2714 3276 2762 Dl
1590 2410 1615 2410 Dl
1641 2410 1666 2410 Dl
1692 2410 1717 2410 Dl
1743 2410 1768 2410 Dl
1794 2410 1819 2410 Dl
1845 2410 1870 2410 Dl
1896 2410 1921 2410 Dl
1948 2410 1973 2410 Dl
1999 2410 2024 2410 Dl
2050 2410 2075 2410 Dl
2102 2410 2127 2410 Dl
2153 2410 2178 2410 Dl
2204 2410 2229 2410 Dl
2255 2410 2280 2410 Dl
2307 2410 2332 2410 Dl
2358 2410 2383 2410 Dl
2409 2410 2434 2410 Dl
2460 2410 2485 2410 Dl
2511 2410 2536 2410 Dl
2562 2410 2587 2410 Dl
2613 2410 2638 2410 Dl
2665 2410 2690 2410 Dl
2716 2410 2741 2410 Dl
2768 2410 2793 2410 Dl
2819 2410 2844 2410 Dl
2870 2410 2895 2410 Dl
2921 2410 2946 2410 Dl
2972 2410 2997 2410 Dl
3023 2410 3048 2410 Dl
3075 2410 3100 2410 Dl
3100 2410 3100 2385 Dl
3100 2357 3100 2332 Dl
3100 2304 3100 2279 Dl
3100 2251 3100 2226 Dl
3100 2197 3100 2172 Dl
3100 2144 3100 2119 Dl
3100 2091 3100 2066 Dl
3100 2038 3100 2013 Dl
3100 1985 3100 1960 Dl
3100 1932 3100 1907 Dl
3100 1906 3075 1906 Dl
3048 1906 3023 1906 Dl
2997 1906 2972 1906 Dl
2946 1906 2921 1906 Dl
2895 1906 2870 1906 Dl
2844 1906 2819 1906 Dl
2793 1906 2768 1906 Dl
2742 1906 2717 1906 Dl
2690 1906 2665 1906 Dl
2639 1906 2614 1906 Dl
2588 1906 2563 1906 Dl
2536 1906 2511 1906 Dl
2485 1906 2460 1906 Dl
2434 1906 2409 1906 Dl
2383 1906 2358 1906 Dl
2332 1906 2307 1906 Dl
2280 1906 2255 1906 Dl
2229 1906 2204 1906 Dl
2178 1906 2153 1906 Dl
2127 1906 2102 1906 Dl
2076 1906 2051 1906 Dl
2024 1906 1999 1906 Dl
1973 1906 1948 1906 Dl
1922 1906 1897 1906 Dl
1870 1906 1845 1906 Dl
1819 1906 1794 1906 Dl
1768 1906 1743 1906 Dl
1717 1906 1692 1906 Dl
1666 1906 1641 1906 Dl
1615 1906 1590 1906 Dl
1590 1906 1590 1931 Dl
1590 1960 1590 1985 Dl
1590 2013 1590 2038 Dl
1590 2066 1590 2091 Dl
1590 2119 1590 2144 Dl
1590 2172 1590 2197 Dl
1590 2225 1590 2250 Dl
1590 2279 1590 2304 Dl
1590 2332 1590 2357 Dl
1590 2385 1590 2410 Dl
3755 1780 3780 1780 Dl
3808 1780 3833 1780 Dl
3861 1780 3886 1780 Dl
3915 1780 3940 1780 Dl
3968 1780 3993 1780 Dl
4022 1780 4047 1780 Dl
4075 1780 4100 1780 Dl
4129 1780 4154 1780 Dl
4182 1780 4207 1780 Dl
4208 1780 4208 1755 Dl
4208 1727 4208 1702 Dl
4208 1674 4208 1649 Dl
4208 1620 4208 1595 Dl
4208 1567 4208 1542 Dl
4208 1513 4208 1488 Dl
4208 1460 4208 1435 Dl
4208 1406 4208 1381 Dl
4208 1353 4208 1328 Dl
4208 1328 4183 1328 Dl
4154 1328 4129 1328 Dl
4100 1328 4075 1328 Dl
4047 1328 4022 1328 Dl
3994 1328 3969 1328 Dl
3940 1328 3915 1328 Dl
3886 1328 3861 1328 Dl
3833 1328 3808 1328 Dl
3780 1328 3755 1328 Dl
3755 1328 3755 1353 Dl
3755 1381 3755 1406 Dl
3755 1435 3755 1460 Dl
3755 1488 3755 1513 Dl
3755 1541 3755 1566 Dl
3755 1595 3755 1620 Dl
3755 1649 3755 1674 Dl
3755 1702 3755 1727 Dl
3755 1755 3755 1780 Dl
3755 2385 3780 2385 Dl
3808 2385 3833 2385 Dl
3861 2385 3886 2385 Dl
3915 2385 3940 2385 Dl
3968 2385 3993 2385 Dl
4022 2385 4047 2385 Dl
4075 2385 4100 2385 Dl
4129 2385 4154 2385 Dl
4182 2385 4207 2385 Dl
4208 2385 4208 2360 Dl
4208 2331 4208 2306 Dl
4208 2278 4208 2253 Dl
4208 2225 4208 2200 Dl
4208 2171 4208 2146 Dl
4208 2117 4208 2092 Dl
4208 2064 4208 2039 Dl
4208 2010 4208 1985 Dl
4208 1957 4208 1932 Dl
4208 1932 4183 1932 Dl
4154 1932 4129 1932 Dl
4100 1932 4075 1932 Dl
4047 1932 4022 1932 Dl
3994 1932 3969 1932 Dl
3940 1932 3915 1932 Dl
3886 1932 3861 1932 Dl
3833 1932 3808 1932 Dl
3780 1932 3755 1932 Dl
3755 1932 3755 1957 Dl
3755 1985 3755 2010 Dl
3755 2039 3755 2064 Dl
3755 2092 3755 2117 Dl
3755 2145 3755 2170 Dl
3755 2199 3755 2224 Dl
3755 2253 3755 2278 Dl
3755 2306 3755 2331 Dl
3755 2360 3755 2385 Dl
3755 2989 3780 2989 Dl
3808 2989 3833 2989 Dl
3861 2989 3886 2989 Dl
3915 2989 3940 2989 Dl
3968 2989 3993 2989 Dl
4022 2989 4047 2989 Dl
4075 2989 4100 2989 Dl
4129 2989 4154 2989 Dl
4182 2989 4207 2989 Dl
4208 2989 4208 2964 Dl
4208 2935 4208 2910 Dl
4208 2882 4208 2857 Dl
4208 2829 4208 2804 Dl
4208 2775 4208 2750 Dl
4208 2721 4208 2696 Dl
4208 2668 4208 2643 Dl
4208 2615 4208 2590 Dl
4208 2561 4208 2536 Dl
4208 2536 4183 2536 Dl
4154 2536 4129 2536 Dl
4100 2536 4075 2536 Dl
4047 2536 4022 2536 Dl
3994 2536 3969 2536 Dl
3940 2536 3915 2536 Dl
3886 2536 3861 2536 Dl
3833 2536 3808 2536 Dl
3780 2536 3755 2536 Dl
3755 2536 3755 2561 Dl
3755 2590 3755 2615 Dl
3755 2643 3755 2668 Dl
3755 2696 3755 2721 Dl
3755 2750 3755 2775 Dl
3755 2804 3755 2829 Dl
3755 2857 3755 2882 Dl
3755 2910 3755 2935 Dl
3755 2964 3755 2989 Dl
cleartomark
showpage
saveobj restore
%%EndPage: 24 24
%%Page: 25 25
/saveobj save def
mark
25 pagesetup
11 /Times-Roman f
(\255 25 \255) 2289 413 w
9 /S f
(\347) 566 676 w
9 /Times-Bold f
(etticker.c) 581 676 w
9 /S f
(\347) 954 676 w
(`) 566 676 w
(````````) 594 676 w
(_) 566 676 w
(________) 594 676 w
8 /Courier f
(#include <u.h>) 786 784 w
(#include <libc.h>) 786 892 w
(#include <bio.h>) 786 1000 w
(#include <thread.h>) 786 1108 w
(enum { Npanels = 2 };) 786 1324 w
(Channel*timerc;) 786 1432 w
(// of char*) 2226 1432 w
(Channel*consc;) 786 1540 w
(// of char*) 2226 1540 w
(Channel*tempc;) 786 1648 w
(// of char*) 2226 1648 w
(Channel*bcastc;) 786 1756 w
(// of char*) 2226 1756 w
(Channel*panelc[Npanels];) 786 1864 w
(// of char*) 2226 1864 w
(typedef struct PArg PArg;) 786 2188 w
(struct PArg {) 786 2296 w
(Channel* c;) 1266 2404 w
(// to get new messages from) 2226 2404 w
(int) 1266 2512 w
(fd;) 1746 2512 w
(// to the panel's file.) 2226 2512 w
(};) 786 2620 w
(void) 786 2836 w
(consreadthread\(void*\)) 786 2944 w
({) 786 3052 w
(Biobuf) 1266 3160 w
(bin;) 1746 3160 w
(char*) 1266 3268 w
(ln;) 1746 3268 w
(threadsetname\("consread"\);) 1266 3484 w
(Binit\(&bin, 0, OREAD\);) 1266 3592 w
(while \(ln = Brdstr\(&bin, '\\n', 1\)\)) 1266 3700 w
(sendp\(consc, ln\);) 1746 3808 w
(sendp\(consc, nil\);) 1266 3916 w
(Bterm\(&bin\);) 1266 4024 w
(threadexits\(nil\);) 1266 4132 w
(}) 786 4240 w
(void) 786 4456 w
(bcastthread\(void*\)) 786 4564 w
({) 786 4672 w
(char*) 1266 4780 w
(msg;) 1746 4780 w
(int) 1266 4888 w
(i;) 1746 4888 w
(threadsetname\("bcast"\);) 1266 5104 w
(do {) 1266 5212 w
(msg = recvp\(bcastc\);) 1746 5320 w
(for \(i = 0; i < Npanels; i++\)) 1746 5428 w
(if \(msg != nil\)) 2226 5536 w
(sendp\(panelc[i], strdup\(msg\)\);) 2322 5644 w
(else) 2226 5752 w
(sendp\(panelc[i], nil\);) 2322 5860 w
(free\(msg\);) 1746 5968 w
(} while\(msg != nil\);) 1266 6076 w
(threadexits\(nil\);) 1266 6184 w
(}) 786 6292 w
cleartomark
showpage
saveobj restore
%%EndPage: 25 25
%%Page: 26 26
/saveobj save def
mark
26 pagesetup
11 /Times-Roman f
(\255 26 \255) 2289 413 w
8 /Courier f
(void) 786 674 w
(panelthread\(void* a\)) 786 782 w
({) 786 890 w
(PArg*) 1266 998 w
(arg = a;) 1746 998 w
(char*) 1266 1106 w
(msg;) 1746 1106 w
(threadsetname\("panel"\);) 1266 1322 w
(while\(msg = recvp\(arg\255>c\)\){) 1266 1430 w
(write\(arg\255>fd, msg, strlen\(msg\)\);) 1746 1538 w
(free\(msg\);) 1746 1646 w
(}) 1266 1754 w
(threadexits\(nil\);) 1266 1862 w
(}) 786 1970 w
(void) 786 2186 w
(timerthread\(void* a\)) 786 2294 w
({) 786 2402 w
(Channel* c = a;) 1266 2510 w
(ulong) 1266 2618 w
(now;) 1746 2618 w
(Tm*) 1266 2726 w
(tm;) 1746 2726 w
(char) 1266 2834 w
(msg[10];) 1746 2834 w
(for\(;;\){) 1266 2942 w
(now = time\(nil\);) 1746 3050 w
(tm = localtime\(now\);) 1746 3158 w
(seprint\(msg, msg+10, "%d:%d", tm\255>hour, tm\255>min\);) 1746 3266 w
(sendp\(c, strdup\(msg\)\);) 1746 3374 w
(sleep\(60 * 1000\);) 1746 3482 w
(}) 1266 3590 w
(}) 786 3698 w
(void) 786 3914 w
(tempthread\(void* a\)) 786 4022 w
({) 786 4130 w
(Channel* c = a;) 1266 4238 w
(char) 1266 4346 w
(temp[10];) 1746 4346 w
(char) 1266 4454 w
(last[10];) 1746 4454 w
(int) 1266 4562 w
(fd, nr;) 1746 4562 w
(last[0] = 0;) 1266 4778 w
(fd = open\("/dev/temp", OREAD\);) 1266 4886 w
(if \(fd < 0\)) 1266 4994 w
(sysfatal\("/dev/temp: %r"\);) 1746 5102 w
(for\(;;\){) 1266 5210 w
(nr = read\(fd, temp, sizeof\(temp\) \255 1\);) 1746 5318 w
(if \(nr <= 0\)) 1746 5426 w
(sysfatal\("can't read temp"\);) 2226 5534 w
(temp[nr] = 0;) 1746 5642 w
(if \(strcmp\(last, temp\) != 0\){) 1746 5750 w
(strcpy\(last, temp\);) 2226 5858 w
(sendp\(c, strdup\(temp\)\);) 2226 5966 w
(}) 1746 6074 w
(sleep\(60 * 1000\);) 1746 6182 w
(}) 1266 6290 w
cleartomark
showpage
saveobj restore
%%EndPage: 26 26
%%Page: 27 27
/saveobj save def
mark
27 pagesetup
11 /Times-Roman f
(\255 27 \255) 2289 413 w
8 /Courier f
(}) 786 674 w
(void) 786 890 w
(decoratorthread\(void*\)) 786 998 w
({) 786 1106 w
(char*) 1266 1214 w
(lcons, *ltimer, * ltemp;) 1746 1214 w
(char*) 1266 1322 w
(consmsg, *timermsg, *tempmsg;) 1746 1322 w
(char*) 1266 1430 w
(msg;) 1746 1430 w
(Alt) 1266 1538 w
(alts[] = {) 1746 1538 w
({ timerc,&timermsg, CHANRCV },) 1746 1646 w
({ consc, &consmsg, CHANRCV },) 1746 1754 w
({ tempc, &tempmsg, CHANRCV },) 1746 1862 w
({ nil,) 1746 1970 w
(nil, CHANEND } };) 2178 1970 w
(lcons = strdup\(""\); ltimer = strdup\(""\); ltemp = strdup\(""\);) 1266 2186 w
(for\(;;\){) 1266 2294 w
(msg = nil;) 1746 2402 w
(switch\(alt\(alts\)\){) 1746 2510 w
(case 0:) 1746 2618 w
(// operation in alts[0] made) 2226 2618 w
(msg = smprint\("%s \(%s %s\)\\n",) 2226 2726 w
(lcons, timermsg, ltemp\);) 2706 2834 w
(free\(ltimer\);) 2226 2942 w
(ltimer = timermsg;) 2226 3050 w
(break;) 2226 3158 w
(case 1:) 1746 3266 w
(// operation in alts[1] made) 2226 3266 w
(msg = smprint\("%s \(%s %s\)\\n",) 2226 3374 w
(consmsg, ltimer, ltemp\);) 2706 3482 w
(free\(lcons\);) 2226 3590 w
(lcons = consmsg;) 2226 3698 w
(break;) 2226 3806 w
(case 2:) 1746 3914 w
(// operation in alts[2] made) 2226 3914 w
(msg = smprint\("%s \(%s %s\)\\n",) 2226 4022 w
(lcons, ltimer, tempmsg\);) 2706 4130 w
(free\(ltemp\);) 2226 4238 w
(ltemp = tempmsg;) 2226 4346 w
(break;) 2226 4454 w
(}) 1746 4562 w
(sendp\(bcastc, msg\);) 1746 4670 w
(}) 1266 4778 w
(}) 786 4886 w
(void) 786 5102 w
(threadmain\(int, char*[]\)) 786 5210 w
({) 786 5318 w
(int) 1266 5426 w
(i;) 1746 5426 w
(PArg*) 1266 5534 w
(arg;) 1746 5534 w
(timerc = chancreate\(sizeof\(char*\), 0\);) 1266 5750 w
(consc = chancreate\(sizeof\(char*\), 0\);) 1266 5858 w
(tempc = chancreate\(sizeof\(char*\), 0\);) 1266 5966 w
(proccreate\(timerthread, timerc, 8*1024\);) 1266 6074 w
(proccreate\(consreadthread, consc, 16*1024\);) 1266 6182 w
(proccreate\(tempthread, tempc, 8*1024\);) 1266 6290 w
cleartomark
showpage
saveobj restore
%%EndPage: 27 27
%%Page: 28 28
/saveobj save def
mark
28 pagesetup
11 /Times-Roman f
(\255 28 \255) 2289 413 w
8 /Courier f
(for \(i = 0; i < Npanels; i++\){) 1266 674 w
(panelc[i] = chancreate\(sizeof\(char*\), 0\);) 1746 782 w
(arg = malloc\(sizeof\(*arg\)\);) 1746 890 w
(arg\255>c = panelc[i];) 1746 998 w
(arg\255>fd = 1;) 1746 1106 w
(// to test the program.) 3186 1106 w
(proccreate\(panelthread, arg, 8*1024\);) 1746 1214 w
(}) 1266 1322 w
(bcastc = chancreate\(sizeof\(char*\), 0\);) 1266 1430 w
(threadcreate\(decoratorthread, nil, 8*1024\);) 1266 1538 w
(bcastthread\(nil\);) 1266 1646 w
(}) 786 1754 w
11 /Times-Roman f
(Sending) 566 1970 w
(time) 958 1970 w
(updates) 1185 1970 w
(is) 1551 1970 w
(simple.) 1656 1970 w
(A) 2009 1970 w
11 /Courier f
(timer) 2120 1970 w
11 /Times-Roman f
(thread) 2482 1970 w
(can) 2787 1970 w
(send) 2970 1970 w
(a) 3203 1970 w
(message) 3283 1970 w
(each) 3686 1970 w
(minute,) 3917 1970 w
(with) 566 2090 w
(a) 813 2090 w
(string) 912 2090 w
(representing) 1213 2090 w
(the) 1804 2090 w
(time) 1988 2090 w
(to) 2234 2090 w
(be) 2370 2090 w
(shown) 2523 2090 w
(in) 2860 2090 w
(the) 2996 2090 w
(panels.) 3180 2090 w
(It) 3538 2090 w
(receives) 3655 2090 w
(as) 4062 2090 w
(a) 4203 2090 w
(parameter) 566 2210 w
(the) 1030 2210 w
(channel) 1192 2210 w
(where) 1560 2210 w
(to) 1854 2210 w
(send) 1968 2210 w
(events) 2197 2210 w
(to.) 2505 2210 w
9 /Courier f
(void) 786 2380 w
(timerthread\(void* a\)) 786 2490 w
({) 786 2600 w
(Channel* c = a;) 1266 2710 w
(ulong) 1266 2820 w
(now;) 1746 2820 w
(Tm*) 1266 2930 w
(tm;) 1746 2930 w
(char) 1266 3040 w
(msg[10];) 1746 3040 w
(for\(;;\){) 1266 3150 w
(now = time\(nil\);) 1746 3260 w
(tm = localtime\(now\);) 1746 3370 w
(snprint\(msg, 10, "%d:%d",tm\255>hour, tm\255>min\);) 1746 3480 w
(sendp\(c, strdup\(msg\)\);) 1746 3590 w
(sleep\(60 * 1000\);) 1746 3700 w
(}) 1266 3810 w
(}) 786 3920 w
11 /Times-Roman f
(The) 566 4136 w
(function) 771 4136 w
11 /Courier f
(localtime) 1172 4136 w
11 /Times-Roman f
(was) 1801 4136 w
(used) 2006 4136 w
(to) 2242 4136 w
(break) 2363 4136 w
(down) 2640 4136 w
(the) 2920 4136 w
(clock) 3090 4136 w
(obtained) 3363 4136 w
(by) 3777 4136 w
(the) 3923 4136 w
(call) 4093 4136 w
(to) 566 4256 w
11 /Courier f
(time) 689 4256 w
11 /Times-Roman f
(into) 990 4256 w
(seconds,) 1199 4256 w
(minutes,) 1611 4256 w
(hours,) 2025 4256 w
(and) 2334 4256 w
(so) 2529 4256 w
(on.) 2664 4256 w
(This) 2839 4256 w
(thread) 3072 4256 w
(does) 3382 4256 w
(not) 3620 4256 w
(generate) 3798 4256 w
(a) 4203 4256 w
(very) 566 4376 w
(precise) 803 4376 w
(clock.) 1155 4376 w
(It) 1463 4376 w
(sends) 1573 4376 w
(the) 1860 4376 w
(time) 2037 4376 w
(once) 2276 4376 w
(per) 2525 4376 w
(minute,) 2707 4376 w
(but) 3084 4376 w
(it) 3269 4376 w
(could) 3375 4376 w
(send) 3663 4376 w
(it) 3908 4376 w
(when) 4014 4376 w
(there) 566 4496 w
(is) 820 4496 w
(only) 930 4496 w
(one) 1162 4496 w
(second) 1356 4496 w
(left) 1696 4496 w
(for) 1878 4496 w
(the) 2041 4496 w
(next) 2211 4496 w
(minute.) 2436 4496 w
(In) 2805 4496 w
(any) 2931 4496 w
(case,) 3124 4496 w
(this) 3374 4496 w
(part) 3569 4496 w
(of) 3774 4496 w
(the) 3900 4496 w
(pro\255) 4069 4496 w
(gram) 566 4616 w
(can) 819 4616 w
(be) 998 4616 w
(refined) 1129 4616 w
(and) 1466 4616 w
(programmed) 1652 4616 w
(independently) 2240 4616 w
(of) 2890 4616 w
(the) 3009 4616 w
(rest) 3171 4616 w
(of) 3357 4616 w
(the) 3476 4616 w
(application.) 3638 4616 w
(To) 816 4772 w
(read) 970 4772 w
(the) 1190 4772 w
(temperature,) 1357 4772 w
(we) 1940 4772 w
(need) 2100 4772 w
(a) 2339 4772 w
(temperature) 2420 4772 w
(metering) 2975 4772 w
(device.) 3398 4772 w
(We) 3744 4772 w
(assume) 3928 4772 w
(that) 566 4892 w
(the) 764 4892 w
(file) 931 4892 w
11 /Courier f
(/dev/temp) 1110 4892 w
11 /Times-Roman f
(gives) 1737 4892 w
(the) 2002 4892 w
(current) 2169 4892 w
(temperature) 2511 4892 w
(as) 3066 4892 w
(a) 3190 4892 w
(string) 3271 4892 w
(each) 3555 4892 w
(time) 3786 4892 w
(when) 4014 4892 w
(read.) 566 5012 w
(To) 868 5012 w
(implement) 1049 5012 w
(the) 1580 5012 w
(thread) 1774 5012 w
11 /Courier f
(temp) 2107 5012 w
11 /Times-Roman f
(,) 2371 5012 w
(we) 2459 5012 w
(measure) 2646 5012 w
(the) 3070 5012 w
(temperature) 3264 5012 w
(once) 3846 5012 w
(per) 4112 5012 w
(minute.) 566 5132 w
(However,) 930 5132 w
(the) 1388 5132 w
(thread) 1551 5132 w
(only) 1853 5132 w
(sends) 2078 5132 w
(a) 2351 5132 w
(temperature) 2428 5132 w
(update) 2979 5132 w
(when) 3300 5132 w
(the) 3566 5132 w
(temperature) 3729 5132 w
(changes) 566 5252 w
(\(and) 953 5252 w
(the) 1183 5252 w
(first) 1353 5252 w
(time) 1566 5252 w
(it) 1798 5252 w
(is) 1896 5252 w
(measured\).) 2006 5252 w
(Once) 2525 5252 w
(more,) 2791 5252 w
(the) 3080 5252 w
(channel) 3250 5252 w
(where) 3626 5252 w
(to) 3928 5252 w
(send) 4050 5252 w
(the) 566 5372 w
(updates) 728 5372 w
(is) 1091 5372 w
(given) 1193 5372 w
(as) 1465 5372 w
(a) 1584 5372 w
(parameter.) 1660 5372 w
cleartomark
showpage
saveobj restore
%%EndPage: 28 28
%%Page: 29 29
/saveobj save def
mark
29 pagesetup
11 /Times-Roman f
(\255 29 \255) 2289 413 w
10 /Courier f
(void) 786 676 w
(tempthread\(void* a\)) 786 786 w
({) 786 896 w
(Channel* c = a;) 1266 1006 w
(char) 1266 1116 w
(temp[10];) 1746 1116 w
(char) 1266 1226 w
(last[10];) 1746 1226 w
(int) 1266 1336 w
(fd, nr;) 1746 1336 w
(last[0] = 0;) 1266 1556 w
(fd = open\("/dev/temp", OREAD\);) 1266 1666 w
(if \(fd < 0\)) 1266 1776 w
(sysfatal\("/dev/temp: %r"\);) 1746 1886 w
(for\(;;\){) 1266 1996 w
(nr = read\(fd, temp, sizeof\(temp\) \255 1\);) 1746 2106 w
(if \(nr <= 0\)) 1746 2216 w
(sysfatal\("can't read temp"\);) 2226 2326 w
(temp[nr] = 0;) 1746 2436 w
(if \(strcmp\(last, temp\) != 0\){) 1746 2546 w
(strcpy\(last, temp\);) 2226 2656 w
(sendp\(c, strdup\(temp\)\);) 2226 2766 w
(}) 1746 2876 w
(sleep\(60 * 1000\);) 1746 2986 w
(}) 1266 3096 w
(}) 786 3206 w
11 /Times-Roman f
(What) 566 3422 w
(remains) 850 3422 w
(to) 1244 3422 w
(be) 1377 3422 w
(done) 1527 3422 w
(is) 1787 3422 w
(to) 1908 3422 w
(implement) 2042 3422 w
(the) 2561 3422 w
11 /Courier f
(decorator) 2743 3422 w
11 /Times-Roman f
(thread.) 3385 3422 w
(This) 3734 3422 w
(thread) 3978 3422 w
(must) 566 3542 w
(receive) 846 3542 w
(alternatively) 1225 3542 w
(from) 1838 3542 w
(one) 2116 3542 w
(of) 2338 3542 w
(three) 2493 3542 w
(channels,) 2775 3542 w
11 /Courier f
(timerc) 3250 3542 w
11 /Times-Roman f
(,) 3646 3542 w
11 /Courier f
(tempc) 3738 3542 w
11 /Times-Roman f
(,) 4068 3542 w
(or) 4160 3542 w
11 /Courier f
(consc) 566 3662 w
11 /Times-Roman f
(.) 896 3662 w
(When) 992 3662 w
(it) 1293 3662 w
(receives) 1395 3662 w
(a) 1792 3662 w
(new) 1880 3662 w
(message) 2102 3662 w
(from) 2513 3662 w
(either) 2766 3662 w
(channel,) 3055 3662 w
(it) 3463 3662 w
(must) 3566 3662 w
(concoct) 3822 3662 w
(a) 4203 3662 w
(new) 566 3782 w
(message) 790 3782 w
(including) 1203 3782 w
(up) 1660 3782 w
(to) 1811 3782 w
(date) 1938 3782 w
(information) 2161 3782 w
(from) 2721 3782 w
(the) 2975 3782 w
(three) 3150 3782 w
(inputs,) 3409 3782 w
(and) 3748 3782 w
(deliver) 3947 3782 w
(the) 566 3902 w
(new) 745 3902 w
(message) 972 3902 w
(through) 1388 3902 w
11 /Courier f
(bcastc) 1775 3902 w
11 /Times-Roman f
(to) 2216 3902 w
(update) 2347 3902 w
(all) 2684 3902 w
(the) 2839 3902 w
(panels.) 3018 3902 w
(Because) 3371 3902 w
(we) 3781 3902 w
(do) 3954 3902 w
(not) 4110 3902 w
(know) 566 4022 w
(in) 848 4022 w
(which) 972 4022 w
(order) 1278 4022 w
(we) 1546 4022 w
(are) 1711 4022 w
(going) 1881 4022 w
(to) 2170 4022 w
(receive) 2294 4022 w
(inputs,) 2646 4022 w
(we) 2982 4022 w
(cannot) 3146 4022 w
(use) 3475 4022 w
11 /Courier f
(recvp) 3658 4022 w
11 /Times-Roman f
(.) 3988 4022 w
(The) 4081 4022 w
(function) 566 4142 w
11 /Courier f
(alt) 976 4142 w
11 /Times-Roman f
(implements) 1218 4142 w
(many\255to\255one) 1776 4142 w
(communication.) 2380 4142 w
(It) 3136 4142 w
(takes) 3247 4142 w
(a) 3516 4142 w
(set) 3608 4142 w
(of) 3775 4142 w
(channel) 3911 4142 w
(operations) 566 4262 w
(\(sends) 1058 4262 w
(or) 1373 4262 w
(receives\)) 1499 4262 w
(and) 1927 4262 w
(blocks) 2120 4262 w
(until) 2442 4262 w
(one) 2679 4262 w
(of) 2871 4262 w
(the) 2996 4262 w
(operations) 3164 4262 w
(may) 3655 4262 w
(proceed.) 3878 4262 w
(At) 566 4382 w
(that) 707 4382 w
(point,) 903 4382 w
(the) 1189 4382 w
(operation) 1354 4382 w
(is) 1799 4382 w
(executed) 1904 4382 w
(and) 2323 4382 w
11 /Courier f
(alt) 2512 4382 w
11 /Times-Roman f
(returns) 2741 4382 w
(informing) 3076 4382 w
(of) 3547 4382 w
(which) 3670 4382 w
(one) 3970 4382 w
(of) 4160 4382 w
(the) 566 4502 w
(channel) 758 4502 w
(operations) 1156 4502 w
(was) 1671 4502 w
(done.) 1899 4502 w
(Before) 2198 4502 w
(discussing) 2553 4502 w
(it,) 3070 4502 w
(it) 3217 4502 w
(is) 3336 4502 w
(easier) 3467 4502 w
(to) 3778 4502 w
(see) 3921 4502 w
(the) 4117 4502 w
11 /Courier f
(decorator) 566 4622 w
11 /Times-Roman f
(thread) 1188 4622 w
(as) 1489 4622 w
(an) 1608 4622 w
(example.) 1739 4622 w
cleartomark
showpage
saveobj restore
%%EndPage: 29 29
%%Page: 30 30
/saveobj save def
mark
30 pagesetup
11 /Times-Roman f
(\255 30 \255) 2289 413 w
9 /Courier f
(void) 786 676 w
(decoratorthread\(void*\)) 786 786 w
({) 786 896 w
(char*) 1266 1006 w
(lcons, *ltimer, * ltemp;) 1746 1006 w
(char*) 1266 1116 w
(consmsg, *timermsg, *tempmsg;) 1746 1116 w
(char*) 1266 1226 w
(msg;) 1746 1226 w
(Alt) 1266 1336 w
(alts[] = {) 1746 1336 w
({ timerc,&timermsg, CHANRCV },) 1746 1446 w
({ consc, &consmsg, CHANRCV },) 1746 1556 w
({ tempc, &tempmsg, CHANRCV },) 1746 1666 w
({ nil,) 1746 1776 w
(nil, CHANEND } };) 2232 1776 w
(lcons = strdup\(""\);) 1266 1996 w
(ltimer = strdup\(""\);) 1266 2106 w
(ltemp = strdup\(""\);) 1266 2216 w
(for\(;;\){) 1266 2326 w
(msg = nil;) 1746 2436 w
(switch\(alt\(alts\)\){) 1746 2546 w
(case 0:) 1746 2656 w
(// operation in alts[0] made) 2226 2656 w
(chanprint\(bcastc, "%s \(%s %s\)\\n",) 2226 2766 w
(lcons, timermsg, ltemp\);) 2706 2876 w
(free\(ltimer\);) 2226 2986 w
(ltimer = timermsg;) 2226 3096 w
(break;) 2226 3206 w
(case 1:) 1746 3316 w
(// operation in alts[1] made) 2226 3316 w
(if \(msg == nil\)) 2226 3426 w
(threadexitsall\("terminated"\);) 2706 3536 w
(chanprint\(bcastc, "%s \(%s %s\)\\n",) 2226 3646 w
(consmsg, ltimer, ltemp\);) 2706 3756 w
(free\(lcons\);) 2226 3866 w
(lcons = consmsg;) 2226 3976 w
(break;) 2226 4086 w
(case 2:) 1746 4196 w
(// operation in alts[2] made) 2226 4196 w
(chanprint\(bcastc, "%s \(%s %s\)\\n",) 2226 4306 w
(lcons, ltimer, tempmsg\);) 2706 4416 w
(free\(ltemp\);) 2226 4526 w
(ltemp = tempmsg;) 2226 4636 w
(break;) 2226 4746 w
(}) 1746 4856 w
(}) 1266 4966 w
(}) 786 5076 w
11 /Times-Roman f
(The) 566 5292 w
(call) 769 5292 w
(to) 960 5292 w
11 /Courier f
(alts) 1079 5292 w
11 /Times-Roman f
(receives) 1376 5292 w
(an) 1766 5292 w
(array) 1902 5292 w
(of) 2158 5292 w
(four) 2282 5292 w
11 /Courier f
(Alt) 2497 5292 w
11 /Times-Roman f
(structures.) 2729 5292 w
(The) 3217 5292 w
(first) 3421 5292 w
(three) 3632 5292 w
(ones) 3884 5292 w
(are) 4119 5292 w
(the) 566 5412 w
(channel) 737 5412 w
(operations) 1114 5412 w
(we) 1608 5412 w
(are) 1772 5412 w
(interested) 1941 5412 w
(in.) 2403 5412 w
(The) 2553 5412 w
(fourth) 2759 5412 w
(entry) 3063 5412 w
(terminates) 3324 5412 w
(the) 3817 5412 w
11 /Courier f
(alts) 3987 5412 w
11 /Times-Roman f
(array,) 566 5532 w
(so) 848 5532 w
(that) 977 5532 w
11 /Courier f
(alt) 1173 5532 w
11 /Times-Roman f
(could) 1402 5532 w
(know) 1678 5532 w
(where) 1954 5532 w
(the) 2252 5532 w
(array) 2418 5532 w
(ends.) 2673 5532 w
(When) 2934 5532 w
(the) 3227 5532 w
(thread) 3393 5532 w
(calls) 3698 5532 w
11 /Courier f
(alt) 3931 5532 w
11 /Times-Roman f
(,) 4129 5532 w
(it) 4189 5532 w
(blocks.) 566 5652 w
(And) 929 5652 w
(it) 1165 5652 w
(remains) 1274 5652 w
(blocked) 1668 5652 w
(until) 2062 5652 w
11 /Times-Italic f
(any) 2312 5652 w
11 /Times-Roman f
(of) 2517 5652 w
(the) 2655 5652 w
(three) 2836 5652 w
(channel) 3101 5652 w
(operations) 3488 5652 w
(repre\255) 3992 5652 w
(sented) 566 5772 w
(by) 874 5772 w
11 /Courier f
(Alt) 1012 5772 w
11 /Times-Roman f
(entries) 1238 5772 w
(in) 1558 5772 w
(the) 1672 5772 w
(array) 1834 5772 w
(may) 2085 5772 w
(be) 2302 5772 w
(performed.) 2433 5772 w
(For) 816 5928 w
(example,) 999 5928 w
(if) 1428 5928 w
(right) 1525 5928 w
(before) 1763 5928 w
(calling) 2071 5928 w
11 /Courier f
(alt) 2400 5928 w
11 /Times-Roman f
(the) 2628 5928 w
(timer) 2793 5928 w
(thread) 3056 5928 w
(sent) 3360 5928 w
(an) 3568 5928 w
(update,) 3702 5928 w
11 /Courier f
(alt) 4053 5928 w
11 /Times-Roman f
(will) 566 6048 w
(immediately) 776 6048 w
(return,) 1364 6048 w
(reporting) 1691 6048 w
(that) 2131 6048 w
(a) 2334 6048 w
(receive) 2420 6048 w
(from) 2771 6048 w
11 /Courier f
(timerc) 3021 6048 w
11 /Times-Roman f
(was) 3454 6048 w
(made.) 3661 6048 w
(In) 3963 6048 w
(this) 4091 6048 w
(case,) 566 6168 w
11 /Courier f
(alt) 812 6168 w
11 /Times-Roman f
(returns) 1041 6168 w
(zero,) 1376 6168 w
(which) 1622 6168 w
(is) 1922 6168 w
(the) 2028 6168 w
(index) 2194 6168 w
(in) 2470 6168 w
(the) 2588 6168 w
11 /Courier f
(alts) 2754 6168 w
11 /Times-Roman f
(array) 3050 6168 w
(for) 3305 6168 w
(the) 3464 6168 w
(operation) 3630 6168 w
(per\255) 4076 6168 w
(formed.) 566 6288 w
(That) 945 6288 w
(is) 1181 6288 w
(how) 1290 6288 w
(we) 1514 6288 w
(know) 1676 6288 w
(which) 1955 6288 w
(operation) 2258 6288 w
(was) 2707 6288 w
(made,) 2912 6288 w
(its) 3212 6288 w
(index) 3352 6288 w
(in) 3631 6288 w
(the) 3752 6288 w
(array) 3920 6288 w
(is) 4177 6288 w
cleartomark
showpage
saveobj restore
%%EndPage: 30 30
%%Page: 31 31
/saveobj save def
mark
31 pagesetup
11 /Times-Roman f
(\255 31 \255) 2289 413 w
(the) 566 686 w
(return) 728 686 w
(value) 1017 686 w
(from) 1282 686 w
11 /Courier f
(alt) 1523 686 w
11 /Times-Roman f
(.) 1721 686 w
(Each) 816 842 w
11 /Courier f
(Alt) 1071 842 w
11 /Times-Roman f
(entry) 1306 842 w
(in) 1568 842 w
(the) 1691 842 w
(array) 1862 842 w
(is) 2123 842 w
(initialized) 2235 842 w
(with) 2713 842 w
(the) 2947 842 w
(channel) 3119 842 w
(where) 3497 842 w
(the) 3801 842 w
(opera\255) 3973 842 w
(tion) 566 962 w
(is) 768 962 w
(to) 872 962 w
(be) 988 962 w
(performed,) 1121 962 w
(a) 1634 962 w
(constant) 1712 962 w
(that) 2108 962 w
(can) 2303 962 w
(be) 2484 962 w
11 /Courier f
(CHANRCV) 2617 962 w
11 /Times-Roman f
(or) 3109 962 w
11 /Courier f
(CHANSEND) 3230 962 w
11 /Times-Roman f
(to) 3788 962 w
(indicate) 3904 962 w
(that) 566 1082 w
(we) 760 1082 w
(want) 916 1082 w
(to) 1158 1082 w
(receive) 1273 1082 w
(or) 1616 1082 w
(send) 1736 1082 w
(in) 1966 1082 w
(that) 2081 1082 w
(channel,) 2275 1082 w
(and) 2672 1082 w
(a) 2860 1082 w
(pointer) 2938 1082 w
(to) 3279 1082 w
(the) 3395 1082 w
(message) 3559 1082 w
(for) 3960 1082 w
(the) 4117 1082 w
(operation.) 566 1202 w
(The) 1044 1202 w
(constant) 1250 1202 w
11 /Courier f
(CHANEND) 1652 1202 w
11 /Times-Roman f
(is) 2150 1202 w
(used) 2260 1202 w
(as) 2497 1202 w
(the) 2624 1202 w
(operation) 2794 1202 w
(to) 3244 1202 w
(mark) 3366 1202 w
(the) 3627 1202 w
(end) 3797 1202 w
(of) 3991 1202 w
(the) 4117 1202 w
(array,) 566 1322 w
(as) 852 1322 w
(seen) 978 1322 w
(above.) 1207 1322 w
(To) 1531 1322 w
(say) 1688 1322 w
(it) 1869 1322 w
(in) 1966 1322 w
(another) 2087 1322 w
(way,) 2450 1322 w
(the) 2696 1322 w
(call) 2866 1322 w
(to) 3060 1322 w
11 /Courier f
(alt) 3182 1322 w
11 /Times-Roman f
(above) 3416 1322 w
(is) 3713 1322 w
(similar) 3823 1322 w
(to) 4165 1322 w
(doing) 566 1442 w
11 /Times-Italic f
(any) 845 1442 w
(of) 1031 1442 w
11 /Times-Roman f
(the) 1145 1442 w
(following) 1307 1442 w
10 /Courier f
(recv\(timerc, &timermsg\);) 786 1612 w
(recv\(consc, &consmsg\);) 786 1722 w
(recv\(tempc, &tempmsg\);) 786 1832 w
11 /Times-Roman f
(But) 566 2048 w
11 /Courier f
(alt) 770 2048 w
11 /Times-Roman f
(works) 1012 2048 w
(without) 1325 2048 w
(requiring) 1707 2048 w
(a) 2154 2048 w
(precise) 2247 2048 w
(order) 2601 2048 w
(on) 2876 2048 w
(those) 3031 2048 w
(operations.) 3308 2048 w
(That) 3838 2048 w
(is) 4084 2048 w
(a) 4203 2048 w
(good) 566 2168 w
(thing,) 840 2168 w
(because) 1149 2168 w
(we) 1548 2168 w
(do) 1729 2168 w
(not) 1893 2168 w
(know) 2088 2168 w
(in) 2386 2168 w
(which) 2525 2168 w
(order) 2846 2168 w
(we) 3129 2168 w
(are) 3309 2168 w
(going) 3494 2168 w
(to) 3798 2168 w
(receive) 3937 2168 w
(updates.) 566 2288 w
(We) 987 2288 w
(do) 1168 2288 w
(not) 1309 2288 w
(know) 1481 2288 w
(which) 1756 2288 w
(particular) 2055 2288 w
(channel) 2505 2288 w
(operation) 2876 2288 w
(is) 3321 2288 w
(going) 3426 2288 w
(to) 3708 2288 w
(be) 3825 2288 w
(picked) 3959 2288 w
(up) 566 2408 w
(by) 723 2408 w
11 /Courier f
(alt) 880 2408 w
11 /Times-Roman f
(if) 1125 2408 w
(more) 1239 2408 w
(than) 1511 2408 w
(one) 1747 2408 w
(can) 1952 2408 w
(be) 2150 2408 w
(performed.) 2299 2408 w
(But) 2828 2408 w
(we) 3034 2408 w
(know) 3207 2408 w
(that) 3497 2408 w
11 /Courier f
(alt) 3708 2408 w
11 /Times-Roman f
(is) 3952 2408 w
(fair.) 4072 2408 w
(Adding) 566 2528 w
(a) 932 2528 w
(loop) 1016 2528 w
(around) 1249 2528 w
11 /Courier f
(alt) 1590 2528 w
11 /Times-Roman f
(guarantees) 1825 2528 w
(that) 2329 2528 w
(all) 2531 2528 w
(the) 2678 2528 w
(channel) 2849 2528 w
(operations) 3226 2528 w
(that) 3720 2528 w
(may) 3922 2528 w
(be) 4148 2528 w
(performed) 566 2648 w
(will) 1049 2648 w
(be) 1249 2648 w
(performed) 1380 2648 w
(without) 1863 2648 w
(starvation) 2228 2648 w
(for) 2689 2648 w
(any) 2844 2648 w
(channel.) 3030 2648 w
(Now) 816 2804 w
(that) 1062 2804 w
11 /Courier f
(alt) 1260 2804 w
11 /Times-Roman f
(is) 1491 2804 w
(not) 1599 2804 w
(a) 1774 2804 w
(mystery,) 1856 2804 w
(we) 2272 2804 w
(should) 2433 2804 w
(mention) 2761 2804 w
(some) 3156 2804 w
(things) 3422 2804 w
(done) 3726 2804 w
(by) 3973 2804 w
(the) 4117 2804 w
11 /Courier f
(decorator) 566 2924 w
11 /Times-Roman f
(thread.) 1222 2924 w
(This) 1585 2924 w
(thread) 1843 2924 w
(uses) 2178 2924 w
11 /Courier f
(chanprint) 2429 2924 w
11 /Times-Roman f
(to) 3085 2924 w
(send) 3233 2924 w
(messages) 3495 2924 w
(to) 3970 2924 w
(the) 4117 2924 w
11 /Courier f
(bcast) 566 3044 w
11 /Times-Roman f
(channel.) 896 3044 w
(A) 1321 3044 w
(call) 1429 3044 w
(to) 1616 3044 w
11 /Courier f
(chanprint) 1731 3044 w
11 /Times-Roman f
(is) 2354 3044 w
(similar) 2457 3044 w
(to) 2792 3044 w
(calling) 2907 3044 w
11 /Courier f
(smprint) 3235 3044 w
11 /Times-Roman f
(\(to) 3727 3044 w
(print) 3879 3044 w
(the) 4117 3044 w
(arguments) 566 3164 w
(in) 1052 3164 w
(a) 1167 3164 w
(string) 1244 3164 w
(allocated) 1524 3164 w
(in) 1948 3164 w
(dynamic) 2063 3164 w
(memory\),) 2470 3164 w
(and) 2929 3164 w
(then) 3116 3164 w
(sending) 3334 3164 w
(the) 3704 3164 w
(resulting) 3866 3164 w
(string) 566 3284 w
(through) 845 3284 w
(the) 1215 3284 w
(channel.) 1377 3284 w
(This) 1773 3284 w
(function) 1997 3284 w
(is) 2391 3284 w
(very) 2493 3284 w
(convenient) 2715 3284 w
(in) 3224 3284 w
(many) 3338 3284 w
(cases.) 3610 3284 w
(At) 816 3440 w
(any) 992 3440 w
(time,) 1216 3440 w
(the) 1506 3440 w
(operator) 1706 3440 w
(might) 2137 3440 w
(send) 2462 3440 w
(an) 2730 3440 w
(end\255of\255file) 2900 3440 w
(indication,) 3434 3440 w
(typing) 3969 3440 w
11 /Times-Italic f
(control\255d) 566 3560 w
11 /Times-Roman f
(.) 975 3560 w
(When) 1106 3560 w
(the) 1442 3560 w
11 /Courier f
(decorator) 1650 3560 w
11 /Times-Roman f
(thread) 2318 3560 w
(receives) 2665 3560 w
(a) 3096 3560 w
(nil) 3218 3560 w
(message) 3409 3560 w
(\(sent) 3854 3560 w
(by) 4141 3560 w
11 /Courier f
(consthread) 566 3680 w
11 /Times-Roman f
(upon) 1259 3680 w
(EOF\),) 1513 3680 w
(it) 1819 3680 w
(calls) 1915 3680 w
11 /Courier f
(threadexitsall) 2150 3680 w
11 /Times-Roman f
(.) 3074 3680 w
(This) 3164 3680 w
(function) 3394 3680 w
(terminates) 3794 3680 w
(all) 566 3800 w
(the) 704 3800 w
(processes) 866 3800 w
(and) 1313 3800 w
(threads) 1499 3800 w
(of) 1843 3800 w
(the) 1962 3800 w
(program,) 2124 3800 w
(terminating) 2551 3800 w
(it.) 3086 3800 w
16 /Times-Bold f
(11.6.) 566 4160 w
(Other calls) 966 4160 w
11 /Times-Roman f
(In) 566 4316 w
(general,) 685 4316 w
(it) 1062 4316 w
(is) 1152 4316 w
(safe) 1254 4316 w
(to) 1457 4316 w
(use) 1571 4316 w
(whatever) 1745 4316 w
(functions) 2174 4316 w
(from) 2612 4316 w
(the) 2854 4316 w
(C) 3017 4316 w
(library) 3120 4316 w
(\(or) 3441 4316 w
(from) 3597 4316 w
(any) 3839 4316 w
(other) 4026 4316 w
(one\)) 566 4436 w
(in) 796 4436 w
(a) 918 4436 w
(program) 1002 4436 w
(using) 1409 4436 w
(the) 1684 4436 w
(thread) 1854 4436 w
(library.) 2163 4436 w
(We) 2519 4436 w
(have) 2706 4436 w
(done) 2948 4436 w
(so) 3197 4436 w
(through) 3330 4436 w
(this) 3707 4436 w
(chapter.) 3902 4436 w
(Function) 566 4556 w
(libraries) 987 4556 w
(try) 1375 4556 w
(not) 1526 4556 w
(to) 1696 4556 w
(use) 1811 4556 w
(global) 1986 4556 w
(variables,) 2290 4556 w
(and) 2742 4556 w
(when) 2929 4556 w
(they) 3195 4556 w
(do,) 3414 4556 w
(they) 3582 4556 w
(try) 3801 4556 w
(to) 3953 4556 w
(pro\255) 4069 4556 w
(tect) 566 4676 w
(from) 765 4676 w
(races) 1019 4676 w
(so) 1283 4676 w
(that) 1422 4676 w
(you) 1628 4676 w
(could) 1834 4676 w
(call) 2119 4676 w
(them) 2318 4676 w
(from) 2579 4676 w
(a) 2833 4676 w
(concurrent) 2921 4676 w
(program.) 3428 4676 w
(In) 3895 4676 w
(other) 4026 4676 w
(systems,) 566 4796 w
(things) 990 4796 w
(are) 1307 4796 w
(not) 1486 4796 w
(so) 1674 4796 w
(nice) 1819 4796 w
(and) 2049 4796 w
(you) 2255 4796 w
(should) 2468 4796 w
(look) 2810 4796 w
(into) 3054 4796 w
(the) 3274 4796 w
(manual) 3456 4796 w
(pages) 3827 4796 w
(for) 4124 4796 w
(warnings) 566 4916 w
(regarding) 1016 4916 w
(multi\255threaded) 1483 4916 w
(programs.) 2177 4916 w
(For) 2667 4916 w
(example,) 2868 4916 w
(many) 3315 4916 w
(UNIX) 3607 4916 w
(manual) 3928 4916 w
(pages) 566 5036 w
(have) 863 5036 w
(notes) 1117 5036 w
(stating) 1397 5036 w
(that) 1739 5036 w
(functions) 1952 5036 w
(are) 2409 5036 w
11 /Times-Italic f
(MT\255Safe) 2589 5036 w
11 /Times-Roman f
(,) 2967 5036 w
(i.e.,) 3043 5036 w
(safe) 3254 5036 w
(for) 3477 5036 w
(use) 3652 5036 w
(in) 3846 5036 w
(multi\255) 3981 5036 w
(threaded) 566 5156 w
(programs.) 970 5156 w
(That) 1440 5156 w
(is,) 1669 5156 w
(in) 1799 5156 w
(programs) 1913 5156 w
(with) 2355 5156 w
(multiple) 2579 5156 w
(threads.) 2975 5156 w
(Even) 816 5312 w
(in) 1087 5312 w
(Plan) 1219 5312 w
(9,) 1461 5312 w
(some) 1590 5312 w
(other) 1868 5312 w
(functions) 2139 5312 w
(and) 2594 5312 w
(system) 2799 5312 w
(calls) 3152 5312 w
(are) 3400 5312 w
(not) 3579 5312 w
(to) 3767 5312 w
(be) 3900 5312 w
(used) 4050 5312 w
(when) 566 5432 w
(using) 842 5432 w
(the) 1120 5432 w
(thread) 1293 5432 w
(library.) 1605 5432 w
(In) 1963 5432 w
(general,) 2092 5432 w
(this) 2479 5432 w
(happens) 2677 5432 w
(whenever) 3074 5432 w
(a) 3536 5432 w
(function) 3622 5432 w
(deals) 4026 5432 w
(with) 566 5552 w
(the) 794 5552 w
(flow) 960 5552 w
(of) 1194 5552 w
(control) 1318 5552 w
(for) 1662 5552 w
(the) 1822 5552 w
(process.) 1989 5552 w
(A) 2378 5552 w
(threaded) 2490 5552 w
(program) 2899 5552 w
(has) 3303 5552 w
(multiple) 3482 5552 w
(flows) 3883 5552 w
(of) 4160 5552 w
(control,) 566 5672 w
(and) 935 5672 w
(it) 1123 5672 w
(would) 1215 5672 w
(make) 1520 5672 w
(no) 1787 5672 w
(sense) 1927 5672 w
(to) 2194 5672 w
(operate) 2310 5672 w
(on) 2661 5672 w
(the) 2801 5672 w
(underlying) 2965 5672 w
(flow) 3470 5672 w
(of) 3700 5672 w
(control) 3820 5672 w
(of) 4160 5672 w
(the) 566 5792 w
(process) 728 5792 w
(used) 1084 5792 w
(to) 1313 5792 w
(implement) 1427 5792 w
(the) 1926 5792 w
(various) 2088 5792 w
(threads.) 2439 5792 w
(We) 816 5948 w
(have) 1000 5948 w
(seen) 1239 5948 w
(that) 1466 5948 w
11 /Courier f
(threadexits) 1664 5948 w
11 /Times-Roman f
(must) 2423 5948 w
(be) 2672 5948 w
(used) 2809 5948 w
(instead) 3044 5948 w
(of) 3389 5948 w
11 /Courier f
(exits) 3514 5948 w
11 /Times-Roman f
(,) 3844 5948 w
(because) 3906 5948 w
(of) 566 6068 w
(the) 687 6068 w
(obvious) 851 6068 w
(reason.) 1230 6068 w
(This) 1573 6068 w
(case) 1799 6068 w
(was) 2016 6068 w
(clear.) 2216 6068 w
(A) 2484 6068 w
(less) 2592 6068 w
(clear) 2786 6068 w
(one) 3026 6068 w
(may) 3213 6068 w
(be) 3431 6068 w
11 /Courier f
(proccreate) 3563 6068 w
11 /Times-Roman f
(,) 4223 6068 w
(which) 566 6188 w
(we) 863 6188 w
(used) 1019 6188 w
(instead) 1249 6188 w
(of) 1589 6188 w
(calling) 1709 6188 w
11 /Courier f
(rfork) 2037 6188 w
11 /Times-Roman f
(or) 2396 6188 w
11 /Courier f
(fork) 2516 6188 w
11 /Times-Roman f
(.) 2780 6188 w
(The) 2865 6188 w
(thread) 3065 6188 w
(library) 3368 6188 w
(knows) 3690 6188 w
(about) 4007 6188 w
(the) 566 6308 w
(processes) 738 6308 w
(it) 1195 6308 w
(creates.) 1295 6308 w
(It) 1663 6308 w
(tries) 1768 6308 w
(hard) 1995 6308 w
(to) 2227 6308 w
(supply) 2351 6308 w
(the) 2683 6308 w
(same) 2855 6308 w
(interface) 3118 6308 w
(for) 3537 6308 w
(both) 3702 6308 w
(threads) 3935 6308 w
cleartomark
showpage
saveobj restore
%%EndPage: 31 31
%%Page: 32 32
/saveobj save def
mark
32 pagesetup
11 /Times-Roman f
(\255 32 \255) 2289 413 w
(and) 566 686 w
(processes,) 768 686 w
(so) 1259 686 w
(that) 1401 686 w
(all) 1610 686 w
(its) 1764 686 w
(operations) 1913 686 w
(work) 2415 686 w
(in) 2685 686 w
(the) 2816 686 w
(same) 2995 686 w
(way) 3265 686 w
(for) 3492 686 w
(both) 3664 686 w
(entities.) 3905 686 w
(Indeed,) 566 806 w
11 /Courier f
(proccreate) 931 806 w
11 /Times-Roman f
(creates) 1631 806 w
(a) 1973 806 w
(single) 2060 806 w
(thread) 2362 806 w
(in) 2674 806 w
(a) 2799 806 w
(new) 2886 806 w
(process.) 3107 806 w
(Thus,) 3502 806 w
(you) 3789 806 w
(might) 3993 806 w
(say) 566 926 w
(that) 756 926 w
(all) 965 926 w
(operations) 1119 926 w
(from) 1620 926 w
(the) 1878 926 w
(library) 2057 926 w
(work) 2394 926 w
(just) 2664 926 w
(on) 2869 926 w
(threads.) 3024 926 w
(In) 3413 926 w
(any) 3549 926 w
(case,) 3752 926 w
(using) 4012 926 w
11 /Courier f
(rfork) 566 1046 w
11 /Times-Roman f
(to) 926 1046 w
(operate) 1041 1046 w
(on) 1391 1046 w
(the) 1530 1046 w
(resources) 1693 1046 w
(for) 2134 1046 w
(your) 2290 1046 w
(process) 2520 1046 w
(is) 2877 1046 w
(safe.) 2980 1046 w
(For) 3212 1046 w
(example,) 3394 1046 w
(to) 3822 1046 w
(make) 3937 1046 w
(a) 4203 1046 w
(copy) 566 1166 w
(of) 807 1166 w
(environment) 926 1166 w
(variables,) 1509 1166 w
(put) 1960 1166 w
(the) 2129 1166 w
(process) 2291 1166 w
(in) 2647 1166 w
(a) 2761 1166 w
(new) 2837 1166 w
(note) 3047 1166 w
(group,) 3264 1166 w
(etc.) 3576 1166 w
(In) 816 1322 w
(a) 952 1322 w
(similar) 1045 1322 w
(way,) 1396 1322 w
11 /Courier f
(procexec) 1651 1322 w
11 /Times-Roman f
(\(or) 2224 1322 w
11 /Courier f
(procexecl) 2396 1322 w
11 /Times-Roman f
(\)) 2990 1322 w
(should) 3071 1322 w
(be) 3410 1322 w
(used) 3558 1322 w
(instead) 3804 1322 w
(of) 4160 1322 w
11 /Courier f
(exec) 566 1442 w
11 /Times-Roman f
(\(or) 875 1442 w
11 /Courier f
(execl) 1047 1442 w
11 /Times-Roman f
(\).) 1377 1442 w
(A) 1513 1442 w
(call) 1636 1442 w
(to) 1838 1442 w
11 /Courier f
(exec) 1968 1442 w
11 /Times-Roman f
(would) 2276 1442 w
(replace) 2595 1442 w
(the) 2953 1442 w
(program) 3131 1442 w
(for) 3546 1442 w
(the) 3717 1442 w
(process,) 3895 1442 w
(making) 566 1562 w
(void) 932 1562 w
(all) 1164 1562 w
(the) 1310 1562 w
(threads) 1480 1562 w
(that) 1833 1562 w
(might) 2035 1562 w
(be) 2330 1562 w
(running) 2470 1562 w
(on) 2849 1562 w
(it.) 2996 1562 w
(But) 3123 1562 w
(a) 3320 1562 w
(call) 3405 1562 w
(to) 3600 1562 w
11 /Courier f
(procexec) 3723 1562 w
11 /Times-Roman f
(works) 566 1682 w
(nicely) 870 1682 w
(when) 1174 1682 w
(using) 1447 1682 w
(processes) 1722 1682 w
(and) 2177 1682 w
(threads.) 2371 1682 w
(Of) 2751 1682 w
(course,) 2902 1682 w
(it) 3250 1682 w
(only) 3347 1682 w
(makes) 3578 1682 w
(sense) 3893 1682 w
(to) 4165 1682 w
(call) 566 1802 w
11 /Courier f
(procexec) 752 1802 w
11 /Times-Roman f
(when) 1308 1802 w
(there) 1573 1802 w
(is) 1820 1802 w
(a) 1923 1802 w
(single) 2000 1802 w
(thread) 2292 1802 w
(in) 2594 1802 w
(the) 2709 1802 w
(process) 2872 1802 w
(making) 3229 1802 w
(the) 3588 1802 w
(call.) 3751 1802 w
(Other\255) 3966 1802 w
(wise,) 566 1922 w
(what) 823 1922 w
(would) 1064 1922 w
(happen) 1367 1922 w
(to) 1711 1922 w
(the) 1825 1922 w
(other) 1987 1922 w
(threads?) 2240 1922 w
(Their) 2632 1922 w
(code) 2897 1922 w
(and) 3131 1922 w
(data) 3317 1922 w
(would) 3527 1922 w
(be) 3830 1922 w
(gone!) 3961 1922 w
(In) 816 2078 w
(most) 941 2078 w
(cases,) 1190 2078 w
(there) 1482 2078 w
(is) 1734 2078 w
(no) 1842 2078 w
(need) 1986 2078 w
(to) 2226 2078 w
(call) 2346 2078 w
11 /Courier f
(wait) 2538 2078 w
11 /Times-Roman f
(to) 2836 2078 w
(wait) 2956 2078 w
(for) 3179 2078 w
(other) 3340 2078 w
(processes.) 3599 2078 w
(The) 4081 2078 w
(processes) 566 2198 w
(you) 1016 2198 w
(create) 1211 2198 w
(can) 1500 2198 w
(synchronize) 1681 2198 w
(with) 2240 2198 w
(the) 2466 2198 w
(rest) 2630 2198 w
(of) 2818 2198 w
(your) 2939 2198 w
(program) 3170 2198 w
(using) 3571 2198 w
(channels,) 3840 2198 w
(if) 566 2318 w
(you) 670 2318 w
(need) 872 2318 w
(to) 1115 2318 w
(convey) 1238 2318 w
(a) 1592 2318 w
(completion) 1678 2318 w
(status) 2211 2318 w
(or) 2500 2318 w
(something) 2629 2318 w
(else.) 3126 2318 w
(That) 3362 2318 w
(is) 3601 2318 w
(not) 3713 2318 w
(the) 3892 2318 w
(case) 4064 2318 w
(when) 566 2438 w
(using) 852 2438 w
11 /Courier f
(procexec) 1140 2438 w
11 /Times-Roman f
(.) 1668 2438 w
(The) 1772 2438 w
(program) 1990 2438 w
(executed) 2409 2438 w
(by) 2845 2438 w
11 /Courier f
(procexec) 3003 2438 w
11 /Times-Roman f
(knows) 3579 2438 w
(nothing) 3914 2438 w
(about) 566 2558 w
(your) 847 2558 w
(program.) 1085 2558 w
(Therefore,) 1521 2558 w
(a) 2015 2558 w
(substitute) 2100 2558 w
(for) 2560 2558 w
11 /Courier f
(wait) 2724 2558 w
11 /Times-Roman f
(is) 3025 2558 w
(appropriate) 3137 2558 w
(for) 3673 2558 w
(this) 3838 2558 w
(case.) 4036 2558 w
(The) 566 2678 w
(function) 783 2678 w
11 /Courier f
(threadwaitchan) 1196 2678 w
11 /Times-Roman f
(returns) 2167 2678 w
(a) 2518 2678 w
(channel) 2613 2678 w
(that) 3000 2678 w
(can) 3212 2678 w
(be) 3409 2678 w
(used) 3558 2678 w
(to) 3805 2678 w
(receive) 3937 2678 w
11 /Courier f
(Waitmsgs) 566 2798 w
11 /Times-Roman f
(for) 1122 2798 w
(processes) 1277 2798 w
(what) 1724 2798 w
(we) 1965 2798 w
(used) 2120 2798 w
(to) 2349 2798 w
(execute) 2463 2798 w
(other) 2824 2798 w
(programs.) 3077 2798 w
(The) 816 2954 w
(following) 1026 2954 w
(program) 1494 2954 w
(is) 1905 2954 w
(a) 2019 2954 w
(complete) 2107 2954 w
(example) 2549 2954 w
(regarding) 2960 2954 w
(how) 3419 2954 w
(to) 3648 2954 w
(execute) 3774 2954 w
(an) 4148 2954 w
(external) 566 3074 w
(program) 946 3074 w
(and) 1345 3074 w
(wait) 1531 3074 w
(for) 1748 3074 w
(it.) 1903 3074 w
cleartomark
showpage
saveobj restore
%%EndPage: 32 32
%%Page: 33 33
/saveobj save def
mark
33 pagesetup
11 /Times-Roman f
(\255 33 \255) 2289 413 w
9 /S f
(\347) 566 676 w
9 /Times-Bold f
(texec.c) 581 676 w
9 /S f
(\347) 854 676 w
(`) 566 676 w
(``````) 584 676 w
(_) 566 676 w
(______) 584 676 w
8 /Courier f
(#include <u.h>) 786 784 w
(#include <libc.h>) 786 892 w
(#include <thread.h>) 786 1000 w
(Channel*waitc;) 786 1216 w
(Channel*pidc;) 786 1324 w
(void) 786 1540 w
(cmdproc\(void* arg\)) 786 1648 w
({) 786 1756 w
(char*) 1266 1864 w
(cmd = arg;) 1746 1864 w
(procexecl\(pidc, cmd, cmd, nil\);) 1266 2080 w
(sysfatal\("procexecl: %r"\);) 1266 2188 w
(}) 786 2296 w
(void) 786 2512 w
(threadmain\(int, char*[]\)) 786 2620 w
({) 786 2728 w
(char) 1266 2836 w
(ln[512];) 1746 2836 w
(int) 1266 2944 w
(pid, nr;) 1746 2944 w
(Waitmsg) 1266 3052 w
(*m;) 1746 3052 w
(write\(1, "cmd? ", 5\);) 1266 3268 w
(nr = read\(0, ln, sizeof\(ln\)\2551\);) 1266 3376 w
(if \(nr <= 1\)) 1266 3484 w
(threadexits\(nil\);) 1746 3592 w
(ln[nr\2551] = 0;) 1266 3700 w
(// drop \\n) 2226 3700 w
(pidc = chancreate\(sizeof\(ulong\), 1\);) 1266 3808 w
(waitc= threadwaitchan\(\);) 1266 3916 w
(proccreate\(cmdproc, ln, 8*1024\);) 1266 4024 w
(pid = recvul\(pidc\);) 1266 4132 w
(print\("started new proc pid=%d\\n", pid\);) 1266 4240 w
(if \(pid >= 0\){) 1266 4348 w
(m = recvp\(waitc\);) 1746 4456 w
(print\("terminated pid=%d sts=%s\\n", m\255>pid, m\255>msg\);) 1746 4564 w
(free\(m\);) 1746 4672 w
(}) 1266 4780 w
(threadexits\(nil\);) 1266 4888 w
(}) 786 4996 w
11 /Times-Roman f
(The) 566 5212 w
(initial) 779 5212 w
(thread) 1080 5212 w
(reads) 1396 5212 w
(a) 1669 5212 w
(file) 1760 5212 w
(name) 1949 5212 w
(and) 2229 5212 w
(executes) 2430 5212 w
(it.) 2849 5212 w
(The) 2982 5212 w
(actual) 3195 5212 w
(work) 3499 5212 w
(is) 3767 5212 w
(done) 3884 5212 w
(by) 4141 5212 w
11 /Courier f
(proccreate) 566 5332 w
11 /Times-Roman f
(,) 1226 5332 w
(which) 1286 5332 w
(creates) 1586 5332 w
(the) 1920 5332 w
(process) 2086 5332 w
(to) 2446 5332 w
(execute) 2564 5332 w
(the) 2929 5332 w
(file,) 3094 5332 w
(and) 3299 5332 w
(by) 3488 5332 w
11 /Courier f
(procexecl) 3629 5332 w
11 /Times-Roman f
(,) 4223 5332 w
(which) 566 5452 w
(executes) 862 5452 w
(the) 1266 5452 w
(new) 1428 5452 w
(program) 1638 5452 w
(in) 2037 5452 w
(the) 2151 5452 w
(calling) 2313 5452 w
(process.) 2640 5452 w
(The) 816 5608 w
(first) 1023 5608 w
(parameter) 1237 5608 w
(for) 1710 5608 w
11 /Courier f
(procexecl) 1874 5608 w
11 /Times-Roman f
(may) 2505 5608 w
(be) 2731 5608 w
(either) 2871 5608 w
(nil) 3157 5608 w
(or) 3311 5608 w
(point) 3439 5608 w
(to) 3703 5608 w
(a) 3826 5608 w
(channel) 3911 5608 w
(of) 566 5728 w
(unsigned) 695 5728 w
(integers.) 1130 5728 w
(In) 1543 5728 w
(the) 1672 5728 w
(later) 1844 5728 w
(case,) 2076 5728 w
(the) 2329 5728 w
(pid) 2501 5728 w
(for) 2680 5728 w
(the) 2845 5728 w
(process) 3017 5728 w
(used) 3383 5728 w
(to) 3622 5728 w
(execute) 3746 5728 w
(the) 4117 5728 w
(command) 566 5848 w
(is) 1038 5848 w
(sent) 1151 5848 w
(through) 1367 5848 w
(the) 1748 5848 w
(channel.) 1921 5848 w
(This) 2357 5848 w
(is) 2593 5848 w
(useful) 2707 5848 w
(for) 3015 5848 w
(more) 3182 5848 w
(than) 3447 5848 w
(to) 3676 5848 w
(obtain) 3802 5848 w
(the) 4117 5848 w
(pid) 566 5968 w
(for) 745 5968 w
(the) 910 5968 w
(process) 1082 5968 w
(running) 1448 5968 w
(the) 1828 5968 w
(external) 2000 5968 w
(command.) 2390 5968 w
(It) 2917 5968 w
(is) 3021 5968 w
(guaranteed) 3132 5968 w
(that) 3648 5968 w
(the) 3850 5968 w
(argu\255) 4021 5968 w
(ments) 566 6088 w
(supplied) 866 6088 w
(to) 1276 6088 w
11 /Courier f
(procexec) 1399 6088 w
11 /Times-Roman f
(will) 1964 6088 w
(not) 2173 6088 w
(be) 2351 6088 w
(used) 2491 6088 w
(after) 2729 6088 w
(sending) 2965 6088 w
(the) 3344 6088 w
(pid.) 3516 6088 w
(In) 3723 6088 w
(our) 3852 6088 w
(case,) 4036 6088 w
11 /Courier f
(ln) 566 6208 w
11 /Times-Roman f
(is) 733 6208 w
(in) 842 6208 w
(the) 963 6208 w
(stack) 1132 6208 w
(of) 1392 6208 w
(the) 1518 6208 w
(initial) 1687 6208 w
(thread.) 1980 6208 w
(After) 2316 6208 w
(receiving) 2581 6208 w
(the) 3023 6208 w
(pid,) 3192 6208 w
(we) 3396 6208 w
(could) 3558 6208 w
(terminate) 3837 6208 w
11 /Courier f
(threadmain) 566 6328 w
11 /Times-Roman f
(,) 1226 6328 w
(which) 1310 6328 w
(deallocates) 1634 6328 w
11 /Courier f
(ln) 2176 6328 w
11 /Times-Roman f
(.) 2308 6328 w
(However,) 2420 6328 w
(before) 2904 6328 w
(receiving) 3238 6328 w
(the) 3701 6328 w
(pid,) 3891 6328 w
(the) 4117 6328 w
cleartomark
showpage
saveobj restore
%%EndPage: 33 33
%%Page: 34 34
/saveobj save def
mark
34 pagesetup
11 /Times-Roman f
(\255 34 \255) 2289 413 w
(arguments) 566 686 w
(for) 1051 686 w
11 /Courier f
(procexec) 1206 686 w
11 /Times-Roman f
(must) 1762 686 w
(still) 2005 686 w
(exist,) 2200 686 w
(and) 2464 686 w
(cannot) 2650 686 w
(be) 2970 686 w
(deallocated) 3101 686 w
(yet.) 3627 686 w
(The) 816 842 w
(program) 1021 842 w
(calls) 1427 842 w
11 /Courier f
(threadwaitchan) 1663 842 w
11 /Times-Roman f
(to) 2622 842 w
(obtain) 2743 842 w
(a) 3054 842 w
(channel) 3138 842 w
(for) 3514 842 w
(notifying) 3677 842 w
(the) 4117 842 w
(termination) 566 962 w
(of) 1138 962 w
(the) 1294 962 w
(external) 1493 962 w
(program.) 1910 962 w
(Receiving) 2374 962 w
(from) 2884 962 w
(this) 3162 962 w
(channel) 3386 962 w
(yields) 3790 962 w
(the) 4117 962 w
11 /Courier f
(Waitmsg) 566 1082 w
11 /Times-Roman f
(that) 1056 1082 w
11 /Courier f
(wait) 1249 1082 w
11 /Times-Roman f
(would) 1541 1082 w
(return) 1844 1082 w
(for) 2133 1082 w
(a) 2288 1082 w
(program) 2364 1082 w
(not) 2763 1082 w
(using) 2932 1082 w
(threads.) 3199 1082 w
(This) 816 1238 w
(is) 1040 1238 w
(an) 1142 1238 w
(example) 1273 1238 w
(run.) 1672 1238 w
10 /Courier f
(; 8.texec) 786 1408 w
(cmd? /bin/date) 786 1518 w
(started new proc pid=1436) 786 1628 w
(Sat Aug) 786 1738 w
(5 19:51:05 MDT 2006) 1326 1738 w
(terminated pid=1436 sts=) 786 1848 w
(; 8.texec) 786 1958 w
(cmd? date) 786 2068 w
(procexecl: 'date' file does not exist) 786 2178 w
(;) 786 2288 w
11 /Times-Roman f
(To) 816 2504 w
(conclude,) 973 2504 w
(handling) 1431 2504 w
(of) 1851 2504 w
(notes) 1977 2504 w
(is) 2244 2504 w
(similar) 2353 2504 w
(in) 2695 2504 w
(threaded) 2817 2504 w
(programs) 3229 2504 w
(than) 3679 2504 w
(in) 3904 2504 w
(other) 4026 2504 w
(ones.) 566 2624 w
(Only) 839 2624 w
(that) 1103 2624 w
11 /Courier f
(threadnotify) 1312 2624 w
11 /Times-Roman f
(must) 2148 2624 w
(be) 2407 2624 w
(used) 2554 2624 w
(instead) 2799 2624 w
(of) 3153 2624 w
11 /Courier f
(atnotify) 3287 2624 w
11 /Times-Roman f
(.) 3815 2624 w
(But) 3914 2624 w
(the) 4117 2624 w
(interface) 566 2744 w
(is) 975 2744 w
(otherwise) 1077 2744 w
(the) 1531 2744 w
(same.) 1693 2744 w
11 /Times-Bold f
(Problems) 566 2984 w
11 /Times-Roman f
(1) 566 3140 w
(Implement) 816 3140 w
(a) 1334 3140 w
(concurrent) 1424 3140 w
(program) 1934 3140 w
(simulating) 2348 3140 w
(a) 2857 3140 w
(printer) 2948 3140 w
(spooler.) 3283 3140 w
(It) 3677 3140 w
(must) 3787 3140 w
(have) 4045 3140 w
(several) 816 3260 w
(processes.) 1160 3260 w
(Some) 1642 3260 w
(of) 1928 3260 w
(them) 2054 3260 w
(generate) 2309 3260 w
(jobs) 2713 3260 w
(for) 2932 3260 w
(printing) 3094 3260 w
(\(spool) 3478 3260 w
(print) 3788 3260 w
(jobs\)) 4031 3260 w
(and) 816 3380 w
(two) 1003 3380 w
(other) 1197 3380 w
(ones) 1451 3380 w
(print) 1681 3380 w
(jobs.) 1918 3380 w
(Needless) 2159 3380 w
(to) 2583 3380 w
(say) 2698 3380 w
(that) 2873 3380 w
(the) 3067 3380 w
(program) 3230 3380 w
(must) 3630 3380 w
(not) 3874 3380 w
(have) 4045 3380 w
(race) 816 3500 w
(conditions.) 1026 3500 w
(You) 1543 3500 w
(must) 1762 3500 w
(use) 2007 3500 w
(threads) 2183 3500 w
(and) 2529 3500 w
(channels) 2716 3500 w
(as) 3128 3500 w
(the) 3248 3500 w
(building) 3411 3500 w
(blocks) 3808 3500 w
(for) 4124 3500 w
(the) 816 3620 w
(program.) 978 3620 w
(2) 566 3776 w
(One) 816 3776 w
(way) 1032 3776 w
(to) 1248 3776 w
(determine) 1368 3776 w
(if) 1840 3776 w
(a) 1941 3776 w
(number) 2023 3776 w
(is) 2392 3776 w
(prime) 2500 3776 w
(is) 2790 3776 w
(to) 2899 3776 w
(filter) 3020 3776 w
(all) 3268 3776 w
(natural) 3413 3776 w
(numbers) 3752 3776 w
(to) 4165 3776 w
(remove) 816 3896 w
(numbers) 1179 3896 w
(that) 1592 3896 w
(are) 1792 3896 w
(not) 1959 3896 w
(prime.) 2135 3896 w
(Using) 2454 3896 w
(different) 2752 3896 w
(thread) 3163 3896 w
(for) 3470 3896 w
(filtering) 3631 3896 w
(num\255) 4019 3896 w
(bers) 816 4016 w
(that) 1026 4016 w
(divide) 1219 4016 w
(candidate) 1522 4016 w
(numbers,) 1969 4016 w
(write) 2403 4016 w
(a) 2656 4016 w
(program) 2732 4016 w
(to) 3131 4016 w
(write) 3245 4016 w
(prime) 3498 4016 w
(numbers.) 3782 4016 w
(3) 566 4172 w
(There) 816 4172 w
(are) 1104 4172 w
(different) 1270 4172 w
(cars) 1680 4172 w
(trying) 1889 4172 w
(to) 2186 4172 w
(cross) 2306 4172 w
(a) 2565 4172 w
(bridge.) 2647 4172 w
(There) 2989 4172 w
(are) 3278 4172 w
(cars) 3445 4172 w
(on) 3655 4172 w
(both) 3800 4172 w
(sides) 4031 4172 w
(of) 816 4292 w
(the) 942 4292 w
(bridge.) 1111 4292 w
(Simulate) 1453 4292 w
(this) 1879 4292 w
(scenario) 2073 4292 w
(using) 2471 4292 w
(threads) 2744 4292 w
(and) 3094 4292 w
(channels.) 3286 4292 w
(Avoid) 3731 4292 w
(acci\255) 4040 4292 w
(dents.) 816 4412 w
(4) 566 4568 w
(The) 816 4568 w
(dining) 1033 4568 w
(philosophers) 1362 4568 w
(problem) 1971 4568 w
(is) 2384 4568 w
(a) 2505 4568 w
(very) 2601 4568 w
(famous) 2843 4568 w
(one) 3214 4568 w
(in) 3420 4568 w
(concurrent) 3554 4568 w
(pro\255) 4069 4568 w
(gramming.) 816 4688 w
(There) 1354 4688 w
(are) 1638 4688 w
(philosophers) 1800 4688 w
(who) 2392 4688 w
(loop) 2611 4688 w
(forever) 2837 4688 w
(trying) 3181 4688 w
(to) 3474 4688 w
(think,) 3590 4688 w
(and) 3875 4688 w
(then) 4062 4688 w
(to) 816 4808 w
(eat.) 942 4808 w
(All) 1137 4808 w
(of) 1318 4808 w
(them) 1449 4808 w
(are) 1709 4808 w
(seated) 1881 4808 w
(around) 2194 4808 w
(a) 2538 4808 w
(round) 2626 4808 w
(table,) 2922 4808 w
(with) 3203 4808 w
(a) 3439 4808 w
(single) 3527 4808 w
(chopstick) 3830 4808 w
(between) 816 4928 w
(each) 1221 4928 w
(two) 1461 4928 w
(philosophers.) 1667 4928 w
(To) 2298 4928 w
(eat,) 2461 4928 w
(a) 2656 4928 w
(philosopher) 2744 4928 w
(needs) 3303 4928 w
(both) 3592 4928 w
(the) 3828 4928 w
(chop\255) 4002 4928 w
(stick) 816 5048 w
(on) 1065 5048 w
(the) 1216 5048 w
(left) 1391 5048 w
(and) 1578 5048 w
(the) 1777 5048 w
(one) 1952 5048 w
(on) 2151 5048 w
(the) 2302 5048 w
(right.) 2477 5048 w
(Write) 2754 5048 w
(a) 3045 5048 w
(program) 3135 5048 w
(to) 3548 5048 w
(simulate) 3676 5048 w
(this) 4091 5048 w
(scenario) 816 5168 w
(using) 1208 5168 w
(threads) 1475 5168 w
(for) 1819 5168 w
(the) 1974 5168 w
(different) 2136 5168 w
(philosophers.) 2540 5168 w
(5) 566 5324 w
(Avoid) 816 5324 w
(starvation) 1119 5324 w
(in) 1580 5324 w
(the) 1694 5324 w
(previous) 1856 5324 w
(problem.) 2262 5324 w
cleartomark
showpage
saveobj restore
%%EndPage: 34 34
%%Page: 35 35
/saveobj save def
mark
35 pagesetup
11 /Times-Roman f
(\255 35 \255) 2289 413 w
(.) 844 686 w
cleartomark
showpage
saveobj restore
%%EndPage: 35 35
%%Page: 36 36
/saveobj save def
mark
36 pagesetup
11 /Times-Roman f
(\255 36 \255) 2289 413 w
cleartomark
showpage
saveobj restore
%%EndPage: 36 36
%%Trailer
done
%%DocumentFonts: Times-Roman LucidaSansUnicode20 Times-Italic Times-Bold Courier S1 S
%%Pages: 36
